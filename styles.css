* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    user-select: none;
    -webkit-user-select: none;
}

body {
    font-family: 'Outfit', sans-serif;
    background: var(--bg-primary);
    height: 100vh;
    min-height: 100vh;
    margin: 0;
    padding: 0;
    color: var(--text-on-brown);
    overflow: hidden;
    width: 100vw;
}


/* Container pour les toasts */
.toastContainer {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    gap: 10px;
    pointer-events: none;
}

/* Style de base d'un toast */
.toast {
    min-width: 300px;
    max-width: 400px;
    padding: 16px 20px;
    background: var(--surface-dark) !important;
    border: 2px solid var(--border-dark) !important;
    border-radius: 8px !important;
    box-shadow: var(--shadow-xl);
    display: flex;
    align-items: center;
    gap: 12px;
    pointer-events: auto;
    cursor: pointer;
    animation: slideIn 0.3s ease;
    transition: var(--transition-normal);
    color: var(--text-on-dark) !important;
}

.toast:hover {
    transform: translateX(-5px);
    box-shadow: 0 12px 40px rgba(0, 0, 0, 0.2);
}

/* Animation d'entrée */
@keyframes slideIn {
    from {
        transform: translateX(400px);
        opacity: 0;
    }

    to {
        transform: translateX(0);
        opacity: 1;
    }
}

/* Animation de sortie */
@keyframes slideOut {
    from {
        transform: translateX(0);
        opacity: 1;
    }

    to {
        transform: translateX(400px);
        opacity: 0;
    }
}

.toast.removing {
    animation: slideOut 0.3s ease;
}

/* Icône du toast */
.toast-icon {
    font-size: 28px;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
}

/* Contenu du toast */
.toast-content {
    flex: 1;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.toast-title {
    font-weight: 800;
    font-size: 15px;
    color: #fff !important;
}

.toast-message {
    font-size: 13px;
    color: #ccc !important;
    line-height: 1.4;
}

/* Bouton de fermeture */
.toast-close {
    font-size: 20px;
    color: #999;
    cursor: pointer;
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, transform 0.2s, opacity 0.2s, box-shadow 0.2s, filter 0.2s;
}

.toast-close:hover {
    background: rgba(0, 0, 0, 0.05);
    color: #333;
}

/* Types de toasts */
.toast-success {
    background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
    border-left: 4px solid #28a745;
}

.toast-success .toast-icon {
    background: rgba(40, 167, 69, 0.1);
    color: #28a745;
}

.toast-info {
    background: linear-gradient(135deg, #d1ecf1 0%, #bee5eb 100%);
    border-left: 4px solid #17a2b8;
}

.toast-info .toast-icon {
    background: rgba(23, 162, 184, 0.1);
    color: #17a2b8;
}

.toast-warning {
    background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
    border-left: 4px solid #ffc107;
}

.toast-warning .toast-icon {
    background: rgba(255, 193, 7, 0.1);
    color: #ffc107;
}

.toast-error {
    background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
    border-left: 4px solid #dc3545;
}

.toast-error .toast-icon {
    background: rgba(220, 53, 69, 0.1);
    color: #dc3545;
}

.toast-shiny {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
    border-left: 4px solid #ffd700;
    box-shadow: 0 8px 32px rgba(255, 215, 0, 0.3);
}

.toast-shiny .toast-icon {
    background: rgba(255, 215, 0, 0.2);
    color: #ff8c00;
    animation: pulse 1s infinite;
}

@keyframes pulse {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.1);
    }
}

.toast-legendary {
    background: linear-gradient(135deg, #9b59b6 0%, #8e44ad 100%);
    border-left: 4px solid #6c3483;
    color: white;
}

.toast-legendary .toast-icon {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}

.toast-legendary .toast-title,
.toast-legendary .toast-message {
    color: white;
}

.toast-legendary .toast-close {
    color: rgba(255, 255, 255, 0.8);
}

.toast-legendary .toast-close:hover {
    background: rgba(255, 255, 255, 0.2);
    color: white;
}





.battle-sprite {
    width: 96px;
    height: 96px;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
    /* Ombre plus courte et nette pour ancrer le Pokémon au sol */
    filter: drop-shadow(0px 4px 2px rgba(0, 0, 0, 0.4));
    animation: sprite-float 2s ease-in-out infinite;
}

@keyframes sprite-float {

    0%,
    100% {
        transform: translateY(0px);
    }

    50% {
        transform: translateY(-8px);
    }
}

.battle-sprite-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
}


/* --- LAYOUT DASHBOARD PC (3 COLONNES) --- */

.game-container {
    display: grid;
    /* 1. GAUCHE (320px) | 2. CENTRE (Flexible) | 3. DROITE (400px) */
    grid-template-columns: 520px 1fr 520px;

    /* Ligne 1 : Header | Ligne 2 : Contenu Principal */
    grid-template-rows: auto 1fr;

    /* Prend toute la hauteur de la fenêtre, sans scrollbar sur le body */
    height: 100vh;
    width: 100vw;
    overflow: hidden;
    position: relative;

    gap: 18px;
    padding: 10px;
    background: #2c3e50;
    /* Fond global plus sombre pour faire ressortir les panneaux */
}

/* Quand un thème est actif, le visuel descend dans le game container
   puis se fond progressivement dans le fond global. */
.game-container.has-themed-header-bg {
    background-color: rgb(var(--header-skin-fade-rgb, 44, 62, 80));
    background-image:
        linear-gradient(180deg,
            rgba(var(--header-skin-fade-rgb, 44, 62, 80), 0.00) 0%,
            rgba(var(--header-skin-fade-rgb, 44, 62, 80), 0.12) 22%,
            rgba(var(--header-skin-fade-rgb, 44, 62, 80), 0.58) 52%,
            rgba(var(--header-skin-fade-rgb, 44, 62, 80), 0.92) 68%,
            rgba(var(--header-skin-fade-rgb, 44, 62, 80), 1.00) 80%),
        var(--header-skin-container-image, none);
    background-repeat: no-repeat, no-repeat;
    background-size: 100% 50vh, 100% 50vh;
    background-position: top center, top center;
}

/* Continuite visuelle: en mode theme, on n'affiche plus une seconde image
   dans le header. Le header devient transparent et laisse voir le fond
   unique du game-container. */
.game-container.has-themed-header-bg .header {
    background-color: transparent;
    background-image: none;
}

/* Vignette : assombrit les bords pour mettre le combat au centre en valeur */
.game-container::before {
    content: '';
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 2;
    border-radius: 12px;
    background: radial-gradient(ellipse 100% 100% at 50% 55%,
            transparent 0%,
            transparent 42%,
            rgba(0, 0, 0, 0.12) 60%,
            rgba(0, 0, 0, 0.28) 85%,
            rgba(0, 0, 0, 0.4) 100%);
}

/* --- HEADER FINAL : DASHBOARD BLANC UNIFIÉ --- */

/* --- HEADER FINAL : REDESIGN POKEMON --- */

.header {
    background-color: var(--header-skin-bg, #947864);
    background-image: linear-gradient(var(--header-skin-overlay, rgba(0, 0, 0, 0)), var(--header-skin-overlay, rgba(0, 0, 0, 0))), var(--header-skin-image, none);
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    border: 4px solid var(--header-skin-border, #5d4a3e);
    border-radius: 12px;
    /* Padding plus compact tout en gardant la barre de titre respirable */
    padding: 20px 12px 10px 12px;
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 0 var(--header-skin-border, #5d4a3e), 0 8px 24px var(--header-skin-glow, rgba(0, 0, 0, 0.25));
    grid-column: 1 / -1;
}

/* Les 3 boutons de fenêtre (rouge, jaune, vert) */
.header::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 15px;
    width: 12px;
    height: 12px;
    background: #ff5f56;
    border-radius: 50%;
    box-shadow: 20px 0 0 #ffbd2e, 40px 0 0 #27c93f;
    border: 1px solid rgba(0, 0, 0, 0.2);
}

/* Petite barre de "drag" ou titre au milieu */
.header::after {
    content: 'POKETIME HUD';
    position: absolute;
    top: 6px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 10px;
    font-weight: 800;
    color: var(--header-skin-title-color, #5d4a3e);
    letter-spacing: 2px;
    text-transform: uppercase;
    font-family: 'Outfit', sans-serif;
}

.header-unified-row {
    background: var(--header-skin-panel-bg, #bec3c6);
    border: 3px solid var(--header-skin-panel-border, #3b3b3b);
    border-radius: 8px;
    padding: 12px;
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: center;
    flex-wrap: wrap;
    gap: 15px;
}

/* Uniquement quand un skin non par défaut est équipé: fond translucide
   pour laisser apparaître le sprite/visuel derrière la rangée. */
.header.header-theme-active .header-unified-row {
    background: var(--header-skin-panel-bg-themed, rgba(15, 23, 42, 0.56));
    border-color: var(--header-skin-panel-border-themed, var(--header-skin-panel-border, #3b3b3b));
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
}

/* GROUPES INTERNES */
.combat-stats-group,
.resources-group,
.header-buttons {
    display: flex;
    align-items: center;
    gap: 8px;
}

/* --- 1. LES STATS --- */
.stat-chip {
    background: #3b3b3b;
    border: 2px solid #1a1a1a;
    border-bottom: 4px solid #111;
    border-radius: 6px;
    padding: 8px 12px;
    min-width: 110px;
    display: flex;
    flex-direction: row;
    align-items: center;
    gap: 6px;
    color: white;
    transition: transform 0.1s;
}

.stat-chip:hover {
    transform: scale(1.02);
}

.stat-chip-boost-icon {
    display: none !important;
}

#headerStatHP {
    border-left: 4px solid #ef4444;
}

#headerStatAtk {
    border-left: 4px solid #f59e0b;
}

#headerStatDef {
    border-left: 4px solid #3b82f6;
}

#headerStatSpAtk {
    border-left: 4px solid #ec4899;
}

#headerStatSpDef {
    border-left: 4px solid #10b981;
}

#headerStatSpd {
    border-left: 4px solid #8b5cf6;
}

.stat-label {
    font-size: 11px;
    font-weight: 800;
    color: #aaa;
    text-transform: uppercase;
}

.stat-value {
    font-size: 14px;
    font-weight: 800;
    color: #fff;
    font-family: 'Outfit', sans-serif;
}

.stat-sub-info {
    font-size: 10px;
    color: #4ade80;
    font-weight: 700;
    margin-left: auto;
}

.stat-sub-info span {
    color: #4ade80 !important;
}

/* --- 2. LES RESSOURCES --- */
.resource-chip {
    background: #3b3b3b;
    border: 2px solid #1a1a1a;
    border-bottom: 4px solid #111;
    border-radius: 6px;
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 6px 12px;
    height: 48px;
    min-width: 0;
    color: white;
    transition: transform 0.1s;
}

.resource-chip:hover {
    transform: scale(1.02);
}

.resource-icon {
    font-size: 18px;
    filter: drop-shadow(0 0 2px rgba(255, 255, 255, 0.2));
}

.resource-icon.resource-icon-img {
    width: 24px;
    height: 24px;
    object-fit: contain;
    display: block;
}

/* Sprite jetons de quêtes en inline (récompenses, coûts, etc.) */
.quest-token-inline {
    width: 1.2em;
    height: 1.2em;
    vertical-align: middle;
    display: inline-block;
    object-fit: contain;
}

/* Sprite Marques du Triomphe en inline */
.marque-triomphe-inline {
    width: 1.2em;
    height: 1.2em;
    vertical-align: middle;
    display: inline-block;
    object-fit: contain;
}

.essence-dust-inline {
    width: 1.2em;
    height: 1.2em;
    vertical-align: middle;
    display: inline-block;
    object-fit: contain;
}

.pokedollars-inline {
    width: 1.2em;
    height: 1.2em;
    vertical-align: middle;
    display: inline-block;
    object-fit: contain;
}

.resource-val {
    font-size: 14px;
    font-weight: 800;
    color: #fff;
    font-family: 'Outfit', sans-serif;
    display: block;
    max-width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.resource-chip>div {
    min-width: 0;
}

.resource-name {
    font-size: 9px;
    font-weight: 700;
    color: #aaa;
    text-transform: uppercase;
}

/* --- 3. LES BOUTONS --- */
.header-buttons .btn,
.zone-details-btn,
.sort-btn,
.cmd-btn {
    background: #5d4a3e !important;
    border: 2px solid #3b3b3b !important;
    color: white !important;
    padding: 8px 16px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 800;
    cursor: pointer;
    transition: background-color 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    box-shadow: 0 4px 0 #3b3b3b;
    margin: 2px;
    font-family: 'Outfit', sans-serif;
}

.header-buttons .btn:hover,
.zone-details-btn:hover,
.sort-btn:hover,
.cmd-btn:hover {
    background: var(--bg-secondary) !important;
    transform: translateY(2px);
    box-shadow: 0 2px 0 var(--bg-tertiary);
}

.cmd-btn.forfeit {
    background: var(--accent-red) !important;
    color: var(--text-on-dark);
    box-shadow: 0 4px 0 var(--accent-red-dark);
}

.cmd-btn.forfeit:hover {
    background: var(--accent-red-dark) !important;
    box-shadow: 0 2px 0 var(--accent-red-darker);
}

/* --- 2. COLONNE GAUCHE : GESTION (Équipe, Pension, Stockage) --- */
.team-area {
    grid-column: 1;
    grid-row: 2;
    background: #947864;
    border: 4px solid #5d4a3e;
    border-radius: 12px;
    padding: 15px 15px 15px 15px;
    box-shadow: 0 6px 0 #5d4a3e;
    position: relative;
    overflow-y: auto;
    height: 100%;
    min-height: 0;
    scrollbar-width: thin;
    scrollbar-color: #5d4a3e transparent;
}



/* --- 2.5 STORAGE CONTROLS --- */
.storage-controls {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    border-radius: 8px !important;
    padding: 15px !important;
    margin-bottom: 20px !important;
    color: #3b3b3b !important;
    font-weight: 800;
}

.storage-controls input,
.storage-controls select {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    color: white !important;
    border-radius: 6px !important;
    padding: 8px 12px !important;
    font-family: 'Outfit', sans-serif !important;
}

.storage-controls input::placeholder {
    color: #888 !important;
}

.shop-wallet {
    text-align: center;
    margin-bottom: 20px;
    font-size: 18px;
    font-weight: 800;
    color: var(--text-on-light) !important;
    background: var(--surface-light);
    padding: 10px;
    border-radius: 8px;
    border: 2px solid var(--border-light);
}


.shop-intro {
    color: var(--text-on-brown) !important;
    font-weight: 800;
    margin-bottom: 15px;
    font-size: 13px;
}

.pokedex-controls {
    margin-bottom: 15px;
    padding: 10px;
    background: #bec3c6 !important;
    border-radius: 10px;
    border: 2px solid #3b3b3b;
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.pokedex-controls input,
.pokedex-controls select {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    color: white !important;
    border-radius: 6px !important;
    padding: 8px 12px !important;
    font-family: 'Outfit', sans-serif !important;
    font-size: 11px !important;
    font-weight: 800 !important;
}

.pokedex-controls input::placeholder {
    color: #888 !important;
}

/* --- 3. COLONNE CENTRALE : COMBAT (Action) --- */
.combat-area {
    grid-column: 2;
    grid-row: 2;
    background: #947864;
    border-radius: 12px;
    padding: 15px 15px 15px 15px;
    position: relative;
    overflow-y: auto;
    height: 100%;
    min-height: 0;
    scrollbar-width: thin;
    scrollbar-color: #5d4a3e transparent;
    z-index: 3;

    /* Cadre type Game Boy : double bordure + léger spotlight */
    border: 6px solid #3d3d38;
    box-shadow:
        0 6px 0 #2d2d28,
        inset 0 0 0 3px #5a5548,
        inset 0 2px 24px rgba(255, 255, 255, 0.06),
        0 0 50px rgba(251, 191, 36, 0.12);
}


.combat-area .zone-selector,
.combat-area .combat-controls-wrapper {
    background: #bec3c6;
    border: 3px solid #3b3b3b;
    border-radius: 8px;
    padding: 12px;
    margin-bottom: 20px;
    color: #3b3b3b !important;
    font-weight: 800;
}

/* Écran de combat unifié : scène + HUD dans un seul cadre (style Pokémon) */
.battle-screen {
    margin-bottom: 20px;
    border-radius: 14px;
    overflow: hidden;
    border: 5px solid #2d2d28;
    box-shadow:
        inset 0 0 0 4px #4a4a42,
        0 0 0 2px #1a1a17,
        0 8px 0 #1f1f1a,
        0 0 40px rgba(120, 200, 80, 0.18),
        0 0 80px rgba(251, 191, 36, 0.08);
}

/* Scène : plus de marge ni bordure propre, elle fusionne avec le cadre */
.battle-screen .battle-display {
    margin-bottom: 0;
    border-radius: 10px 10px 0 0;
    border: none;
    box-shadow: inset 0 4px 30px rgba(0, 0, 0, 0.25), inset 0 -2px 20px rgba(0, 0, 0, 0.15);
}


/* HUD : barre d’infos collée sous la scène, même cadre */
.battle-screen .battle-hud {
    margin-top: 0;
    margin-bottom: 0;
    border-radius: 0 0 10px 10px;
    background: linear-gradient(180deg, #4a4a42 0%, #3b3b35 100%) !important;
    border: none;
    border-top: 3px solid #2d2d28;
    padding: 8px 15px;
    gap: 20px;
    /* Increased gap */

    /* Layout Grille (Fusionné depuis le bloc supprimé) */
    display: grid;
    grid-template-columns: 1fr 1fr;
}

/* --- 4. COLONNE DROITE : EXTRAS (Boutique, Quêtes, etc.) --- */
.secondary-content {
    grid-column: 3;
    grid-row: 2;
    background: #947864;
    border: 4px solid #5d4a3e;
    border-radius: 12px;
    padding: 30px 15px 15px 15px;
    box-shadow: 0 6px 0 #5d4a3e;
    position: relative;
    display: flex !important;
    flex-direction: column;
    overflow-y: auto;
    height: 100%;
    min-height: 0;
    scrollbar-width: thin;
    scrollbar-color: #5d4a3e transparent;
}

/* --- NETTOYAGE --- */

/* On cache définitivement le bouton flottant "Extras" car tout est visible */
button[onclick="toggleSecondaryContent()"],
#toggleIcon {
    display: none !important;
}

.tab-btn,
.sub-tab-btn,
.tab-btn,
.sort-btn,
.zone-details-btn,
.header-buttons .btn,
.cmd-btn {
    font-family: 'Outfit', sans-serif !important;
    background: #5d4a3e !important;
    border: 2px solid #3b3b3b !important;
    color: white !important;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 11px;
    font-weight: 800;
    cursor: pointer;
    transition: background-color 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    box-shadow: 0 4px 0 #3b3b3b;
    margin: 2px;
    text-transform: uppercase;
}

.tab-btn:hover,
.sub-tab-btn:hover,
.sort-btn:hover,
.zone-details-btn:hover,
.header-buttons .btn:hover,
.cmd-btn:hover {
    background: #7a614e !important;
    transform: translateY(2px);
    box-shadow: 0 2px 0 #3b3b3b;
}

.tab-btn.active,
.sub-tab-btn.active {
    background: #3b3b3b !important;
    border-color: #1a1a1a !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5) !important;
    transform: translateY(2px);
    box-shadow: none !important;
}

.tab-content {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    border-radius: 8px !important;
    padding: 15px !important;
    margin-top: 10px !important;
    box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2) !important;
    color: #1a1a1a !important;
}

.tab-content h3,
.tab-content h4 {
    color: #3b3b3b !important;
    font-weight: 800;
    text-transform: uppercase;
    border-bottom: 2px solid #3b3b3b;
    padding-bottom: 5px;
    margin-bottom: 15px;
}

.tower-stats,
.account-talents-box {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    color: white;
    text-align: center;
}

.account-talents-box {
    text-align: left;
}

.account-talents-box h4 {
    color: #fff !important;
    border-bottom: 1px solid #555;
    margin-bottom: 10px;
}

#badgesList {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
    gap: 10px;
}

/* 2. Styles pour les nouveaux sous-onglets (dans la Boutique) */
.sub-tabs-container {
    display: flex;
    gap: 8px;
    margin-bottom: 15px;
    border-bottom: 2px solid #ddd;
}

.sub-tab-btn {
    padding: 8px 16px;
    background: none;
    border: none;
    border-bottom: 3px solid transparent;
    cursor: pointer;
    font-weight: bold;
    color: #666;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

.sub-tab-btn:hover {
    background: rgba(0, 0, 0, 0.05);
}

.sub-tab-btn.active {
    color: #667eea;
    border-bottom-color: #667eea;
}

.sub-tab-content {
    display: none;
    /* Caché par défaut */
}

.sub-tab-content.active {
    display: block;
    /* Affiché si actif */
}

.tab-content.active {
    display: block;
}



.creature-name {
    font-size: 18px;
    font-weight: bold;
    margin-bottom: 10px;

    /* --- AJOUTS --- */
    display: flex;
    /* Permet d'aligner le nom et l'icône */
    align-items: center;
    justify-content: center;
    /* Centre le nom et l'icône ensemble */
    gap: 8px;
    /* Espace entre le nom et l'icône */
}

/* Style pour la nouvelle icône de statut (dans le nom) */
.status-icon {
    font-size: 16px;
    /* Légèrement plus petit que le texte */
    line-height: 1;
    /* Empêche de déformer la hauteur de ligne */
}

.creature-level {
    font-size: 13px;
    color: #fff;
    font-weight: 700;
    margin-bottom: 10px;
    opacity: 0.9;
}

.health-bar {
    width: 100%;
    height: 16px;
    background: #1a1a1a;
    border: 1px solid #000;
    border-radius: 4px;
    overflow: hidden;
    margin-bottom: 10px;
    position: relative;
}


/* OPTIMISATION : Performance GPU Maximale */
.hud-player,
.hud-enemy {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px !important;
    padding: 12px !important;
    color: white !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
    font-family: 'Outfit', sans-serif !important;
    position: relative;
    /* Ajouté pour alignement */
}

.hud-header-row {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 10px;
    width: 100%;

    /* FIX ALIGNEMENT HUD : Force la même hauteur que hud-name-row */
    height: 24px;
    position: relative;
}

.hud-player .creature-name,
.hud-enemy .creature-name {
    color: #fff !important;
    font-weight: 800 !important;
}

.hud-player .creature-level,
.hud-enemy .creature-level {
    color: #aaa !important;
    font-size: 11px !important;
}

/* OPTIMISATION : Performance GPU Maximale */
.health-fill {
    height: 100%;
    width: 100%;
    background: linear-gradient(90deg, #4ade80, #22c55e);
    transform-origin: left;
    transform: scaleX(1);
    transition: transform 0.3s ease-out, background-color 0.3s;

    /* ⬇️ AJOUT CRITIQUE ⬇️ */
    will-change: transform;
    /* Force le navigateur à créer un calque Composite (GPU) pour cet élément. 
       Résultat : Zéro recalcul de layout quand la barre bouge. */
}

.health-text {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: white;
    font-size: 12px;
}

.vs-text {
    font-size: 24px;
    font-weight: bold;
    color: #333;
    margin: 0 20px;
}



.team-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 15px;
}

.creature-card {
    background: var(--surface-dark);
    border: 2px solid var(--border-dark);
    border-bottom: 5px solid var(--surface-dark);
    padding: 15px;
    border-radius: 8px;
    box-shadow: var(--shadow-md);
    transition: var(--transition-fast);
    position: relative;
    color: var(--text-on-dark);
}

.creature-card:hover {
    transform: translateY(-2px);
    background: var(--surface-dark-hover);
}

/* Badge objet tenu en haut à droite de la carte */
.creature-card-held-item {
    position: absolute;
    top: 6px;
    right: 6px;
    width: 22px;
    height: 22px;
    object-fit: contain;
    pointer-events: none;
    z-index: 2;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.35);
    padding: 2px;
    box-sizing: border-box;
}

.creature-card-held-item-icon {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
    width: 22px;
    height: 22px;
    border-radius: 4px;
    background: rgba(0, 0, 0, 0.35);
}

/* Hover plus clair dans la zone équipe (évite le marron trop foncé) */
.team-area .creature-card:hover {
    background: var(--bg-secondary, #7a614e) !important;
}

.creature-card h4 {
    margin-bottom: 10px;
    color: var(--text-on-dark);
    font-weight: 800;
}

.creature-stats {
    font-size: 11px;
    color: var(--text-on-dark-secondary) !important;
    line-height: 1.5;
    font-family: 'Outfit', sans-serif;
}

.creature-stats strong {
    color: #fff;
}

.type-badge {
    display: inline-block;
    padding: 2px 8px;
    border-radius: 12px;
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
    color: white;
    margin-bottom: 5px;
}

/* ... (Ajoutez ceci n'importe où dans votre balise <style>) ... */
.ultimate-btn {
    position: absolute;
    bottom: 5px;
    left: 5px;
    width: calc(100% - 10px);
    padding: 8px;
    border: none;
    border-radius: 8px;
    background: linear-gradient(135deg, #666, #444);
    color: white;
    font-weight: bold;
    cursor: not-allowed;
    opacity: 1;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
    z-index: 10;
    font-size: 12px;
}

.ultimate-btn:not(:disabled) {
    background: linear-gradient(135deg, #f39c12, #e67e22);
    opacity: 1;
    cursor: pointer;
    animation: pulse-reward 2s infinite;
    box-shadow: 0 0 15px rgba(243, 156, 18, 1);
}

.ultimate-btn:not(:disabled):hover {
    transform: scale(1.05);
}



.type-fire {
    background: #ff6b35;
}

.type-water {
    background: #4dabf7;
}

.type-grass {
    background: #51cf66;
}

.type-electric {
    background: #ffd43b;
    color: #333;
}

.type-normal {
    background: #868e96;
}

.type-rock {
    background: #b8860b;
    color: white;
}

.type-flying {
    background: #87ceeb;
    color: #333;
}

.type-psychic {
    background: #ff1493;
    color: white;
}

.type-dark {
    background: #2c1e3f;
    color: white;
}

.type-steel {
    background: #b0b0b0;
    color: #333;
}

.type-dragon {
    background: #7038f8;
    color: white;
}

.type-fighting {
    background: #c03028;
    color: white;
}

.type-poison {
    background: #a040a0;
    color: white;
}

.type-ground {
    background: #e0c068;
    color: #333;
}

.type-bug {
    background: #a8b820;
    color: #333;
}

.type-ghost {
    background: #705898;
    color: white;
}

.type-ice {
    background: #98d8d8;
    color: #333;
}

.type-fairy {
    background: #ee99ac;
    color: #1a1a1a;
}

.rarity-common {
    border: 1px solid #b0bec5;
    /* Gris */
    background: linear-gradient(135deg, #f5f5f5 0%, #eceff1 100%);
}

.rarity-rare {
    border: 1px solid #4caf50;
    /* Vert */
    background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);

}

.rarity-epic {
    border: 1px solid #9b59b6;
    /* Violet (cohérent avec le recycleur) */
    background: linear-gradient(135deg, #f3e5f5 0%, #e1bee7 100%);

}

.rarity-legendary {
    border: 1px solid #fbc02d;
    /* Or */
    background: linear-gradient(135deg, #fffde7 0%, #fff9c4 100%);

    animation: legendary-glow 2s ease-in-out infinite alternate;
}

/* Shiny : carte normale + reflet holographique + étoiles (style Pokémon) */
.creature-card.shiny {
    position: relative;
    overflow: hidden;
    border: 2px solid #ffc107 !important;
    box-shadow: 0 4px 15px rgba(255, 193, 7, 0.4) !important;
}

/* Reflet holographique (balayage de lumière) */
.creature-card.shiny::after {
    content: "";
    position: absolute;
    top: 0;
    left: -150%;
    width: 50%;
    height: 100%;
    background: linear-gradient(to right,
            rgba(255, 255, 255, 0) 0%,
            rgba(255, 255, 255, 0.6) 50%,
            rgba(255, 255, 255, 0) 100%);
    transform: skewX(-25deg);
    animation: shiny-sweep 3s ease-in-out infinite;
    pointer-events: none;
}

@keyframes shiny-sweep {
    0% {
        left: -150%;
    }

    50% {
        left: 200%;
    }

    100% {
        left: 200%;
    }
}

/* Particules étoilées (✦) — clignotent et tournent dans les coins */
.shiny-stars {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
}

.shiny-stars span {
    position: absolute;
    font-size: 14px;
    color: rgba(255, 215, 0, 0.9);
    text-shadow: 0 0 8px rgba(255, 193, 7, 0.8);
    animation: shiny-star-twinkle 2.5s ease-in-out infinite;
}

.shiny-stars span:nth-child(1) {
    top: 6px;
    left: 6px;
    animation-delay: 0s;
}

.shiny-stars span:nth-child(2) {
    top: 6px;
    right: 6px;
    left: auto;
    animation-delay: 0.4s;
}

.shiny-stars span:nth-child(3) {
    bottom: 6px;
    left: 6px;
    top: auto;
    animation-delay: 0.8s;
}

.shiny-stars span:nth-child(4) {
    bottom: 6px;
    right: 6px;
    top: auto;
    left: auto;
    animation-delay: 1.2s;
}

@keyframes shiny-star-twinkle {

    0%,
    100% {
        opacity: 0.5;
        transform: scale(0.9) rotate(0deg);
    }

    50% {
        opacity: 1;
        transform: scale(1.15) rotate(180deg);
    }
}

@keyframes fill-up-bar-dopamine {
    0% {
        width: 0%;
    }

    100% {
        width: 100%;
    }
}

@keyframes gradient-shift {

    0%,
    100% {
        background-position: 0% 50%;
    }

    50% {
        background-position: 100% 50%;
    }
}

@keyframes sparkle-rotate {

    0%,
    100% {
        transform: rotate(0deg) scale(1);
    }

    25% {
        transform: rotate(90deg) scale(1.2);
    }

    50% {
        transform: rotate(180deg) scale(1);
    }

    75% {
        transform: rotate(270deg) scale(1.2);
    }
}

.shiny-label {
    display: inline-block;
    background: linear-gradient(135deg, #ffd700, #ffed4e);
    color: #333;
    padding: 3px 8px;
    border-radius: 8px;
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
    margin-bottom: 5px;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
}

.rarity-label {
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 8px;
    font-weight: bold;
    text-transform: uppercase;
    margin-bottom: 5px;
    display: inline-block;
}

.rarity-label.common {
    background: #6c757d;
    color: white;
}

.rarity-label.rare {
    background: #28a745;
    color: white;
}

.rarity-label.epic {
    background: #007bff;
    color: white;
}

.rarity-label.legendary {
    background: #ffc107;
    color: #333;
}

.exp-bar {
    width: 100%;
    height: 10px;
    background: #ddd;
    border-radius: 5px;
    overflow: hidden;
    margin-top: 10px;
}

.exp-fill {
    height: 100%;
    background: linear-gradient(90deg, #845ec2, #b39bc8);
    transition: width 0.3s ease;
}

.balls-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 15px;
}

.ball-item {
    background: transparent;
    padding: 15px;
    border-radius: 10px;
    text-align: center;
    box-shadow: none;
    cursor: pointer;
    transition: transform 0.2s ease;
}

.ball-item:hover {
    transform: translateY(-2px);
}

/* --- Incubateurs (Sac à dos) — Rétro/Clean, même charte que Inventaire d'œufs --- */
.incubators-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    margin-bottom: 20px;
}

/* Même fond et bordure que .ball-item (cartes d'œufs en dessous) */
.incubator-slot {
    min-height: 156px;
    border-radius: 12px;
    overflow: visible;
    display: flex;
    flex-direction: column;
    background: transparent;
    border: none;
    box-shadow: none;
}

.incubator-slot.rarity-common {
    --incubator-rarity: #6c757d;
}

.incubator-slot.rarity-rare {
    --incubator-rarity: #28a745;
}

.incubator-slot.rarity-epic {
    --incubator-rarity: #007bff;
}

.incubator-slot.rarity-legendary {
    --incubator-rarity: #ffc107;
}

.incubator-slot.incubator-locked {
    opacity: 0.55;
    background: #f1f5f9;
    border: 1px dashed #cbd5e1;
    border-bottom: 1px dashed #cbd5e1;
}

.incubator-slot-inner {
    padding: 14px;
    height: 100%;
    min-height: 100px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 6px;
    text-align: center;
}

/* Slot vide = zone de dépôt (dropzone) évidente */
.incubator-slot.incubator-slot-empty {
    background: #f8f9fa !important;
    border: 2px dashed #b0bec5 !important;
    box-shadow: none;
    transition: background 0.2s ease, border-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}

.incubator-slot-inner.incubator-empty {
    cursor: pointer;
    background: transparent;
    color: #78909c;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

/* Gros "+" au centre pour inciter au clic */
.incubator-slot-inner.incubator-empty::before {
    content: "+";
    font-size: 2.5em;
    font-weight: bold;
    color: #b0bec5;
    line-height: 1;
    margin-bottom: 2px;
}

.incubator-slot.incubator-slot-empty:hover {
    background: #eceff1 !important;
    border-color: #90a4ae !important;
    transform: scale(1.02);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
}

.incubator-slot-inner.incubator-empty:hover .incubator-empty-label,
.incubator-slot-inner.incubator-empty:hover .incubator-click-hint {
    color: #607d8b;
}

.incubator-empty-label {
    font-size: 13px;
    font-weight: 700;
    color: #78909c;
}

.incubator-click-hint {
    font-size: 10px;
    color: #90a4ae;
}

/* Capsule occupée : fond neutre unique (pas de socle noir) */
.incubator-capsule {
    display: flex;
    flex-direction: column;
    height: auto;
    min-height: 108px;
    flex: 1;
    background: transparent;
    border: none;
    box-shadow: none;
}

/* Zone principale : même blanc que les cartes d'œufs */
.incubator-body {
    flex: 1;
    padding: 8px 8px 4px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    position: relative;
    z-index: 1;
    border: none;
    box-shadow: none;
}

.incubator-body::before {
    content: '';
    position: absolute;
    inset: 0;
    background-position: center;
    background-repeat: no-repeat;
    background-size: contain;
    image-rendering: pixelated;
    z-index: 1;
    pointer-events: none;
}

/* Sprites d'incubateur spécifiques par slot (1 à 4) */
.incubator-slot:nth-child(1) .incubator-body::before {
    background-image: url('img/incubator1.png');
}

.incubator-slot:nth-child(2) .incubator-body::before {
    background-image: url('img/incubator2.png');
}

.incubator-slot:nth-child(3) .incubator-body::before {
    background-image: url('img/incubator3.png');
}

.incubator-slot:nth-child(4) .incubator-body::before {
    background-image: url('img/incubator4.png');
}

/* Footer : timer sur fond clair (pas de bande noire) */
.incubator-footer {
    padding: 4px 6px 6px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 2px;
}

/* Timer en cours : gris anthracite pour ne pas concurrencer le badge (jauge = couleur de rareté) */
.incubator-footer .incubator-timer {
    font-size: 12px;
    font-weight: 800;
    font-variant-numeric: tabular-nums;
    color: #333333;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.06);
}

/* Badge = même .rarity-label que l'inventaire d'œufs (pill tags) */
.incubator-body .rarity-label {
    font-size: 10px;
    padding: 2px 6px;
    margin: 0;
}


.incubator-egg-center {
    position: relative;
    z-index: 5;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 44px;
    height: 44px;
}

.incubator-egg-center img {
    width: 28px;
    height: 28px;
    object-fit: contain;
    display: block;
}

/* Respiration de l'œuf (vie à l'intérieur) */
.incubator-egg-center .egg-sprite.incubator-egg-breath {
    animation: incubator-egg-breathe 2.5s ease-in-out infinite;
}

@keyframes incubator-egg-breathe {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.05);
    }
}

.incubator-slot.incubator-ready {
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
}

/* "Prêt !" toujours en vert vif (même pour common) = récompense à cliquer */
.incubator-slot.incubator-ready .incubator-footer .incubator-timer {
    color: var(--accent-green, #22c55e) !important;
    text-shadow: 0 0 10px rgba(34, 197, 94, 0.35), 0 1px 2px rgba(0, 0, 0, 0.1);
    animation: incubator-ready-text 0.8s ease-in-out infinite;
}


@keyframes incubator-ready-text {

    0%,
    100% {
        opacity: 1;
        transform: scale(1);
    }

    50% {
        opacity: 0.9;
        transform: scale(1.05);
    }
}

.incubator-lock-label {
    font-size: 11px;
    color: #64748b;
}

.incubator-auto-controls {
    display: flex;
    gap: 4px;
    padding: 4px 6px 6px;
    justify-content: center;
    align-items: center;
    flex-wrap: nowrap;
}

.incubator-auto-controls-locked {
    opacity: 0.75;
}

.incubator-auto-toggle,
.incubator-priority-chip {
    border: 1px solid #475569;
    border-radius: 999px;
    padding: 3px 6px;
    font-size: 9px;
    font-weight: 700;
    cursor: pointer;
    white-space: nowrap;
    flex-shrink: 0;
}

.incubator-auto-toggle.incubator-auto-on {
    background: #16a34a;
    color: #f8fafc;
    border-color: #15803d;
}

.incubator-auto-toggle.incubator-auto-off {
    background: #475569;
    color: #e2e8f0;
    border-color: #334155;
}

.incubator-priority-chip {
    background: #f8fafc;
    color: #334155;
}

/* Couleurs de texte selon la priorité d'incubation */
.incubator-priority-chip.priority-common {
    color: #6b7280;
}

.incubator-priority-chip.priority-rare {
    color: #3b82f6;
}

.incubator-priority-chip.priority-epic {
    color: #8b5cf6;
}

.incubator-priority-chip.priority-légendaire {
    color: #f59e0b;
}

.incubator-auto-toggle:disabled,
.incubator-priority-chip:disabled {
    cursor: not-allowed;
    filter: grayscale(0.35);
    opacity: 0.55;
}

.incubator-locked-by-quest {
    margin: 6px 8px 10px;
    padding: 5px 8px;
    border-radius: 8px;
    font-size: 10px;
    text-align: center;
    color: #7f1d1d;
    background: #fee2e2;
    border: 1px dashed #fca5a5;
}

/* ========== Modal « Choisir un œuf » — même palette que capture (marron clair) ========== */
#chooseEggModal.show {
    background: radial-gradient(ellipse 80% 70% at 50% 45%,
            rgba(255, 248, 240, 0.15) 0%,
            rgba(72, 62, 52, 0.5) 50%,
            rgba(58, 50, 42, 0.92) 100%) !important;
    backdrop-filter: blur(4px);
}

#chooseEggModal .quest-completion-content {
    background: linear-gradient(165deg, #5c5042 0%, #4a4035 45%, #3d352b 100%) !important;
    border: 1px solid rgba(180, 155, 100, 0.35) !important;
    border-radius: 20px !important;
    padding: 28px 24px 24px !important;
    max-width: 440px !important;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.25) !important;
}

#chooseEggModal .choose-egg-modal-title {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 6px;
}

#chooseEggModal .choose-egg-modal-title .egg-icon {
    width: 40px;
    height: 40px;
    object-fit: contain;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.25));
}

#chooseEggModal .choose-egg-modal-title span {
    font-size: 22px;
    font-weight: 800;
    color: #fef3c7 !important;
    letter-spacing: 0.5px;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
}

#chooseEggModal .choose-egg-modal-subtitle {
    font-size: 13px;
    color: #c4b5a0;
    margin-bottom: 20px;
    line-height: 1.45;
    padding-left: 52px;
}

.choose-egg-options {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 12px;
    margin: 16px 0 20px;
}

.choose-egg-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 8px;
    padding: 16px 12px;
    border-radius: 14px;
    font-weight: 700;
    border: 2px solid transparent;
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
    cursor: pointer;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.choose-egg-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.12) 0%, transparent 50%);
    pointer-events: none;
    border-radius: 12px;
}

.choose-egg-btn .choose-egg-btn-icon {
    width: 44px;
    height: 44px;
    object-fit: contain;
    position: relative;
    z-index: 1;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.3));
}

.choose-egg-btn .choose-egg-btn-label {
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    position: relative;
    z-index: 1;
}

.choose-egg-btn .choose-egg-btn-count {
    font-size: 11px;
    opacity: 0.9;
    font-weight: 600;
    position: relative;
    z-index: 1;
}

/* Couleurs de rareté = mêmes que .rarity-label (common gris, rare vert, epic bleu, legendary or) */
.choose-egg-btn.rarity-common {
    background: linear-gradient(145deg, #7c858e 0%, #6c757d 100%);
    color: #fff;
    border-color: rgba(108, 117, 125, 0.5);
    box-shadow: 0 4px 14px rgba(0, 0, 0, 0.2);
}

.choose-egg-btn.rarity-common .choose-egg-btn-count {
    color: #e2e8f0;
}

.choose-egg-btn.rarity-rare {
    background: linear-gradient(145deg, #34c759 0%, #28a745 100%);
    color: #fff;
    border-color: rgba(40, 167, 69, 0.5);
    box-shadow: 0 4px 14px rgba(40, 167, 69, 0.35);
}

.choose-egg-btn.rarity-rare .choose-egg-btn-count {
    color: #d4edda;
}

.choose-egg-btn.rarity-epic {
    background: linear-gradient(145deg, #1a8cff 0%, #007bff 100%);
    color: #fff;
    border-color: rgba(0, 123, 255, 0.5);
    box-shadow: 0 4px 14px rgba(0, 123, 255, 0.35);
}

.choose-egg-btn.rarity-epic .choose-egg-btn-count {
    color: #cce5ff;
}

.choose-egg-btn.rarity-legendary {
    background: linear-gradient(145deg, #ffce2b 0%, #ffc107 80%, #e0a800 100%);
    color: #333;
    border-color: rgba(255, 193, 7, 0.5);
    box-shadow: 0 4px 14px rgba(255, 193, 7, 0.35);
}

.choose-egg-btn.rarity-legendary .choose-egg-btn-count {
    color: #1a1a1a;
}

.choose-egg-btn:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.35);
}

.choose-egg-btn.rarity-common:hover {
    box-shadow: 0 8px 24px rgba(108, 117, 125, 0.5);
}

.choose-egg-btn.rarity-rare:hover {
    box-shadow: 0 8px 24px rgba(40, 167, 69, 0.5);
}

.choose-egg-btn.rarity-epic:hover {
    box-shadow: 0 8px 24px rgba(0, 123, 255, 0.5);
}

.choose-egg-btn.rarity-legendary:hover {
    box-shadow: 0 8px 24px rgba(255, 193, 7, 0.5);
}

.choose-egg-btn:active {
    transform: translateY(-1px) scale(1);
}

#chooseEggModal .choose-egg-cancel {
    display: block;
    width: 100%;
    padding: 12px 16px;
    border-radius: 12px;
    font-size: 14px;
    font-weight: 700;
    background: rgba(92, 80, 66, 0.5);
    color: #e2e8f0;
    border: 1px solid rgba(180, 155, 100, 0.3);
    cursor: pointer;
    transition: background 0.2s, color 0.2s, border-color 0.2s;
}

#chooseEggModal .choose-egg-cancel:hover {
    background: rgba(92, 80, 66, 0.75);
    color: #f1f5f9;
    border-color: rgba(180, 155, 100, 0.45);
}

#chooseEggModal .choose-egg-empty-msg {
    color: #a89984;
    font-size: 14px;
    text-align: center;
    padding: 24px 16px;
    background: rgba(0, 0, 0, 0.12);
    border-radius: 12px;
    margin: 16px 0 20px;
}



.save-load-controls {
    display: flex;
    gap: 10px;
    margin-bottom: 15px;
}

.btn {
    padding: 10px 15px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background-color 0.2s ease;
}

.btn-save {
    background: #28a745;
    color: white;
}

.btn-save:hover {
    background: #218838;
}

.btn-load {
    background: #007bff;
    color: white;
}

.btn-load:hover {
    background: #0056b3;
}

.btn-reset {
    background: #dc3545;
    color: white;
}

.btn-reset:hover {
    background: #c82333;
}

.btn-buffs {
    background: #17a2b8;
    color: white;
}

.btn-buffs:hover {
    background: #138496;
}

.btn-stats {
    background: #6f42c1;
    color: white;
}

.btn-stats:hover {
    background: #5a32a3;
}

.stats-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    z-index: 2000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(3px);
}

.stats-modal.show {
    display: flex;
}

.stats-content,
.quest-guide-content,
.quest-completion-content,
.modal-content,
.log-modal-content {
    background: var(--bg-primary) !important;
    border: 4px solid var(--bg-tertiary) !important;
    padding: 30px 15px 15px 15px !important;
    border-radius: 12px !important;
    max-width: 800px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
    box-shadow: var(--shadow-lg), 0 6px 0 var(--bg-tertiary) !important;
    font-family: 'Outfit', sans-serif !important;
}

.stats-content::before,
.quest-guide-content::before,
.quest-completion-content::before,
.modal-content::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 15px;
    width: 10px;
    height: 10px;
    background: #ff5f56;
    border-radius: 50%;
    box-shadow: 18px 0 0 #ffbd2e, 36px 0 0 #27c93f;
    border: 1px solid rgba(0, 0, 0, 0.2);
    z-index: 10;
}

.stats-header,
.quest-guide-header,
.modal-header,
.modal-header-logs {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    border-radius: 8px !important;
    padding: 10px 15px !important;
    margin-bottom: 15px !important;
    display: flex;
    justify-content: space-between;
    align-items: center;
    color: #3b3b3b !important;
}

.stats-header h2,
.quest-guide-header h3,
.modal-header h2,
.modal-header-logs h2 {
    margin: 0 !important;
    color: #3b3b3b !important;
    font-weight: 800 !important;
    font-size: 16px !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
}

/* Old close button styles removed */

.stats-close,
.quest-guide-close,
.close-modal,
.close-btn {
    position: absolute;
    top: 15px;
    right: 15px;
    width: 32px;
    height: 32px;
    padding: 0 !important;
    background: rgba(0, 0, 0, 0.2) !important;
    color: rgba(255, 255, 255, 0.7) !important;
    border: 2px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 50% !important;
    font-size: 16px !important;
    font-weight: 800 !important;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: none !important;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease !important;
    z-index: 100;
}

.stats-close:hover,
.quest-guide-close:hover,
.close-modal:hover,
.close-btn:hover {
    background: #ef4444 !important;
    color: white !important;
    border-color: #ef4444 !important;
    transform: rotate(90deg);
    box-shadow: 0 4px 12px rgba(239, 68, 68, 0.4) !important;
}

.quest-guide-close:hover,
.close-modal:hover,
.close-btn:hover {
    background: #7a614e !important;
    transform: translateY(2px);
    box-shadow: 0 1px 0 #3b3b3b !important;
}

.pension-contribution-trigger {
    cursor: default;
}

.pension-contribution-btn {
    display: inline-block;
    margin-left: 6px;
    padding: 2px 8px;
    font-size: 11px;
    color: #fff !important;
    background: #8b5cf6 !important;
    /* More vibrant purple */
    border: 1px solid #7c3aed !important;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 800;
}

.pension-contribution-trigger:hover .pension-contribution-btn {
    background: rgba(255, 20, 147, 0.25);
    text-decoration: underline;
}

.pension-contribution-popover {
    display: none;
    position: fixed;
    z-index: 10001;
    min-width: 260px;
    max-width: 320px;
    padding: 12px 14px;
    background: linear-gradient(180deg, #fff 0%, #f8fafc 100%);
    border: 1px solid rgba(255, 20, 147, 0.35);
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18);
    pointer-events: auto;
}

.pension-contribution-popover.show {
    display: block;
}

.team-contribution-trigger {
    cursor: default;
}

.team-contribution-btn {
    display: inline-block;
    margin-left: 6px;
    padding: 2px 8px;
    font-size: 11px;
    color: #fff !important;
    background: #15803d !important;
    /* Darker green */
    border: 1px solid #14532d !important;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 800;
}

.team-contribution-trigger:hover .team-contribution-btn {
    background: rgba(34, 197, 94, 0.3);
    text-decoration: underline;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 10px;
    margin-bottom: 20px;
}

.stat-box {
    background: #3b3b3b;
    padding: 10px;
    border-radius: 8px;
    border: 2px solid #1a1a1a;
    border-left: 4px solid #3b82f6;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

.stat-box.highlight {
    background: #4a4a4a;
    border-left-color: #fbbf24;
}

.stat-title {
    font-size: 10px;
    color: #cbd5e1;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 5px;
}

.stat-number {
    font-size: 20px;
    font-weight: bold;
    color: #fff;
}

.stat-subtitle {
    font-size: 10px;
    color: #94a3b8;
    margin-top: 3px;
}

.auto-save-indicator {
    font-size: 12px;
    color: #666;
    margin-left: auto;
    align-self: center;
}

h2,
h3 {
    margin-bottom: 15px;
    color: #333;
}

.damage-fire {
    color: #ff6b35;
    font-weight: bold;
    font-size: 1.2em;
}

.damage-water {
    color: #4dabf7;
    font-weight: bold;
    font-size: 1.2em;
}

.damage-grass {
    color: #51cf66;
    font-weight: bold;
    font-size: 1.2em;
}

.damage-electric {
    color: #ffd43b;
    font-weight: bold;
    font-size: 1.2em;
}

.damage-normal {
    color: #868e96;
    font-weight: bold;
    font-size: 1.2em;
}

.damage-rock {
    color: #b8860b;
    font-weight: bold;
}

.damage-flying {
    color: #87ceeb;
    font-weight: bold;
}

.damage-psychic {
    color: #ff1493;
    font-weight: bold;
}

.damage-dark {
    color: #2c1e3f;
    font-weight: bold;
}

.damage-steel {
    color: #b0b0b0;
    font-weight: bold;
}

.damage-dragon {
    color: #7038f8;
    font-weight: bold;
}

.damage-fighting {
    color: #c03028;
    font-weight: bold;
}

.damage-poison {
    color: #a040a0;
    font-weight: bold;
}

.damage-ground {
    color: #e0c068;
    font-weight: bold;
}

.damage-bug {
    color: #a8b820;
    font-weight: bold;
}

.damage-ghost {
    color: #705898;
    font-weight: bold;
}

.damage-ice {
    color: #98d8d8;
    font-weight: bold;
}

.sort-btn {
    padding: 6px 10px;
    background: #5d4a3e !important;
    color: white !important;
    border: 2px solid #3b3b3b !important;
    border-radius: 6px;
    cursor: pointer;
    font-size: 10px;
    font-weight: 800;
    transition: background-color 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    box-shadow: 0 4px 0 #3b3b3b;
    text-transform: uppercase;
}

.sort-btn:hover {
    background: #7a614e !important;
    transform: translateY(1px);
    box-shadow: 0 3px 0 #3b3b3b;
}

.sort-btn.active {
    background: #3b3b3b !important;
    color: white !important;
    border-color: #1a1a1a !important;
    transform: translateY(2px) !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5) !important;
}

.sort-btn.active::after {
    content: " ↓";
}

.sort-btn.active.asc::after {
    content: " ↑";
}

/* --- Conteneur Nom + Badge (Fixe le nom au centre) --- */
.hud-name-row {
    position: relative;
    /* Important : sert de repère au badge */
    display: flex;
    justify-content: center;
    /* Centre le nom horizontalement */
    align-items: center;
    /* Centre verticalement */
    margin-bottom: 10px;
    /* S'aligne avec le HUD player */
    height: 24px;
    /* Hauteur fixe pour éviter les sauts */
}


/* --- Indicateur d'efficacité (Badge flottant à droite) --- */
.effectiveness-indicator {
    position: absolute;
    /* Sort du flux pour ne pas pousser le nom */
    right: 0;
    /* Collé à droite */
    top: 50%;
    /* Centré verticalement */
    transform: translateY(-50%);

    font-size: 9px;
    font-weight: 800;
    text-transform: uppercase;
    padding: 2px 6px;
    border-radius: 6px;
    line-height: 1;
    white-space: nowrap;
    display: none;
    /* Caché par défaut */
    opacity: 0.9;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* Animation d'apparition */
.effectiveness-indicator.show {
    display: inline-block;
    animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes popIn {
    from {
        transform: translateY(-50%) scale(0);
        opacity: 0;
    }

    to {
        transform: translateY(-50%) scale(1);
        opacity: 0.9;
    }
}

/* Couleurs */
.super-effective {
    background: #dcfce7;
    color: #166534;
    border: 1px solid #86efac;
}

.not-effective {
    background: #fee2e2;
    color: #991b1b;
    border: 1px solid #fca5a5;
}

.normal-effective {
    display: none !important;
}

.auto-select-btn {
    padding: 10px 20px;
    background: #6b7280 !important;
    /* Neutral Gray-Brown for OFF state */
    color: white !important;
    border: 2px solid #4b5563 !important;
    border-radius: 8px;
    font-weight: 800;
    cursor: pointer;
    transition: background-color 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    font-size: 13px;
    height: 44px;
    flex-shrink: 0;
    box-shadow: 0 4px 0 #3b3b3b;
    text-transform: uppercase;
}

.auto-select-btn:hover {
    background: #4b5563 !important;
    transform: translateY(1px);
    box-shadow: 0 3px 0 #3b3b3b;
}

.auto-select-btn.auto-active {
    background: #15803d !important;
    /* Dark Green for ON state */
    border-color: #14532d !important;
    color: white !important;
    box-shadow: 0 4px 0 #14532d, 0 0 10px rgba(34, 197, 94, 0.3);
}

.auto-select-btn.auto-active:hover {
    background: #166534 !important;
}

.auto-select-btn:disabled {
    cursor: not-allowed;
    opacity: 0.5;
}

.auto-select-btn.hidden {
    display: none !important;
}

/* ✅ NOUVEAU : Conteneur pour aligner les boutons horizontalement */
.combat-buttons-container {
    display: flex;
    gap: 10px;
    justify-content: center;
    align-items: center;
    margin-top: 10px;
    flex-shrink: 0;
}

/* --- UPGRADES --- */
.upgrades-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 12px;
}

.upgrade-card {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-bottom: 5px solid #111 !important;
    border-radius: 8px !important;
    padding: 15px !important;
    color: white !important;
    transition: transform 0.2s ease !important;
}

.upgrade-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(33, 150, 243, 0.3);
}

.upgrade-title {
    font-size: 14px !important;
    font-weight: 800 !important;
    color: #fff !important;
    margin-bottom: 5px !important;
}

.upgrade-description,
.upgrade-desc {
    font-size: 13px !important;
    color: #fff !important;
    line-height: 1.4 !important;
    margin-bottom: 10px !important;
}

.upgrade-stats {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 12px;
    padding: 10px;
    background: #bec3c6 !important;
    border-radius: 8px;
    border: 2px solid #3b3b3b;
    color: #3b3b3b !important;
    font-weight: 800;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
}

.upgrade-level {
    color: #854d0e !important;
}

.upgrade-effect {
    font-size: 11px;
    color: #166534 !important;
    /* Vert foncé */
    font-weight: 800;
}

.upgrade-cost {
    font-size: 14px !important;
    font-weight: 800 !important;
    color: #4ade80 !important;
    margin-bottom: 10px !important;
    display: block !important;
}

.upgrade-btn {
    width: 100%;
    padding: 12px !important;
    background: var(--accent-green) !important;
    color: var(--text-on-dark) !important;
    border: 2px solid var(--accent-green-dark) !important;
    border-radius: 6px !important;
    font-weight: 900 !important;
    cursor: pointer;
    box-shadow: 0 4px 0 var(--accent-green-darker) !important;
    font-size: 12px !important;
    text-transform: uppercase !important;
    transition: var(--transition-fast) !important;
}

.upgrade-btn:hover:not(:disabled) {
    background: var(--accent-green-dark) !important;
    transform: translateY(2px) !important;
    box-shadow: 0 2px 0 var(--accent-green-darker) !important;
}

.upgrade-btn:disabled {
    background: var(--surface-dark-alt) !important;
    border-color: var(--border-dark) !important;
    cursor: not-allowed;
    box-shadow: 0 4px 0 var(--surface-dark) !important;
    transform: none !important;
    color: var(--text-on-dark-tertiary) !important;
    font-size: 11px !important;
    text-align: center !important;
    font-weight: 800 !important;
}

.upgrade-card.not-affordable,
.shop-item.not-affordable {
    filter: grayscale(0.6) opacity(0.85);
    background: var(--surface-dark) !important;
}

/* Améliorations maxées : même rendu que "pas assez de fonds", affichées en fin de liste */
.upgrade-card.maxed,
.shop-item.maxed {
    filter: grayscale(0.6) opacity(0.85);
    background: var(--surface-dark) !important;
}

.upgrade-btn:disabled:hover {
    background: #ccc;
}

/* =========================================
   ONGLET ARÈNES — Logique visuelle type Quêtes
   Cartes claires (gris très clair / blanc cassé), textes en sombre
   ========================================= */

#arenasTab .account-talents-box {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}

#arenasTab .account-talents-box h4 {
    color: var(--text-on-light, #1a1a1a) !important;
    border-bottom-color: var(--border-light, #e7e5e4);
}

#arenasTab #badgesList>div {
    background: rgba(34, 197, 94, 0.12) !important;
    border: 2px solid var(--accent-green, #22c55e) !important;
    border-radius: 8px;
    padding: 10px;
}

#arenasTab #badgesList>div [style*="color: #22c55e"] {
    color: var(--accent-green-dark, #16a34a) !important;
}

#arenasTab #badgesList>div [style*="color: #666"] {
    color: var(--text-on-light-secondary, #404040) !important;
}

/* Cartes arènes : fond clair, texte sombre (comme quêtes acceptées) */
#arenasContainer .upgrade-card {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    border-left: 5px solid var(--accent-gold-dark, #f59e0b) !important;
    border-bottom: 4px solid var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}

#arenasContainer .upgrade-card .upgrade-title {
    color: var(--text-on-light, #1a1a1a) !important;
}

#arenasContainer .upgrade-card .upgrade-description {
    color: var(--text-on-light-secondary, #404040) !important;
}

/* Arène complétée : léger vert, texte sombre */
#arenasContainer .upgrade-card.arena-completed {
    background: var(--surface-light-alt, #f5f5f4) !important;
    border-left-color: var(--accent-green, #22c55e) !important;
    border-color: var(--accent-green-light, #86efac) !important;
}

#arenasContainer .upgrade-card.arena-completed .upgrade-title,
#arenasContainer .upgrade-card.arena-completed .upgrade-description {
    color: var(--text-on-light, #1a1a1a) !important;
}

/* Arène verrouillée : discret */
#arenasContainer .upgrade-card.arena-locked {
    opacity: 0.75;
}

/* Bloc récompense et statut déblocage : texte lisible sur fond clair */
#arenasContainer .arena-reward-box {
    margin: 15px 0;
    padding: 10px;
    background: rgba(251, 191, 36, 0.15);
    border-radius: 8px;
    border-left: 4px solid var(--accent-gold-dark, #f59e0b);
}

#arenasContainer .arena-reward-title {
    font-weight: bold;
    color: var(--accent-gold-darker, #d97706);
    margin-bottom: 5px;
}

#arenasContainer .arena-reward-desc {
    font-size: 12px;
    color: var(--text-on-light-secondary, #404040);
}

#arenasContainer .arena-unlock-status {
    font-size: 12px;
    color: var(--text-on-light-secondary, #404040);
    margin-bottom: 15px;
}

#arenasContainer .upgrade-btn:disabled {
    background: var(--surface-light-hover, #e7e5e4) !important;
    border-color: var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light-muted, #737373) !important;
    box-shadow: none !important;
}

/* =========================================
   ONGLET TOUR DE COMBAT — Même style que Arènes / Boutique
   Cartes claires, texte sombre, bordure ambre
   ========================================= */

#towerTab h3 {
    color: var(--text-on-light, #1a1a1a) !important;
}

#towerTab p {
    color: var(--text-on-light-secondary, #404040) !important;
}

#towerTab .tower-stats {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    border-radius: 8px;
    padding: 15px;
    margin-bottom: 20px;
    color: var(--text-on-light, #1a1a1a) !important;
    text-align: center;
}

#towerTab .tower-stats strong {
    color: var(--accent-gold-darker, #d97706);
}

#towerTab .btn-save,
#towerTab .btn {
    background: var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 3px 0 var(--accent-green-darker, #15803d) !important;
}

#towerTab .btn-save:hover:not(:disabled),
#towerTab .btn:hover:not(:disabled) {
    background: var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 2px 0 var(--accent-green-darker, #15803d) !important;
}

/* Urgence UX : bouton désactivé quand 0 ticket (ne pas mentir au joueur) */
#towerTab #towerStartBtn:disabled {
    background: var(--surface-light-hover, #e7e5e4) !important;
    color: var(--text-on-light-muted, #737373) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    box-shadow: none !important;
    cursor: not-allowed;
}

#towerTab #towerStartBtn:disabled:hover {
    background: var(--surface-light-hover, #e7e5e4) !important;
    transform: none;
    box-shadow: none !important;
}

/* =========================================
   ONGLET EXPÉDITIONS — Même style que Quêtes / Arènes
   Cartes claires, texte sombre, bordure ambre
   ========================================= */

#expeditionsTab h3,
#expeditionsTab h4 {
    color: var(--text-on-light, #1a1a1a) !important;
}

#expeditionsTab .zone-details-btn {
    background: var(--accent-gold-dark, #f59e0b) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-gold-darker, #d97706) !important;
    border-radius: 8px;
}

#expeditionsTab .zone-details-btn:hover {
    background: var(--accent-gold-darker, #d97706) !important;
}

#expeditionsTab [style*="background: #e2e8f0"],
#expeditionsTab .expedition-slots {
    background: var(--surface-light-alt, #f5f5f4) !important;
    border: 2px solid var(--border-light, #e7e5e4);
    color: var(--text-on-light, #1a1a1a) !important;
    border-radius: 15px;
}

#expeditionsTab hr {
    border: 0;
    border-top: 1px solid var(--border-light, #e7e5e4);
    margin: 20px 0;
}

/* Cartes expéditions : fond clair, bordure gauche ambre (comme quêtes) */
#expeditionsTab .quest-container .quest-card {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    border-left: 5px solid var(--accent-gold-dark, #f59e0b) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}

#expeditionsTab .quest-container .quest-card .quest-title {
    color: var(--text-on-light, #1a1a1a) !important;
}

#expeditionsTab .quest-container .quest-card .quest-description {
    color: var(--text-on-light-secondary, #404040) !important;
}

#expeditionsTab .quest-container .quest-card.accepted {
    border-left-color: var(--accent-gold-dark, #f59e0b) !important;
    background: var(--surface-light-alt, #f5f5f4) !important;
}

#expeditionsTab .quest-container .quest-card.completed {
    border-left-color: var(--accent-green, #22c55e) !important;
    border-color: var(--accent-green-light, #86efac) !important;
    background: var(--surface-light-alt, #f5f5f4) !important;
}

#expeditionsTab .quest-container .quest-card .quest-progress-text {
    color: var(--text-on-light-secondary, #404040) !important;
}

#expeditionsTab .quest-container .quest-card .quest-rewards {
    background: rgba(0, 0, 0, 0.02) !important;
    padding: 6px 8px;
    border-radius: 8px;
}

#expeditionsTab .quest-container .quest-card .quest-reward-item,
#expeditionsTab .quest-container .quest-card [style*="color:#666"] {
    color: var(--text-on-light-secondary, #404040) !important;
}

/* Zone de récompenses expéditions : icônes mises en avant */
.expedition-rewards-strip {
    display: flex;
    align-items: center;
    gap: 6px;
}

.expedition-rewards-strip span {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 32px;
    min-height: 32px;
    padding: 4px;
    border-radius: 6px;
    background: #f3f4f6;
    font-size: 14px;
}

#expeditionsTab .quest-btn {
    background: var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-green-dark, #16a34a) !important;
}

#expeditionsTab .quest-btn:hover:not(:disabled) {
    background: var(--accent-green-dark, #16a34a) !important;
}

#expeditionsTab .quest-btn:disabled {
    background: var(--surface-light-hover, #e7e5e4) !important;
    color: var(--text-on-light-muted, #737373) !important;
    border-color: var(--border-light, #e7e5e4) !important;
}

/* Messages vides et timer (texte généré en JS) */
#expeditionsTab .quest-container>p,
#expeditionsTab .quest-container>div[style*="text-align:center"] {
    color: var(--text-on-light-secondary, #404040) !important;
}

#expeditionsTab #activeExpeditionsContainer p[style*="color: #94a3b8"],
#expeditionsTab #activeExpeditionsContainer p[style*="italic"] {
    color: var(--text-on-light-secondary, #404040) !important;
    border-color: var(--border-light, #e7e5e4) !important;
}

/* =========================================
   SYSTÈME DE QUÊTES (Design Dashboard)
   [TAILLE COMPACTE - AJUSTEMENT TYPO & BOUTON]
   ========================================= */

/* --- 1. CONTENEUR & STATS --- */
.quest-container {
    display: grid;
    grid-template-columns: 1fr;
    gap: 10px;
    /* Pas de color forcé : chaque carte définit son propre contraste (clair/foncé) */
}

.quest-stats {
    display: flex;
    justify-content: space-around;
    padding: 10px;
    background: var(--surface-light, #fafaf9);
    border-radius: 8px;
    border: 1px solid var(--border-light, #e7e5e4);
    margin-bottom: 12px;
    box-shadow: var(--shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.05));
}

.quest-stat {
    text-align: center;
}

.quest-stat-value {
    font-size: 19px;
    font-weight: 800;
    color: var(--accent-gold-dark, #f59e0b);
}

.quest-stat-label {
    font-size: 10px;
    color: var(--text-on-light-secondary, #404040);
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.4px;
}

/* --- 2. CARTES DE QUÊTES --- */
.quest-card {
    background: var(--surface-dark-alt, #292524) !important;
    border: 2px solid var(--surface-dark, #1c1917) !important;
    border-left: 5px solid var(--bg-tertiary, #5d4a3e) !important;
    border-radius: 8px !important;
    padding: 12px !important;
    color: var(--text-on-dark, #fafafa) !important;
    margin-bottom: 10px !important;
}

/* Quête en attente d'acceptation : indication discrète "à traiter" (uniquement dans l'onglet Quêtes) */
#questContainer .quest-card:not(.accepted):not(.completed) {
    border-left-color: #c9a227 !important;
    box-shadow: 0 0 0 1px rgba(201, 162, 39, 0.12);
}

.quest-card.accepted {
    border-left-color: var(--accent-gold-dark, #f59e0b) !important;
}

.quest-card.completed {
    border-left-color: var(--accent-green, #22c55e) !important;
    opacity: 0.95 !important;
}

.quest-title {
    font-weight: 800 !important;
    color: var(--text-on-dark, #fafafa) !important;
    margin-bottom: 5px !important;
}

.pokedex-entry {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-bottom: 5px solid #111 !important;
    border-radius: 8px !important;
    padding: 12px !important;
    color: white !important;
    text-align: center !important;
    transition: transform 0.1s;
}

.pokedex-entry:hover {
    transform: translateY(-2px);
    background: #444;
}

.pokedex-entry.locked {
    opacity: 0.4 !important;
    filter: grayscale(0.8) contrast(1.2) !important;
}

.pokedex-number {
    font-size: 10px !important;
    color: #aaa !important;
    font-weight: 800;
}

/* États des quêtes */
.quest-card.accepted {
    border-left-color: var(--accent-gold-dark, #f59e0b);
    background: var(--surface-light, #fafaf9) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}

.quest-card.completed {
    border-left-color: var(--accent-green, #22c55e);
    background: var(--surface-light-alt, #f5f5f4) !important;
    border-color: var(--accent-green-light, #86efac);
    animation: none;
    color: var(--text-on-light, #1a1a1a) !important;
}

.quest-card.accepted .quest-title,
.quest-card.completed .quest-title {
    color: var(--text-on-light, #1a1a1a) !important;
}

.quest-card.accepted .quest-description,
.quest-card.completed .quest-description {
    color: var(--text-on-light-secondary, #404040) !important;
}

/* En-tête de la carte */
.quest-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 6px;
}

.quest-title {
    font-weight: 700;
    color: var(--text-on-dark, #fafafa);
    justify-content: space-between;
    font-size: 13px;
}

.quest-badge {
    font-size: 9px;
    /* Augmenté de 8px */
    padding: 1px 6px;
    border-radius: 8px;
    font-weight: bold;
    text-transform: uppercase;
}

.badge-easy {
    background: #dcfce7;
    color: #166534;
}

.badge-medium {
    background: #dbeafe;
    color: #1e40af;
}

.badge-hard {
    background: #fae8ff;
    color: #86198f;
}

.badge-extreme {
    background: #ffe4e6;
    color: #9f1239;
}

.quest-description {
    font-size: 11px;
    color: var(--text-on-dark-secondary, #d4d4d4) !important;
    margin-bottom: 8px;
    line-height: 1.4;
}

.quest-card.accepted .quest-description,
.quest-card.completed .quest-description {
    color: var(--text-on-light-secondary, #404040) !important;
}


/* Barre de progression */
.quest-progress-container {
    display: flex;
    /* ⬅️ Essentiel */
    align-items: center;
    /* Alignement vertical au centre */
    gap: 6px;
    margin-bottom: 8px;
}

/* Barre de progression */
.quest-progress-bar {
    flex-grow: 1;
    /* Permet à la barre de s'étendre et de se compresser si besoin */
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    overflow: hidden;
}

.quest-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #2563eb);
    border-radius: 3px;
    transition: width 0.3s ease;
}

.quest-card.completed .quest-progress-fill {
    background: linear-gradient(90deg, #22c55e, #16a34a);
}

/* Texte de progression */
.quest-progress-text {
    font-size: 10px;
    font-weight: bold;
    color: var(--text-on-dark, #fafafa) !important;
    min-width: 50px;
    text-align: right;
    white-space: nowrap;
    flex-shrink: 0;
}

.quest-card.accepted .quest-progress-text,
.quest-card.completed .quest-progress-text {
    color: var(--text-on-light, #1a1a1a) !important;
}

/* Zone de récompenses */
.quest-rewards {
    background: rgba(255, 255, 255, 0.08);
    padding: 5px 8px;
    border-radius: 5px;
    margin-bottom: 8px;
    font-size: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.quest-card.accepted .quest-rewards,
.quest-card.completed .quest-rewards {
    background: rgba(0, 0, 0, 0.04);
}

.quest-reward-item {
    font-weight: 600;
    color: var(--text-on-dark-secondary, #d4d4d4);
    display: flex;
    align-items: center;
    gap: 2px;
}

.quest-card.accepted .quest-reward-item,
.quest-card.completed .quest-reward-item {
    color: var(--text-on-light-secondary, #404040);
}

/* --- Achievements : logique inversée (complété = foncé, non complété = clair) --- */
#achievementsContainer .quest-card {
    background: var(--surface-light-alt, #f5f5f4) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    border-left: 5px solid var(--accent-gold-dark, #f59e0b) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}

#achievementsContainer .quest-card .quest-title {
    color: var(--text-on-light, #1a1a1a) !important;
}

#achievementsContainer .quest-card .quest-description {
    color: var(--text-on-light-secondary, #404040) !important;
}

#achievementsContainer .quest-card .quest-progress-text {
    color: var(--text-on-light, #1a1a1a) !important;
}

#achievementsContainer .quest-card .quest-rewards {
    background: rgba(0, 0, 0, 0.04);
}

#achievementsContainer .quest-card .quest-reward-item {
    color: var(--text-on-light-secondary, #404040);
}

/* Achievement complété = carte foncée */
#achievementsContainer .quest-card.completed {
    background: var(--surface-dark-alt, #292524) !important;
    border: 2px solid var(--surface-dark, #1c1917) !important;
    border-left: 5px solid var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    opacity: 1;
}

#achievementsContainer .quest-card.completed .quest-title {
    color: var(--text-on-dark, #fafafa) !important;
}

#achievementsContainer .quest-card.completed .quest-description {
    color: var(--text-on-dark-secondary, #d4d4d4) !important;
}

#achievementsContainer .quest-card.completed .quest-progress-text {
    color: var(--text-on-dark, #fafafa) !important;
}

#achievementsContainer .quest-card.completed .quest-rewards {
    background: rgba(255, 255, 255, 0.08);
}

#achievementsContainer .quest-card.completed .quest-reward-item {
    color: var(--text-on-dark-secondary, #d4d4d4);
}

/* Actions (Boutons) */
.quest-actions {
    display: flex;
    gap: 6px;
}

.quest-btn {
    flex: 1;
    padding: 6px;
    border-radius: 5px;
    border: none;
    font-weight: 600;
    font-size: 11px;
    /* Augmenté de 10px (sauf Refuse) */
    cursor: pointer;
    transition: background-color 0.1s, color 0.1s, border-color 0.1s, transform 0.1s, opacity 0.1s, box-shadow 0.1s, filter 0.1s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 3px;
}

.btn-accept {
    background: #3b82f6;
    color: white;
}

.btn-accept:hover {
    background: #2563eb;
}

/* BOUTON REFUSER / ABANDONNER (Plus petit et plus discret) */
.btn-refuse {
    background: transparent;
    color: #ef4444;
    border: 1px solid #fca5a5;
    padding: 5px;
    /* Réduit le padding de 6px */
    font-size: 9px;
    /* Réduit à 9px (plus petit que le reste) */
}

.btn-refuse:hover {
    background: #fef2f2;
    border-color: #ef4444;
}

.btn-claim {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    width: 100%;
    box-shadow: 0 2px 4px rgba(245, 158, 11, 0.3);
    animation: pulse-reward 1.5s infinite;
}

.btn-claim:hover {
    box-shadow: 0 4px 6px rgba(245, 158, 11, 0.4);
}

@keyframes pulse-reward {

    0%,
    100% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.01);
    }
}

/* Section Qu�tes du Professeur Chen (en t�te de l'onglet Qu�tes) */
.story-quests-section {
    margin-bottom: 24px;
    padding-bottom: 20px;
    border-bottom: 2px solid #e2e8f0;
}

.story-quests-header {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 16px;
    padding: 14px 16px;
    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
    border: 1px solid #fcd34d;
    border-radius: 12px;
    box-shadow: 0 2px 4px rgba(245, 158, 11, 0.1);
}

.story-quests-header-icon {
    flex-shrink: 0;
    width: 56px;
    height: 56px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
}

.story-quest-section-chen {
    width: 56px;
    height: 56px;
    object-fit: contain;
    image-rendering: pixelated;
}

.story-quest-section-chen-fallback {
    display: none;
    font-size: 32px;
}

.story-quest-section-chen-fallback.visible {
    display: block;
}

.story-quests-header-text {
    flex: 1;
    min-width: 0;
}

.story-quests-section-title {
    margin: 0 0 4px 0;
    font-size: 18px;
    font-weight: 700;
    color: #b45309;
}

.story-quests-section-desc {
    margin: 0;
    font-size: 12px;
    color: var(--text-on-light-secondary, #404040);
}

.story-quests-list {
    display: flex;
    flex-direction: column;
    gap: 12px;
}

.quest-card-story {
    box-shadow: 0 2px 6px rgba(245, 158, 11, 0.15);
}

.other-quests-title {
    margin: 20px 0 12px 0;
    font-size: 16px;
    font-weight: 700;
    color: var(--text-on-light, #1a1a1a);
}

/* Conteneur des indicateurs d'onglet (Quêtes / Expéditions) */
#questsTabBadge,
#expeditionsTabBadge {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    margin-left: 6px;
    vertical-align: middle;
}

.tab-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    min-width: 20px;
    height: 18px;
    padding: 0 5px;
    font-size: 11px;
    font-weight: 700;
    border-radius: 10px;
    white-space: nowrap;
    line-height: 1;
}

.tab-badge-claim {
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: white;
    box-shadow: 0 1px 3px rgba(34, 197, 94, 0.35);
}

.tab-badge-accept {
    background: linear-gradient(135deg, #3b82f6, #2563eb);
    color: white;
    box-shadow: 0 1px 3px rgba(59, 130, 246, 0.35);
}

.tab-badge-story {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    padding: 0 6px;
    box-shadow: 0 1px 3px rgba(245, 158, 11, 0.35);
}

.tab-badge-available {
    background: rgba(59, 130, 246, 0.2);
    color: #2563eb;
    padding: 0 6px;
    border: 1px solid rgba(37, 99, 235, 0.4);
}

.story-quest-tab-badge {
    display: inline-block;
    font-size: 12px;
    margin-left: 4px;
    vertical-align: middle;
}

/* --- 3. MODALE DE COMPLÉTION --- */
.quest-completion-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(15, 23, 42, 0.8);
    /* Fond sombre bleuté */
    z-index: 2000;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(2px);
}

.quest-completion-modal.show {
    display: flex;
}

/* Guide de qu�te : positionn� en bas � gauche pour ne pas masquer le module de capture (centre) */
.quest-guide-modal {
    display: none;
    position: fixed;
    left: 20px;
    bottom: 80px;
    z-index: 1500;
    pointer-events: none;
}

.quest-guide-modal.show {
    display: block;
    pointer-events: auto;
}

.quest-guide-content {
    max-width: 350px !important;
}

.quest-guide-header {
    border: none !important;
    padding: 0 !important;
}

.quest-guide-header h3 {
    margin: 0;
    color: #f59e0b;
    font-size: 16px;
}

.quest-guide-close {
    background: none;
    border: none;
    color: #94a3b8;
    font-size: 24px;
    line-height: 1;
    cursor: pointer;
    padding: 0 4px;
}

.quest-guide-close:hover {
    color: #fff;
}

.quest-guide-body {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px !important;
    padding: 15px !important;
    color: #fff !important;
    font-size: 13px;
    line-height: 1.5;
    margin-bottom: 14px;
    max-height: 280px;
    overflow-y: auto;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
}

.quest-guide-body .where {
    margin-top: 10px;
    padding: 8px 10px;
    background: rgba(255, 255, 255, 0.1);
    border-left: 4px solid #f59e0b;
    border-radius: 4px;
    font-size: 12px;
    color: #ffd700;
}

.quest-guide-btn {
    background: #5d4a3e !important;
    color: white !important;
    border: 2px solid #3b3b3b !important;
    box-shadow: 0 4px 0 #3b3b3b !important;
}

.quest-completion-content {
    background: #bec3c6 !important;
    padding: 40px;
    border: 4px solid #3b3b3b !important;
    border-radius: 20px;
    text-align: center;
    max-width: 500px;
    width: 90%;
    animation: modal-appear 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
}

@keyframes modal-appear {
    from {
        transform: scale(0.9);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

.quest-completion-title {
    font-size: 24px;
    color: #16a34a;
    /* Vert succès */
    margin-bottom: 10px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.quest-completion-rewards {
    background: var(--surface-dark-alt, #292524) !important;
    border: 2px solid var(--surface-dark, #1c1917) !important;
    padding: 20px;
    border-radius: 12px;
    margin: 20px 0;
    color: var(--text-on-dark, #fafafa) !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.3);
}

.quest-completion-reward {
    font-size: 16px;
    margin: 8px 0;
    font-weight: 700;
    color: var(--text-on-dark, #fafafa);
}

.narrative-quest-rewards-title {
    font-size: 14px;
    font-weight: 700;
    color: var(--text-on-light-secondary, #404040);
    margin: 12px 0 6px 0;
}

.narrative-quest-completion .narrative-quest-rewards {
    margin-top: 8px;
    padding: 12px;
    border-radius: 8px;
    background: #f1f5f9;
    border: 1px solid #e2e8f0;
}

.narrative-quest-completion .quest-completion-reward {
    font-size: 14px;
    margin: 4px 0;
    color: var(--text-on-light, #1a1a1a);
}

/* --- 4. TIMER DE QUÊTE --- */
.quest-timer {
    text-align: center;
    font-weight: 600;
    color: var(--text-on-light-secondary, #404040);
}

.shop-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
}

.shop-item {
    background: linear-gradient(135deg, #f3e5f5 0%, #ce93d8 100%);
    padding: 20px;
    border-radius: 12px;
    border: 1px solid #ab47bc;
    box-shadow: 0 4px 15px rgba(171, 71, 188, 0.3);
}

.shop-item-name {
    font-size: 18px;
    font-weight: bold;
    color: #6a1b9a;
    margin-bottom: 10px;
}

.shop-item-description {
    font-size: 13px;
    color: #ccc !important;
    margin-bottom: 15px;
    line-height: 1.4;
}

.shop-item-cost {
    font-size: 20px;
    font-weight: bold;
    color: #ffd700;
    margin-bottom: 15px;
}

.shop-buy-btn {
    width: 100%;
    padding: 10px;
    background: #5d4a3e !important;
    color: white !important;
    border: 2px solid #3b3b3b !important;
    border-radius: 8px !important;
    font-weight: 800;
    cursor: pointer;
    box-shadow: 0 4px 0 #3b3b3b;
}

.shop-buy-btn:hover:not(:disabled) {
    background: #7a614e !important;
}

.shop-buy-btn:disabled {
    background: #ccc !important;
    cursor: not-allowed;
    box-shadow: none;
}

.active-boosts {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    padding: 15px;
    border-radius: 10px;
    margin-bottom: 15px;
    color: #3b3b3b !important;
}

.boost-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px;
    margin-bottom: 10px;
    color: #fff !important;
}

.boost-name {
    font-weight: 800;
    color: #4ade80 !important;
}

.boost-timer {
    font-size: 11px;
    color: #aaa !important;
}

/* --- INVENTAIRE STYLE "QUÊTES" --- */

.inventory-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 12px;
    padding: 5px;
}

/* La Carte (Slot) */
.inventory-slot {
    background: transparent;
    border: none;
    border-radius: 12px;
    padding: 10px 10px 14px 10px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-start;
    aspect-ratio: 1 / 1.1;
    position: relative;
    cursor: pointer;
    transition: var(--transition-fast);
    box-shadow: none;
}

.inventory-slot:hover {
    transform: translateY(-3px);
    box-shadow: none;
    z-index: 5;
}

/* Icône */
.item-icon {
    font-size: 36px;
    margin: 8px 0;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.05));
    transition: transform 0.2s;
}

.inventory-slot:hover .item-icon {
    transform: scale(1.15);
}

/* Compteur */
.item-count {
    position: absolute;
    top: 6px;
    right: 6px;
    background: #3b3b3b !important;
    color: #fff !important;
    border: 1px solid #111 !important;
    font-size: 10px;
    font-weight: 800;
    padding: 2px 6px;
    border-radius: 12px;
}

/* Nom */
.item-name {
    font-size: 11px;
    color: #3b3b3b !important;
    font-weight: 900;
    text-align: center;
    line-height: 1.4;
    width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

/* Badge Équipement */
.item-type-badge {
    position: absolute;
    top: 6px;
    left: 6px;
    background: #e0e7ff;
    color: #4338ca;
    font-size: 8px;
    font-weight: 800;
    padding: 2px 5px;
    border-radius: 4px;
    text-transform: uppercase;
}

.inventory-slot.is-held-item {
    background-color: transparent;
}

.stat-boosts-list {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-top: 10px;
}

.stat-boost-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px;
    padding: 10px 15px;
    color: #fff !important;
}

.stat-boost-name {
    font-weight: 800;
    color: #4ade80 !important;
    display: flex;
    align-items: center;
    gap: 8px;
}

.stat-boost-timer {
    font-size: 11px;
    color: #aaa !important;
    background: rgba(0, 0, 0, 0.3) !important;
    padding: 4px 8px;
    border-radius: 12px;
}

/* =========================================
   MODAL D'ÉCLOSION — Mise en scène dramatique (Gacha juice)
   Lumière, tension, magie + séquence d'ouverture orchestrée
   ========================================= */

/* --- Keyframes : séquence d'ouverture Gacha --- */
@keyframes modalPopBounce {
    0% {
        opacity: 0;
        transform: scale(0.7);
    }

    40% {
        opacity: 1;
        transform: scale(1.05);
    }

    70% {
        transform: scale(0.98);
    }

    100% {
        opacity: 1;
        transform: scale(1);
    }
}

@keyframes pokemonFlashAppear {
    0% {
        opacity: 0;
        transform: scale(0.5) translateY(30px);
        filter: brightness(3) contrast(2) drop-shadow(0 10px 20px rgba(255, 215, 0, 0.45));
    }

    100% {
        opacity: 1;
        transform: scale(1) translateY(0);
        filter: brightness(1) contrast(1) drop-shadow(0 10px 20px rgba(255, 215, 0, 0.45)) drop-shadow(0 4px 8px rgba(0, 0, 0, 0.3));
    }
}

@keyframes fadeInUpShort {
    from {
        opacity: 0;
        transform: translateY(20px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes dropIn {
    0% {
        opacity: 0;
        transform: translateY(-40px);
    }

    100% {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Étape 1 : Mise en scène — fond marron moka (charte boisée) + halo doré */
#eggHatchModal.show {
    background: radial-gradient(ellipse 80% 70% at 50% 45%,
            rgba(255, 223, 128, 0.3) 0%,
            rgba(255, 193, 7, 0.12) 35%,
            rgba(45, 36, 30, 0.6) 60%,
            rgba(45, 36, 30, 0.95) 100%) !important;
    box-shadow: inset 0 0 120px rgba(45, 36, 30, 0.9) !important;
    backdrop-filter: blur(4px);
}

/* Boîte de contenu : marron moka très sombre (même univers que l’interface) */
#eggHatchModal #eggHatchContent {
    position: relative;
    opacity: 0;
    animation: modalPopBounce 0.6s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
    background: linear-gradient(165deg, #3e3228 0%, #2d241e 40%, #1f1a16 100%) !important;
    border: 4px solid var(--bg-tertiary, #5d4a3e) !important;
    border-radius: 12px !important;
    color: #f1f5f9 !important;
    box-shadow:
        var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.2)),
        0 6px 0 var(--bg-tertiary, #5d4a3e),
        0 0 0 1px rgba(212, 175, 55, 0.15),
        0 0 60px rgba(255, 223, 128, 0.25),
        0 0 120px rgba(255, 193, 7, 0.12),
        0 8px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
    overflow: visible;
}

#eggHatchModal #eggHatchContent h3 {
    color: #f8fafc !important;
    text-shadow: 0 0 12px rgba(255, 215, 0, 0.3);
}

#eggHatchModal #eggHatchContent .egg-hatch-stats {
    background: rgba(0, 0, 0, 0.35) !important;
    border: 1px solid rgba(255, 255, 255, 0.08);
    color: #e2e8f0 !important;
}

#eggHatchModal #eggHatchContent .egg-hatch-stats .creature-stats {
    color: #e2e8f0 !important;
}

/* Nom du Pokémon : slide up (T=0.5s) avec le titre */
#eggHatchModal #eggHatchContent .egg-hatch-name {
    opacity: 0;
    animation: fadeInUpShort 0.5s ease-out 0.5s forwards;
}

/* Types : slide up (T=0.6s) */
.egg-hatch-types {
    opacity: 0;
    animation: fadeInUpShort 0.5s ease-out 0.6s forwards;
}

/* Stats : slide up (T=0.6s) */
.egg-hatch-stats {
    opacity: 0;
    animation: fadeInUpShort 0.5s ease-out 0.6s forwards;
}

/* Bouton = même vert que Combattre / Acheter / Lancer l’ascension */
#eggHatchModal #eggHatchContent .btn-save,
#eggHatchModal #eggHatchContent .btn-super-confirm {
    opacity: 0;
    animation: fadeInUpShort 0.5s ease-out 0.8s forwards, egg-cta-pulse 2.2s ease-in-out 1.3s infinite;
    background: var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 3px 0 var(--accent-green-darker, #15803d) !important;
    border-radius: 6px;
    font-weight: 700;
    text-transform: uppercase;
    font-size: 13px;
}

#eggHatchModal #eggHatchContent .btn-save:hover,
#eggHatchModal #eggHatchContent .btn-super-confirm:hover {
    background: var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 2px 0 var(--accent-green-darker, #15803d) !important;
}

/* Étape 2 : Tension — tremblement du sprite (révélation vivante) */
@keyframes egg-reveal-shake {
    0% {
        transform: translate(0, 0) rotate(0deg);
    }

    10% {
        transform: translate(-3px, -1px) rotate(-2deg);
    }

    20% {
        transform: translate(3px, 1px) rotate(2deg);
    }

    30% {
        transform: translate(-4px, 2px) rotate(-3deg);
    }

    40% {
        transform: translate(4px, -2px) rotate(3deg);
    }

    50% {
        transform: translate(-2px, 1px) rotate(-1deg);
    }

    60% {
        transform: translate(2px, -1px) rotate(1deg);
    }

    70% {
        transform: translate(0, 0) rotate(0deg);
    }

    100% {
        transform: translate(0, 0) rotate(0deg);
    }
}

/* Sprite : flash d'apparition (T=0.3s) puis tremblement en boucle */
.egg-hatch-sprite {
    width: 128px;
    height: 128px;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    margin: 10px auto;
    display: block;
    opacity: 0;
    animation:
        pokemonFlashAppear 0.5s ease-out 0.3s forwards,
        egg-reveal-shake 2s ease-in-out 0.85s infinite;
}

/* Pulsation du titre et du bouton */
@keyframes egg-cta-pulse {

    0%,
    100% {
        transform: scale(1);
        opacity: 1;
    }

    50% {
        transform: scale(1.04);
        opacity: 0.95;
    }
}

/* Badge de rareté = même style que .rarity-label / badges du jeu (pill cohérent) */
#eggHatchModal .egg-hatch-rarity {
    display: inline-block;
    font-size: 10px;
    font-weight: bold;
    padding: 2px 6px;
    margin-bottom: 10px;
    border-radius: 8px;
    text-transform: uppercase;
    opacity: 0;
    animation: dropIn 0.4s ease-out 0.2s forwards;
    font-family: 'Outfit', sans-serif;
}

#eggHatchModal .egg-hatch-rarity.rarity-common {
    background: #6c757d;
    color: white;
}

#eggHatchModal .egg-hatch-rarity.rarity-rare {
    background: #28a745;
    color: white;
}

#eggHatchModal .egg-hatch-rarity.rarity-epic {
    background: #007bff;
    color: white;
}

#eggHatchModal .egg-hatch-rarity.rarity-legendary {
    background: #ffc107;
    color: #333;
}

/* Mini-retour visuel d'éclosion auto (même style, compact, en haut à droite) */
.auto-egg-hatch-mini-container {
    position: fixed;
    top: 20px;
    right: 20px;
    width: min(420px, calc(100vw - 24px));
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 10020;
    pointer-events: none;
}

.auto-egg-hatch-mini {
    opacity: 0;
    transform: translateY(-8px) scale(0.92);
    transition: opacity 0.2s ease, transform 0.2s ease;
    margin: 0 !important;
    padding: 14px 14px 12px !important;
    border-radius: 14px !important;
    box-shadow:
        var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.2)),
        0 6px 0 var(--bg-tertiary, #5d4a3e),
        0 0 0 1px rgba(212, 175, 55, 0.15),
        0 0 60px rgba(255, 223, 128, 0.25),
        0 0 120px rgba(255, 193, 7, 0.12),
        0 8px 32px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.05) !important;
    overflow: visible;
    background: linear-gradient(165deg, #3e3228 0%, #2d241e 40%, #1f1a16 100%) !important;
    border: 4px solid var(--bg-tertiary, #5d4a3e) !important;
}

.auto-egg-hatch-mini.show {
    opacity: 1;
    transform: translateY(0) scale(1);
}

.auto-egg-hatch-mini .egg-hatch-particles {
    opacity: 0.55;
}

.auto-egg-hatch-mini .egg-hatch-rarity {
    font-size: 10px;
    padding: 3px 8px;
    margin-bottom: 6px;
    border-radius: 999px !important;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: fit-content;
    min-height: 20px;
}

.auto-egg-hatch-mini .egg-hatch-rarity.rarity-common {
    background: #6c757d !important;
    color: white !important;
}

.auto-egg-hatch-mini .egg-hatch-rarity.rarity-rare {
    background: #28a745 !important;
    color: white !important;
}

.auto-egg-hatch-mini .egg-hatch-rarity.rarity-epic {
    background: #007bff !important;
    color: white !important;
}

.auto-egg-hatch-mini .egg-hatch-rarity.rarity-legendary {
    background: #ffc107 !important;
    color: #333 !important;
}

.auto-egg-hatch-mini .egg-hatch-title {
    font-size: 14px !important;
    margin-bottom: 4px !important;
}

.auto-egg-hatch-mini .egg-hatch-sprite {
    width: 68px !important;
    height: 68px !important;
    margin: 2px auto 4px !important;
}

.auto-egg-hatch-mini .egg-hatch-name {
    font-size: 16px !important;
    margin: 3px 0 6px !important;
}

.auto-egg-hatch-mini .egg-hatch-types {
    gap: 4px;
    margin-bottom: 6px;
}

.auto-egg-hatch-mini .type-badge {
    font-size: 9px;
    padding: 2px 6px;
}

.auto-egg-hatch-mini .egg-hatch-stats {
    padding: 7px !important;
    margin-top: 6px !important;
    overflow-wrap: anywhere;
}

.auto-egg-hatch-mini .egg-hatch-stats .creature-stats {
    font-size: 11px !important;
    line-height: 1.3;
}

.auto-egg-hatch-mini .btn-super-confirm,
.auto-egg-hatch-mini .btn-save {
    display: none !important;
}

/* Titre : même police que le reste du jeu (Outfit) */
.egg-hatch-title {
    font-family: 'Outfit', sans-serif;
    font-size: 24px;
    font-weight: 800;
    margin-bottom: 18px;
    letter-spacing: 0.02em;
    color: #fef08a !important;
    text-shadow:
        0 0 20px rgba(255, 215, 0, 0.5),
        0 0 40px rgba(255, 193, 7, 0.25),
        0 2px 4px rgba(0, 0, 0, 0.5);
    opacity: 0;
    animation: fadeInUpShort 0.5s ease-out 0.5s forwards, egg-cta-pulse 2s ease-in-out 1s infinite;
}

#eggHatchContent .btn-save {
    animation: egg-cta-pulse 2.2s ease-in-out infinite;
}

/* Étape 3 : Magie — particules qui s'élèvent */
.egg-hatch-particles {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    overflow: hidden;
    border-radius: inherit;
}

.egg-particle {
    position: absolute;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(255, 235, 150, 0.95) 0%, rgba(255, 193, 7, 0.4) 100%);
    box-shadow: 0 0 8px rgba(255, 223, 128, 0.8);
    animation: egg-particle-rise 3s ease-in infinite;
}

.egg-particle:nth-child(1) {
    left: 15%;
    bottom: 10%;
    animation-delay: 0s;
    animation-duration: 2.8s;
}

.egg-particle:nth-child(2) {
    left: 35%;
    bottom: 5%;
    animation-delay: 0.4s;
    animation-duration: 3.2s;
}

.egg-particle:nth-child(3) {
    left: 50%;
    bottom: 15%;
    animation-delay: 0.2s;
    animation-duration: 2.6s;
}

.egg-particle:nth-child(4) {
    left: 65%;
    bottom: 8%;
    animation-delay: 0.6s;
    animation-duration: 3s;
}

.egg-particle:nth-child(5) {
    left: 80%;
    bottom: 12%;
    animation-delay: 0.3s;
    animation-duration: 2.9s;
}

.egg-particle:nth-child(6) {
    left: 25%;
    bottom: 20%;
    animation-delay: 0.5s;
    animation-duration: 3.1s;
}

.egg-particle:nth-child(7) {
    left: 70%;
    bottom: 18%;
    animation-delay: 0.1s;
    animation-duration: 2.7s;
}

.egg-particle:nth-child(8) {
    left: 45%;
    bottom: 3%;
    animation-delay: 0.7s;
    animation-duration: 3.3s;
}

@keyframes egg-particle-rise {
    0% {
        transform: translateY(0) scale(1);
        opacity: 0.9;
    }

    70% {
        transform: translateY(-80px) scale(0.6);
        opacity: 0.4;
    }

    100% {
        transform: translateY(-120px) scale(0.3);
        opacity: 0;
    }
}

.egg-hatch-stats {
    background: rgba(0, 0, 0, 0.05);
    padding: 15px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: left;
}

.egg-hatch-stats .creature-stats {
    font-size: 14px;
    color: #333;
    line-height: 1.6;
}

/* Variantes Shiny / Légendaire : fonds festifs, titre reste doré avec ombre */
#eggHatchContent.shiny {
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 25%, #ffd700 50%, #ffed4e 75%, #ffd700 100%) !important;
    background-size: 200% 200%;
    animation: shiny-sparkle 2s ease-in-out infinite, gradient-shift 3s ease infinite;
    border: 2px solid #ffd700;
    color: #1e293b !important;
}

#eggHatchContent.shiny .egg-hatch-title {
    color: #b45309 !important;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 2px 4px rgba(0, 0, 0, 0.3);
}

#eggHatchContent.shiny h3,
#eggHatchContent.shiny .egg-hatch-stats .creature-stats {
    color: #1e293b !important;
}

#eggHatchContent.shiny .egg-hatch-stats {
    background: rgba(255, 255, 255, 0.4) !important;
    color: #1e293b !important;
}

#eggHatchContent.legendary {
    background: linear-gradient(135deg, #fff3cd 0%, #ffd60a 100%) !important;
    box-shadow:
        0 0 0 1px rgba(255, 215, 0, 0.3),
        0 0 60px rgba(255, 223, 128, 0.5),
        0 0 40px rgba(255, 193, 7, 0.8) !important;
    animation: legendary-glow 2s ease-in-out infinite alternate;
    color: #1e293b !important;
}

#eggHatchContent.legendary .egg-hatch-title {
    color: #b45309 !important;
    text-shadow: 0 0 20px rgba(255, 215, 0, 0.8), 0 2px 4px rgba(0, 0, 0, 0.3);
}

#eggHatchContent.legendary h3,
#eggHatchContent.legendary .egg-hatch-stats .creature-stats {
    color: #1e293b !important;
}

#eggHatchContent.legendary .egg-hatch-stats {
    background: rgba(255, 255, 255, 0.35) !important;
    color: #1e293b !important;
}

/* ✅ FIN DES STYLES D'ÉCLOSION */

/* ✅ STYLES POUR LE MODAL DE GESTION — Carte compacte, sans scroll */
#creatureModal .stats-content {
    max-width: 720px;
    max-height: 88vh;
    overflow: hidden;
    padding: 16px 20px;
    display: flex;
    flex-direction: column;
}

#creatureModal .stats-header {
    margin-bottom: 12px;
    padding-bottom: 10px;
    flex-shrink: 0;
}

#creatureModal .stats-header h2 {
    font-size: 1.25rem;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.creature-modal-grid {
    display: grid;
    grid-template-columns: 110px 1fr;
    gap: 16px;
    align-items: start;
    flex: 1;
    min-height: 0;
}

.creature-modal-sprite-wrap {
    text-align: center;
    position: sticky;
    top: 0;
}

.creature-modal-sprite {
    width: 96px;
    height: auto;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    background: rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.creature-modal-badges {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 4px;
    margin-top: 6px;
}

.creature-modal-badges .type-badge,
.creature-modal-badges .rarity-label {
    font-size: 10px;
    padding: 2px 6px;
}

.creature-modal-main {
    display: flex;
    flex-direction: column;
    gap: 10px;
    min-width: 0;
    min-height: 0;
    overflow-y: auto;
    overflow-x: hidden;
    max-height: calc(88vh - 60px);
}

.creature-modal-tokens {
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 11px;
    text-align: center;
    background: #5d4a3e !important;
    border: 2px solid #3b3b3b !important;
    color: #fff !important;
    font-weight: 800;
}

.creature-modal-stats-box {
    background: #3b3b3b !important;
    padding: 12px 15px !important;
    border-radius: 10px !important;
    border: 2px solid #1a1a1a !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5) !important;
    color: #fff !important;
    margin-bottom: 10px !important;
}

.creature-modal-stats-box .creature-modal-stats-box-title {
    margin: 0 0 10px 0;
    color: #fff !important;
    font-size: 11px;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 800;
    border-bottom: 1px solid #555;
    padding-bottom: 5px;
}

.creature-modal-stats-box .stat-iv {
    font-size: 10px;
    color: #475569;
    font-weight: 700;
    background: #e2e8f0;
    padding: 2px 6px;
    border-radius: 10px;
    display: inline-block;
    margin-left: 4px;
}

.creature-modal-stats-box .stat-iv-tooltip {
    cursor: help;
    border: none;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, transform 0.2s, opacity 0.2s, box-shadow 0.2s, filter 0.2s;
}

.creature-modal-stats-box .stat-iv-tooltip:hover {
    background: #cbd5e1;
    color: #1e293b;
}

.creature-modal-stats-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px 16px;
    font-size: 12px;
    line-height: 1.6;
}

.creature-modal-stats-row strong {
    color: #aaa !important;
    font-weight: 700;
}

.creature-modal-stats-row .stat-value {
    color: #fff !important;
    font-weight: 800;
}

.creature-modal-stats-row .stat-item-inner {
    display: flex;
    align-items: center;
    gap: 4px;
    flex-wrap: wrap;
}

.creature-modal-cards {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 8px;
}

.creature-modal-info-box {
    background: var(--surface-light-alt, #f5f5f4);
    padding: 10px 12px;
    border-radius: 8px;
    border-left: 4px solid var(--border-accent, #a3a3a3);
    transition: var(--transition-fast, 0.15s ease);
}

.creature-modal-info-box h5 {
    margin: 0 0 6px 0;
    font-size: 10px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-weight: 800;
}

.creature-modal-move-box .creature-modal-move-title {
    margin: 0 0 6px 0;
}

/* Container query : permet au move-pill de rétrécir sa police selon l'espace dispo */
.creature-modal-move-box {
    container-type: inline-size;
}

.creature-modal-info-box p,
.creature-modal-info-box .modal-move-details {
    margin: 0;
    font-size: 12px;
    line-height: 1.4;
}

.modal-move-details {
    display: flex;
    align-items: center;
    gap: 8px;
    flex-wrap: nowrap;
    overflow: hidden;
    color: var(--text-on-light, #1a1a1a);
}

/* Pillule du move : couleur = type, forme pill (chartre design) */
.move-pill {
    display: inline-block;
    padding: 4px 12px;
    border-radius: 9999px;
    font-size: clamp(8px, 3.5cqw, 12px);
    font-weight: 800;
    letter-spacing: 0.02em;
    border: 2px solid transparent;
    box-shadow: var(--shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.08));
    white-space: nowrap;
    flex-shrink: 1;
    min-width: 0;
}

.move-category {
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 8px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.03em;
}

.move-category.physical {
    background: var(--accent-red, #ef4444);
    color: var(--text-on-dark, #fafafa);
}

.move-category.special {
    background: var(--accent-blue, #3b82f6);
    color: var(--text-on-dark, #fafafa);
}

.move-power {
    font-size: 11px;
    color: var(--text-on-light-tertiary, #525252);
}

/* Bouton CT inline dans le move-details */
.btn-ct-inline {
    background: rgba(6, 182, 212, 0.18);
    border: 1px solid rgba(6, 182, 212, 0.5);
    border-radius: 6px;
    padding: 2px 4px;
    line-height: 1;
    cursor: pointer;
    color: inherit;
    margin-left: auto;
    display: inline-flex;
    align-items: center;
    align-self: center;
    transition: background 0.15s, transform 0.1s;
    flex-shrink: 0;
}

.btn-ct-inline:hover {
    background: rgba(6, 182, 212, 0.38);
    transform: scale(1.12);
}

.btn-ct-sprite {
    width: 20px;
    height: 20px;
    display: block;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
}


.creature-modal-info {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 6px;
    font-size: 11px;
    line-height: 1.4;
}

.creature-modal-info>div {
    background: #f4f4f5;
    padding: 6px 8px;
    border-radius: 6px;
    border-left: 3px solid #8b5cf6;
}

.creature-modal-info>div strong {
    font-size: 11px;
}

.creature-modal-info span[style*="font-size: 12px"] {
    font-size: 10px !important;
    color: #555;
}

.creature-modal-actions {
    display: flex;
    flex-wrap: nowrap;
    gap: 6px;
    padding-top: 10px;
    border-top: 1px solid #e5e7eb;
    margin-top: 4px;
    flex-shrink: 0;
    overflow-x: auto;
    overflow-y: hidden;
}

.creature-modal-actions .btn {
    flex: 1 1 0;
    min-width: 0;
    max-width: none;
    font-size: 11px;
    padding: 7px 8px;
    box-sizing: border-box;
    white-space: nowrap;
}

/* Les boutons du creature-modal restent sur une seule ligne même sur mobile */

/* Objet tenu dans le modal */
.creature-modal-info .held-item-slot {
    padding: 6px 8px;
    font-size: 11px;
}

.creature-modal-info .held-item-slot div[style*="font-size:10px"] {
    font-size: 9px !important;
}

/* Fix de contraste pour les infos du modal (Talent, Ultime) */
.creature-modal-info {
    background: rgba(30, 41, 59, 0.9) !important;
    color: #f1f5f9 !important;
    padding: 12px !important;
    border-radius: 8px !important;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    margin-top: 5px;
    display: flex;
    flex-direction: column;
    gap: 4px;
}

.creature-modal-info div {
    color: #1c334b !important;
    font-size: 13px !important;
    line-height: 1.4;
}

.creature-modal-info strong {
    color: #fbbf24 !important;
    /* Amber-400 (Or) pour les labels */
    font-weight: 800;
}

/* ✅ FIN DES STYLES DE GESTION */
/* ✅ SÉLECTEURS MODIFIÉS pour inclure Stockage et Pension */
#teamList,
#storageList,
#pensionList {
    /* auto-fill est mieux pour le stockage/pension */
    grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
    gap: 8px;
    margin-bottom: 15px;
}

/* On force la grille de l'équipe à 3 colonnes fixes */
#teamList {
    grid-template-columns: repeat(3, 1fr);
}

/* On applique le style de carte aux trois sections */
#teamList .creature-card,
#storageList .creature-card,
#pensionList .creature-card {
    padding: 8px;
    text-align: center;
    cursor: pointer;
    min-height: 110px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    overflow: hidden;
    box-sizing: border-box;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

#teamList .creature-card:hover,
#storageList .creature-card:hover,
#pensionList .creature-card:hover {
    transform: translateY(-3px);
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
    background: var(--bg-secondary, #7a614e) !important;
}

/* Styles spécifiques (actifs, KO) - s'appliquent surtout à teamList */
#teamList .creature-card.active {
    border-color: #22c55e;
    background: #e0f8e9;
    box-shadow: 0 0 15px rgba(34, 197, 94, 0.5);
}

#teamList .creature-card.fainted,
#storageList .creature-card.fainted,
#pensionList .creature-card.fainted {
    filter: grayscale(100%) brightness(0.7) !important;
    opacity: 0.5 !important;
    background: #e2e8f0 !important;
    border-color: #94a3b8 !important;
    cursor: not-allowed !important;
}

#teamList .creature-card.fainted img,
#storageList .creature-card.fainted img,
#pensionList .creature-card.fainted img {
    filter: grayscale(100%) opacity(0.7) !important;
}

/* Curseurs : indiquer que la carte est déplaçable */
#teamList .creature-card {
    cursor: grab;
}

#teamList .creature-card:active {
    cursor: grabbing;
}

#teamList .creature-card.team-card-dragging {
    cursor: grabbing;
    opacity: 0.5;
}

/* Zone de dépôt : feedback clair */
#teamList .creature-card.team-drag-over {
    box-shadow: inset 0 0 0 3px var(--accent-gold-dark, #f59e0b);
    background: #fffef7 !important;
    transform: scale(1.02);
    transition: transform 0.12s ease, box-shadow 0.12s ease;
}

/* Dépôt sur emplacement vide */
#teamList .team-slot-empty.team-drag-over {
    background: rgba(245, 158, 11, 0.2) !important;
    border-color: var(--accent-gold-dark, #f59e0b);
    border-style: solid;
}

/* Le reste des styles de slot est inchangé */
.team-slot-sprite {
    width: 64px;
    height: 64px;
    image-rendering: pixelated;
    image-rendering: crisp-edges;
    margin-bottom: 3px;
}

.team-slot-name {
    font-size: 14px;
    font-weight: 800;
    color: #3b3b3b !important;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
}

.team-slot-level {
    font-size: 12px;
    color: #555 !important;
}

.team-slot-info {
    font-size: 11px;
    font-weight: 800;
    color: #3b3b3b !important;
    display: flex;
    justify-content: space-between;
    width: 100%;
    margin-top: 5px;
    padding: 0 5px;
}

/* C'est le "bouton vide" */
.team-slot-empty {
    padding: 10px;
    background: rgba(0, 0, 0, 0.05);
    border: 1px dashed #ccc;
    border-radius: 10px;
    min-height: 120px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 24px;
    color: #ccc;
    font-weight: bold;
    cursor: default;
}

/* ✅ FIN DES NOUVEAUX STYLES */

/* ✅ NOUVEAUX STYLES POUR LE RÉSUMÉ DES TALENTS */

/* Conteneur principal */
#activeTalentsDisplay {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    box-shadow: 0 4px 0 #3b3b3b;
}

#activeTalentsDisplay h3 {
    margin: 0 0 10px 0;
    color: #3b3b3b !important;
    font-weight: 800;
    font-size: 16px;
    text-transform: uppercase;
}

/* La nouvelle grille pour les talents */
.talent-summary-grid {
    display: grid;
    /* S'adapte au nombre de talents, avec une taille min/max */
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 8px;
}

/* La "carte" individuelle pour chaque talent */
.talent-chip {
    padding: 8px 10px;
    border-radius: 8px;
    border: 2px solid #3b3b3b !important;
    background: #3b3b3b !important;
    color: #fff !important;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

.talent-chip:hover {
    transform: scale(1.03);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
}

.talent-chip-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-weight: bold;
    font-size: 13px;
}

.talent-chip-effect {
    font-size: 12px;
    font-weight: bold;
    color: #22c55e;
    /* Bonus en vert */
    margin-top: 5px;
}

/* Couleurs basées sur la rareté du talent */
.talent-chip.epic {
    border-color: #9333ea;
    color: #9333ea;
}

.talent-chip.legendary {
    border-color: #ffd700;
    color: #b45309;
    /* Couleur foncée pour le texte sur fond clair */
}

/* ✅ FIN DES NOUVEAUX STYLES */






.hud-stats {
    margin-top: 8px;
    display: flex;
    justify-content: center;
    gap: 8px;
}

.hud-stat {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: 'Outfit', sans-serif;
    min-width: 56px;
    /* même largeur pour toutes les stats */
}

.hud-stat-pill {
    width: 100%;
    box-sizing: border-box;
    padding: 3px 6px;
    border-radius: 999px;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.5px;
    text-transform: uppercase;
    text-align: center;
    color: #0f172a;
    background: linear-gradient(135deg, #e5f8ff, #bfdbfe);
    box-shadow: 0 1px 0 rgba(15, 23, 42, 0.35);
}

/* Couleurs de pills alignées sur le header (ATK / ATK SP / DEF / DEF SP / SPD) */
.hud-stats .hud-stat:nth-child(1) .hud-stat-pill {
    background: linear-gradient(135deg, #fbbf24, #f59e0b);
    /* ATK - orange comme headerStatAtk */
}

.hud-stats .hud-stat:nth-child(2) .hud-stat-pill {
    background: linear-gradient(135deg, #f472b6, #ec4899);
    /* ATK SP - rose comme headerStatSpAtk */
}

.hud-stats .hud-stat:nth-child(3) .hud-stat-pill {
    background: linear-gradient(135deg, #60a5fa, #3b82f6);
    /* DEF - bleu comme headerStatDef */
}

.hud-stats .hud-stat:nth-child(4) .hud-stat-pill {
    background: linear-gradient(135deg, #6ee7b7, #10b981);
    /* DEF SP - vert comme headerStatSpDef */
}

.hud-stats .hud-stat:nth-child(5) .hud-stat-pill {
    background: linear-gradient(135deg, #a855f7, #8b5cf6);
    /* SPD - violet comme headerStatSpd */
}

.hud-stat-value {
    margin-top: 2px;
    font-size: 12px;
    font-weight: 800;
    color: #f9fafb;
    text-shadow: 0 1px 1px rgba(0, 0, 0, 0.8);
}



/* On cache l'ancien bouton ultime (qui est maintenant dans le HUD) */
.main-fighter-display #ultimateButton {
    display: none;
}

/* ✅ FIN DES MODIFICATIONS DE SCÈNE */

/* --- COLONNE DROITE (EXTRAS) --- */

.secondary-content {
    display: flex !important;
    flex-direction: column;
    background: #947864 !important;
    border-left: 4px solid #5d4a3e !important;
    padding: 0 !important;
    overflow-y: auto;
    position: relative;
}

/* Theme mode only: make the 3 main content panels slightly transparent
   so the themed background remains visible behind them. */
.game-container.has-themed-header-bg .team-area,
.game-container.has-themed-header-bg .combat-area,
.game-container.has-themed-header-bg .secondary-content {
    background: rgba(148, 120, 100, 0.25) !important;
}

.game-container.has-themed-header-bg .tab-content {
    background: rgba(148, 120, 100, 0.25) !important;
}

.game-container.has-themed-header-bg .combat-area .zone-selector,
.game-container.has-themed-header-bg .combat-area .combat-controls-wrapper {
    background: rgba(190, 195, 198, 0.25) !important;
    border-color: rgba(59, 59, 59, 0.50) !important;
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
}

.game-container.has-themed-header-bg .tabs-container {
    background: rgba(190, 195, 198, 0.25) !important;
    border-bottom-color: rgba(59, 59, 59, 0.50) !important;
    backdrop-filter: blur(2px);
    -webkit-backdrop-filter: blur(2px);
}

/* Barre des Onglets (Fixe en haut) */
.tabs-container {
    display: flex;
    flex-wrap: wrap;
    gap: 5px;
    padding: 10px;
    background: #bec3c6 !important;
    /* Retro gray background for tab bar */
    border-bottom: 3px solid #3b3b3b !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
    z-index: 5;
    flex-shrink: 0;
}

/* Boutons d'onglets */
.tab-btn {
    flex: 1 1 auto;
    text-align: center;
    padding: 8px 12px;
    font-size: 11px;
    font-weight: 800;
    color: #fff !important;
    background: #5d4a3e !important;
    border: 2px solid #3b3b3b !important;
    border-radius: 6px;
    cursor: pointer;
    transition: background-color 0.1s ease, color 0.1s ease, border-color 0.1s ease, transform 0.1s ease, opacity 0.1s ease, box-shadow 0.1s ease, filter 0.1s ease;
    position: relative;
    box-shadow: 0 3px 0 #3b3b3b;
    text-transform: uppercase;
}

.tab-btn:hover {
    background: #7a614e !important;
    transform: translateY(1px);
    box-shadow: 0 2px 0 #3b3b3b;
}

.tab-btn.active {
    background: #3b3b3b !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5) !important;
    transform: translateY(2px) !important;
    border-color: #1a1a1a !important;
}

/* Le Badge de notification (petit point rouge) */
.notification-badge {
    top: 2px;
    right: 2px;
    border: 2px solid white;
    /* Petit contour blanc pour détacher */
}

/* Zone de contenu des onglets */
.tab-content {
    display: none;
    padding: 15px;
    overflow-y: auto;
    height: 100%;
    background: #947864 !important;
    /* Ensure brown background */
    animation: fadeIn 0.3s ease;
}

.tab-content.active {
    display: block;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(5px);
    }

    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Sous-onglets de la boutique (Épicerie, Jetons...) */
.sub-tabs-container {
    display: flex;
    gap: 5px;
    margin-bottom: 15px;
    padding-bottom: 10px;
    border-bottom: 3px solid #3b3b3b !important;
    overflow-x: auto;
    white-space: nowrap;
}

.sub-tab-btn {
    background: #5d4a3e !important;
    color: white !important;
    border: 2px solid #3b3b3b !important;
    box-shadow: 0 3px 0 #3b3b3b !important;
}

.sub-tab-btn.active {
    background: #3b3b3b !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5) !important;
    transform: translateY(2px) !important;
}

/* =========================================
   ONGLET BOUTIQUE — Même modèle que Quêtes / Arènes / Sac
   Cartes claires (blanc cassé), textes sombres, bordures discrètes
   ========================================= */

#boutiqueTab .sub-tabs-container {
    border-bottom-color: var(--border-light, #e7e5e4) !important;
}

#boutiqueTab .sub-tab-btn {
    background: var(--surface-light, #fafaf9) !important;
    color: var(--text-on-light, #1a1a1a) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    box-shadow: var(--shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.05)) !important;
}

#boutiqueTab .sub-tab-btn:hover {
    background: var(--surface-light-hover, #e7e5e4) !important;
    border-color: var(--accent-gold-dark, #f59e0b) !important;
}

#boutiqueTab .sub-tab-btn.active {
    background: var(--accent-gold-dark, #f59e0b) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border-color: var(--accent-gold-darker, #d97706) !important;
    box-shadow: 0 2px 0 var(--accent-gold-darker, #d97706) !important;
}

#boutiqueTab .shop-wallet {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light, #1a1a1a) !important;
}


#boutiqueTab .shop-intro {
    color: var(--text-on-light-secondary, #404040) !important;
}

#boutiqueTab h3,
#boutiqueTab h4 {
    color: var(--text-on-light, #1a1a1a) !important;
}

/* Cartes boutique : fond clair, bordure gauche accent */
#boutiqueTab .shop-item,
#boutiqueTab .upgrade-card {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    border-left: 5px solid var(--accent-gold-dark, #f59e0b) !important;
    border-bottom-width: 2px !important;
    color: var(--text-on-light, #1a1a1a) !important;
    box-shadow: var(--shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.06)) !important;
}

#boutiqueTab .shop-item:hover,
#boutiqueTab .upgrade-card:hover {
    background: var(--surface-light-alt, #f5f5f4) !important;
    border-color: var(--border-light, #e7e5e4) !important;
    border-left-color: var(--accent-gold-dark, #f59e0b) !important;
    box-shadow: var(--shadow-md, 0 4px 6px rgba(0, 0, 0, 0.08)) !important;
}

#boutiqueTab .shop-item-name,
#boutiqueTab .upgrade-title {
    color: var(--text-on-light, #1a1a1a) !important;
}

#boutiqueTab .shop-item-description,
#boutiqueTab .shop-item-desc,
#boutiqueTab .upgrade-desc,
#boutiqueTab .upgrade-description {
    color: var(--text-on-light-secondary, #404040) !important;
}

#boutiqueTab .shop-item-cost,
#boutiqueTab .upgrade-cost {
    color: var(--accent-gold-darker, #d97706) !important;
}

#boutiqueTab .shop-buy-btn {
    background: var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 3px 0 var(--accent-green-darker, #15803d) !important;
}

#boutiqueTab .shop-buy-btn:hover:not(:disabled) {
    background: var(--accent-green-dark, #16a34a) !important;
    box-shadow: 0 2px 0 var(--accent-green-darker, #15803d) !important;
}

#boutiqueTab .shop-buy-btn:disabled {
    background: var(--surface-light-hover, #e7e5e4) !important;
    color: var(--text-on-light-muted, #737373) !important;
    border-color: var(--border-light, #e7e5e4) !important;
    box-shadow: none !important;
}

#boutiqueTab .upgrade-btn {
    background: var(--accent-green, #22c55e) !important;
    color: var(--text-on-dark, #fafafa) !important;
    border: 2px solid var(--accent-green-dark, #16a34a) !important;
}

#boutiqueTab .upgrade-btn:disabled {
    background: var(--surface-light-hover, #e7e5e4) !important;
    color: var(--text-on-light-muted, #737373) !important;
    border-color: var(--border-light, #e7e5e4) !important;
}

/* Recycler : cartes claires */
#boutiqueTab .recycler-header {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light, #1a1a1a) !important;
    border-radius: 8px;
    padding: 10px 12px;
    margin-bottom: 10px;
}

#boutiqueTab .recycler-header .essence-count {
    color: var(--accent-gold-darker, #d97706);
}

#boutiqueTab .recycler-item,
#boutiqueTab .dust-shop-item {
    background: var(--surface-light, #fafaf9) !important;
    border: 2px solid var(--border-light, #e7e5e4) !important;
    color: var(--text-on-light, #1a1a1a) !important;
    box-shadow: var(--shadow-sm, 0 1px 2px rgba(0, 0, 0, 0.05)) !important;
}

#boutiqueTab .recycler-item-name,
#boutiqueTab .dust-shop-item .shop-item-name {
    color: var(--text-on-light, #1a1a1a) !important;
}

#boutiqueTab .recycler-btn {
    background: var(--accent-gold-dark, #f59e0b) !important;
    color: var(--text-on-dark, #fafafa) !important;
}

#boutiqueTab .recycler-btn:hover {
    background: var(--accent-gold-darker, #d97706) !important;
}

#boutiqueTab .dust-shop-item .shop-buy-btn {
    background: var(--accent-gold-dark, #f59e0b) !important;
    border-color: var(--accent-gold-darker, #d97706) !important;
}

#boutiqueTab .dust-shop-item .shop-buy-btn:hover:not(:disabled) {
    background: var(--accent-gold-darker, #d97706) !important;
}

#boutiqueTab .recycler-list,
#boutiqueTab .recycler-shop {
    background: var(--surface-light-alt, #f5f5f4) !important;
    border: 1px solid var(--border-light, #e7e5e4);
    border-radius: 8px;
}

/* Not affordable : discret */
#boutiqueTab .shop-item.not-affordable,
#boutiqueTab .upgrade-card.not-affordable {
    opacity: 0.85;
    border-left-color: var(--border-light, #e7e5e4) !important;
}

#boutiqueTab .upgrade-card.maxed,
#boutiqueTab .shop-item.maxed {
    filter: grayscale(0.6);
    opacity: 0.85;
    border-left-color: var(--border-light, #e7e5e4) !important;
}

/* Grille des Upgrades et Objets */
.upgrades-container,
.shop-container,
.items-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    /* Cartes plus petites et adaptatives */
    gap: 10px;
    justify-content: center;
}

/* Style de la Carte (Générique) */
.upgrade-card,
.shop-item,
.item-card {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-bottom: 4px solid #111 !important;
    border-radius: 8px !important;
    padding: 12px !important;
    color: white !important;
    transition: transform 0.1s !important;
}

#teamrocketTab .team-rocket-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 12px;
}

#teamrocketTab {
    background:
        linear-gradient(rgba(15, 23, 42, 0.82), rgba(15, 23, 42, 0.82)),
        url("img/rocket-menu.png") !important;
    background-size: cover !important;
    background-position: center !important;
    background-repeat: no-repeat !important;
}

#teamrocketTab .tr-input-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    gap: 8px;
    align-items: center;
}

#teamrocketTab .tr-input-row input {
    min-width: 0;
    width: 100%;
    max-width: 100%;
    box-sizing: border-box;
}

#teamrocketTab .tr-bank-card {
    position: relative;
}

#teamrocketTab .tr-bank-gear-btn {
    position: absolute;
    top: 8px;
    right: 8px;
    width: 28px;
    height: 28px;
    border-radius: 999px;
    border: 1px solid #334155;
    background: #111827;
    color: #cbd5e1;
    cursor: pointer;
}

#teamrocketTab .tr-bank-options {
    display: none;
    margin-top: 8px;
    padding-top: 8px;
    border-top: 1px solid #334155;
}

#teamrocketTab .tr-bank-options.open {
    display: block;
}

#rocketContractSelectList .rocket-contract-select-card {
    overflow: hidden;
}

#rocketContractSelectList .rocket-contract-select-row {
    display: grid;
    grid-template-columns: auto 44px minmax(0, 1fr);
    align-items: center;
    gap: 8px;
}

#rocketContractSelectList .rocket-contract-select-meta {
    min-width: 0;
}

#rocketContractSelectList .rocket-contract-select-meta .shop-item-name,
#rocketContractSelectList .rocket-contract-select-meta .shop-item-description {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

#teamrocketTab .rocket-push-live-wrap {
    display: flex;
    gap: 12px;
    align-items: center;
    margin: 10px 0;
}

#teamrocketTab .rocket-push-timer-circle {
    --progress: 0;
    width: 86px;
    height: 86px;
    border-radius: 999px;
    background: conic-gradient(#ef4444 calc(var(--progress) * 1%), #1f2937 0);
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    flex: 0 0 86px;
}

#teamrocketTab .rocket-push-timer-circle::after {
    content: "";
    position: absolute;
    inset: 7px;
    border-radius: 999px;
    background: #0f172a;
    border: 1px solid #334155;
}

#teamrocketTab .rocket-push-timer-text {
    position: relative;
    z-index: 1;
    font-size: 12px;
    font-weight: 700;
    color: #e2e8f0;
}

#teamrocketTab .rocket-risk-shake {
    animation: rocketRiskShake 0.35s linear infinite;
    border-color: #ef4444 !important;
}

#teamrocketTab .rocket-steal-feedback {
    border-color: #ef4444 !important;
    background: linear-gradient(135deg, rgba(127, 29, 29, 0.55), rgba(15, 23, 42, 0.92)) !important;
    box-shadow: 0 0 0 1px rgba(239, 68, 68, 0.35), 0 8px 20px rgba(127, 29, 29, 0.35);
}

.rocket-casino-modal-content {
    width: min(92vw, 1080px);
    max-width: 1080px;
    position: relative;
    background: #0f172a !important;
    border-color: #334155 !important;
}

.rocket-casino-modal-grid {
    display: grid;
    grid-template-columns: 1.4fr 1fr;
    gap: 14px;
}

.rocket-casino-main,
.rocket-casino-side {
    background: #0f172a;
    border: 1px solid #334155;
    border-radius: 10px;
    padding: 12px;
}

/* Affichage Jeton Rocket : plus grand, ancrage pour le floating text */
.rocket-casino-rj-display {
    font-size: 1.35rem;
    font-weight: 700;
    min-height: 2.5em;
    display: flex;
    align-items: center;
}

/* Floating text du casino : part du bloc Jeton Rocket */
/* Floating text du casino : part du bloc Jeton Rocket (left géré en JS) */
.floating-text.ft-from-rj {
    bottom: 0 !important;
}

/* Pas de cadre autour de la borne : seule l'image de la machine est visible */
.rocket-casino-main:has(.slots-machine) {
    background: transparent;
    border: none;
    border-radius: 0;
    padding: 0;
}

.rocket-casino-grid3x3 {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 10px;
    margin: 10px 0;
}

.rocket-casino-cell {
    height: 96px;
    border-radius: 1px;
    border: 2px solid #334155;
    background: linear-gradient(180deg, #1f2937, #111827);
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.35);
}

.rocket-casino-cell.revealed {
    border-color: #64748b;
}

.rocket-casino-cell.win-highlight {

    box-shadow: inset 0 0 20px rgba(22, 163, 74, 0.55);
    animation: rocketLineWinPulse 0.28s ease-in-out 2;
}

.rocket-casino-symbol-img {
    width: 68px;
    height: 68px;
    image-rendering: pixelated;
    object-fit: contain;
}

.rocket-casino-cell-mask {
    display: flex;
    width: 100%;
    height: 100%;
    align-items: center;
    justify-content: center;
    color: #94a3b8;
    font-size: 22px;
    font-weight: 700;
}

.rocket-casino-mini-symbol {
    width: 24px;
    height: 24px;
    object-fit: contain;
    image-rendering: pixelated;
}

/* --- Machine à sous Team Rocket : incrustation (masking) + scanlines --- */
/* Conteneur principal = dimensions de la borne (aspect de slots-machine.png) */
.slots-machine {
    position: relative;
    width: 100%;
    max-width: 960px;
    margin: 0 auto;
    aspect-ratio: 960 / 1030;
    background: #0f172a;
    display: block;
}

/* Cadre de la borne au premier plan (z-index 15), ne bloque pas les clics */
.slots-machine-frame {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;

    object-position: center;
    z-index: 15;
    pointer-events: none;
}

/* Écran (grille 3x3) DERRIÈRE le cadre — positionnée dans la zone transparente du PNG */
.slots-machine-screen {
    position: absolute;
    top: 27.3%;
    left: 50%;
    transform: translateX(-50%);
    width: 75%;
    height: 47.2%;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 5;
    overflow: hidden;
}

.slots-machine-screen .rocket-casino-grid3x3 {
    width: 100%;
    height: 100%;
    margin: 0;
    gap: 0px;
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: repeat(3, 1fr);
}

/* Mode bandes défilantes : 3 colonnes = 3 rouleaux, hauteur garantie pour rester visible */
.slots-machine-screen .rocket-casino-grid3x3.rocket-casino-reels-mode {
    grid-template-columns: repeat(3, 1fr);
    grid-template-rows: 1fr;
    min-height: 120px;
}

.rocket-casino-reel {
    overflow: hidden;
    height: 100%;
    min-height: 100px;
    position: relative;
}

.rocket-casino-reel-strip {
    display: flex;
    flex-direction: column;
    height: 500%;
    transform: translateY(0);
    will-change: transform;
    flex-shrink: 0;
}

.rocket-casino-reel-symbol {
    flex: 0 0 6.6667%;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 0;
    background: linear-gradient(180deg, #1f2937, #111827);
}

.rocket-casino-reel-symbol .rocket-casino-symbol-img {
    width: 85%;
    height: 85%;
    object-fit: contain;
    image-rendering: pixelated;
}

.slots-machine-screen .rocket-casino-cell {
    height: auto;
    border-radius: 0;
    border: 1px solid rgba(0, 0, 0, 0.25);
    min-height: 0;
}

/* Scanlines (entre grille et cadre) — effet écran cathodique */
.slots-machine-scanlines {
    position: absolute;
    top: 18%;
    left: 50%;
    transform: translateX(-50%);
    width: 72%;
    height: 46%;
    z-index: 10;
    pointer-events: none;
    background: repeating-linear-gradient(0deg,
            transparent 0px,
            transparent 2px,
            rgba(0, 0, 0, 0.12) 2px,
            rgba(0, 0, 0, 0.12) 4px);
}

/* Bouton spin au-dessus du cadre pour rester cliquable */
.slots-machine .spin-btn {
    position: absolute;
    bottom: 9.5%;
    left: 50%;
    transform: translateX(-50%);
    z-index: 20;
}

.rocket-casino-ui-under-machine {
    margin-top: 10px;
}

.spin-btn {
    position: relative;
    width: 254px;
    height: 114px;
    border: none;
    padding: 0;
    margin-top: 8px;
    background: url("img/spin-btn.png") center center no-repeat;
    background-size: contain;
    cursor: pointer;
    outline: none;
}

.spin-btn.spin-pressed-btn,
.spin-btn:active {
    background-image: url("img/spin-pressed-btn.png");
    transform: translateY(1px);
}

.slots-machine .spin-btn.spin-pressed-btn,
.slots-machine .spin-btn:active {
    transform: translateX(-50%) translateY(1px);
}

.spin-btn:disabled {
    filter: grayscale(0.3) brightness(0.7);
    cursor: default;
}

.rocket-casino-modal-content.rocket-casino-modal-shake {
    animation: rocketCasinoModalShake 420ms ease-in-out;
}

.rocket-casino-modal-content.rocket-casino-jackpot-flash::before,
.rocket-casino-modal-content.rocket-casino-bigwin-flash::before {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: 14px;
    pointer-events: none;
}

.rocket-casino-modal-content.rocket-casino-jackpot-flash::before {
    animation: rocketCasinoJackpotFlash 700ms ease-out;
}

.rocket-casino-modal-content.rocket-casino-bigwin-flash::before {
    animation: rocketCasinoBigWinFlash 500ms ease-out;
}

@keyframes rocketCasinoModalShake {
    0% {
        transform: translateX(0);
    }

    20% {
        transform: translateX(-5px);
    }

    40% {
        transform: translateX(6px);
    }

    60% {
        transform: translateX(-4px);
    }

    80% {
        transform: translateX(3px);
    }

    100% {
        transform: translateX(0);
    }
}

@keyframes rocketCasinoJackpotFlash {
    0% {
        background: rgba(250, 204, 21, 0.0);
        box-shadow: 0 0 0 rgba(250, 204, 21, 0);
    }

    30% {
        background: rgba(250, 204, 21, 0.22);
        box-shadow: 0 0 22px rgba(250, 204, 21, 0.65);
    }

    100% {
        background: rgba(250, 204, 21, 0);
        box-shadow: 0 0 0 rgba(250, 204, 21, 0);
    }
}

@keyframes rocketCasinoBigWinFlash {
    0% {
        background: rgba(34, 197, 94, 0.0);
        box-shadow: 0 0 0 rgba(34, 197, 94, 0);
    }

    35% {
        background: rgba(34, 197, 94, 0.16);
        box-shadow: 0 0 16px rgba(34, 197, 94, 0.45);
    }

    100% {
        background: rgba(34, 197, 94, 0);
        box-shadow: 0 0 0 rgba(34, 197, 94, 0);
    }
}

.rocket-casino-stake-row {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 6px;
    margin-bottom: 8px;
}

.rocket-casino-stake-input-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    gap: 8px;
}

.rocket-casino-stake-input-row input {
    min-width: 0;
    width: 100%;
    padding: 8px;
}

.rocket-casino-result {
    margin-top: 8px;
    font-size: 12px;
    color: #cbd5e1;
    min-height: 18px;
}

.rocket-casino-table {
    font-size: 12px;
    color: #cbd5e1;
}

.rocket-casino-table-head,
.rocket-casino-table-row {
    display: grid;
    grid-template-columns: minmax(0, 1fr) auto;
    gap: 8px;
    padding: 5px 0;
    border-bottom: 1px solid #1f2937;
}

.rocket-casino-table-head {
    font-weight: 700;
    color: #e2e8f0;
}

.rocket-casino-history {
    max-height: 420px;
    overflow: auto;
    border: 1px solid #1f2937;
    border-radius: 8px;
    padding: 6px;
}

.rocket-casino-history-row {
    display: grid;
    grid-template-columns: 1fr auto auto;
    gap: 8px;
    align-items: center;
    padding: 4px 2px;
    border-bottom: 1px solid #1f2937;
    font-size: 13px;
}

.rocket-casino-history-row:last-child {
    border-bottom: 0;
}

.rocket-casino-history-reels {
    display: flex;
    gap: 4px;
    align-items: center;
}

.rocket-casino-history-gains {
    font-size: 14px;
}

.rocket-casino-history-rewards {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    align-items: center;
    font-size: 11px;
    color: #cbd5e1;
}

.rocket-casino-history-reward {
    display: inline-flex;
    align-items: center;
    gap: 2px;
}

.rocket-casino-reward-sprite {
    width: 24px;
    height: 24px;
    object-fit: contain;
    vertical-align: middle;
}

.rocket-casino-gain-pokedollar {
    vertical-align: middle;
    margin-left: 2px;
}

.rocket-casino-table-symbol {
    display: flex;
    align-items: center;
    gap: 6px;
}

@keyframes rocketLineWinPulse {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(1.04);
    }

    100% {
        transform: scale(1);
    }
}

@media (max-width: 900px) {
    .rocket-casino-modal-grid {
        grid-template-columns: 1fr;
    }
}

@keyframes rocketRiskShake {
    0% {
        transform: translateX(0);
    }

    20% {
        transform: translateX(-1px);
    }

    40% {
        transform: translateX(2px);
    }

    60% {
        transform: translateX(-2px);
    }

    80% {
        transform: translateX(1px);
    }

    100% {
        transform: translateX(0);
    }
}

@media (max-width: 640px) {
    #teamrocketTab .tr-input-row {
        grid-template-columns: 1fr;
    }
}

.upgrade-card:hover,
.shop-item:hover,
.item-card:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    border-color: #cbd5e1;
}

/* Titres et Textes dans les cartes */
.upgrade-title,
.shop-item-name {
    font-size: 13px;
    font-weight: 800;
    color: #fff !important;
    font-family: 'Outfit', sans-serif;
}

.upgrade-desc,
.shop-item-desc {
    font-size: 11px;
    color: #ccc !important;
    line-height: 1.4;
    flex-grow: 1;
    /* Pousse le bouton vers le bas */
}

/* Prix et Boutons */
.upgrade-cost,
.shop-item-cost {
    font-size: 12px;
    font-weight: bold;
    color: #d97706;
    /* Orange/Or */
    margin-bottom: 8px;
}

.upgrade-btn,
.shop-buy-btn {
    width: 100%;
    padding: 8px;
    font-size: 11px;
    border-radius: 6px;
    font-weight: bold;
    text-transform: uppercase;
    letter-spacing: 0.5px;
}


/* Classe pour les images d'objets */
.item-sprite-img {
    width: 28px;
    height: 28px;
    image-rendering: pixelated;
    /* Garde le look rétro net */
    filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.2));
    vertical-align: middle;
}

/* Ajustement pour l'inventaire */
.inventory-slot .item-icon img {
    width: 40px;
    /* Un peu plus grand dans l'inventaire */
    height: 40px;
}


/* ✅ STYLES POUR LE SÉLECTEUR DE ZONE */
/* ✅ SÉLECTEUR DE ZONE (Une seule ligne forcée) */
.zone-selector {
    display: flex;
    flex-direction: row;
    flex-wrap: nowrap;
    align-items: center;
    gap: 15px;
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
    border-radius: 8px !important;
    padding: 12px 20px;
    margin-bottom: 20px;
    box-shadow: 0 4px 0 #3b3b3b;
    white-space: nowrap;
}

.zone-selector label {
    font-weight: 800;
    color: #3b3b3b;
    font-size: 12px;
    text-transform: uppercase;
    flex-shrink: 0;
    font-family: 'Outfit', sans-serif;
}

.zone-selector select {
    padding: 6px 12px;
    border: 2px solid #3b3b3b;
    border-radius: 6px;
    font-weight: 700;
    color: white;
    background-color: #3b3b3b;
    cursor: pointer;
    flex-grow: 1;
    font-family: 'Outfit', sans-serif;
}


.zone-info {
    margin: 0;
    font-size: 13px;
    color: #64748b;
    font-weight: 500;

    /* Style de séparation */
    border-left: 2px solid #e2e8f0;
    padding-left: 15px;
    flex-shrink: 0;
    /* Empêche les infos d'être écrasées */
}

.zone-progress-bar {
    width: 100%;
    height: 12px;
    background: rgba(0, 0, 0, 0.3);
    border-radius: 6px;
    margin-top: 8px;
    overflow: hidden;
    border: 1px solid rgba(0, 0, 0, 0.2);
}

.zone-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #ffd700, #f59e0b);
    transition: width 0.5s ease;
}

.zone-progress-text {
    font-size: 12px;
    font-weight: bold;
    margin-top: 4px;
}

/* ✅ FIN DES STYLES DE ZONE */

/* ✅ AJOUTER CE CSS POUR LE "JUICE" DE COMBAT */
@keyframes attack-lunge {
    0% {
        transform: translateX(0);
    }

    50% {
        transform: translateX(20px);
    }

    100% {
        transform: translateX(0);
    }
}

/* Le sprite du joueur (à gauche) "fonce" vers la droite */
#playerSprite.attack-lunge {
    animation: attack-lunge 0.3s ease-out;
}

/* L'ennemi (à droite) "fonce" vers la gauche */
#enemySprite.attack-lunge {
    /* On utilise 'reverse' pour qu'il aille dans l'autre sens */
    animation: attack-lunge 0.3s ease-out reverse;
}

@keyframes take-hit {

    0%,
    100% {
        opacity: 1;
    }

    50% {
        opacity: 0.3;
    }
}

.battle-sprite.take-hit {
    animation: take-hit 0.2s ease-in-out;
}

/* ✅ AJOUTER CE STYLE */
.tab-btn,
#toggleIcon {
    position: relative;
    /* Nécessaire pour positionner le badge */
}

.notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    width: 12px;
    height: 12px;
    background-color: #ef4444;
    border-radius: 50%;
    border: 1px solid white;
    animation: pulse-reward 1.5s infinite;
}

/* Style pour le modal des tiers de zone */
#zoneTierModalGrid .creature-card {
    padding: 10px;
    text-align: center;
    background: rgba(0, 0, 0, 0.05);
    border: 1px solid #ddd;
    border-radius: 10px;
}

/* On réduit la taille des sprites pour ce modal */
#zoneTierModalGrid .team-slot-sprite {
    width: 64px;
    height: 64px;
    margin-bottom: 5px;
}

#zoneTierModalGrid .team-slot-name {
    font-size: 12px;
    font-weight: bold;
    color: #333;
}

/* 1. La Grille : On serre les colonnes (85px de large au minimum) */
#storageList {
    grid-template-columns: repeat(auto-fill, minmax(85px, 1fr)) !important;
    gap: 6px !important;
}

/* 2. La Carte : On réduit les marges internes */
#storageList .creature-card {
    padding: 4px !important;
    min-height: 80px !important;
    /* Hauteur réduite */
}

/* 3. L'Image (Sprite) : On passe de 48px à 32px */
#storageList .team-slot-sprite {
    width: 36px !important;
    height: 36px !important;
    margin-bottom: 2px !important;
}

/* 4. Les Textes : On réduit la police pour que ça rentre */
#storageList .team-slot-name {
    font-size: 10px !important;
    margin-bottom: 1px !important;
    width: 100%;
    /* Assure que l'ellipse fonctionne */
}

#storageList .team-slot-level {
    font-size: 9px !important;
    margin-bottom: 2px !important;
}

#storageList .team-slot-info {
    font-size: 9px !important;
    letter-spacing: -0.5px;
    /* Resserre un peu les caractères */
}

/* Cacher la barre d'XP dans le stockage pour gagner de la place (Optionnel) */
#storageList .exp-bar {
    height: 4px !important;
    margin-top: 2px !important;
}

/* --- AJUSTEMENT SPÉCIFIQUE PENSION --- */

/* Force les sprites de la pension à 48px */
#pensionList .team-slot-sprite {
    width: 48px !important;
    height: 48px !important;
    margin-bottom: 3px !important;
}

/* Optionnel : Ajuste la grille de la pension pour qu'elle soit adaptée à cette taille */
/* (Un peu plus large que le stockage compact pour aérer) */
#pensionList {
    grid-template-columns: repeat(auto-fill, minmax(95px, 1fr)) !important;
}

/* La nouvelle barre de progression pour les tiers */
.tier-progress-bar {
    width: 100%;
    height: 8px;
    background: #ddd;
    border-radius: 4px;
    overflow: hidden;
    margin-top: 5px;
}

.tier-progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #22c55e, #16a34a);
    transition: width 0.3s ease;
}

.zone-objective {
    background: rgba(0, 0, 0, 0.1);
    padding: 8px 12px;
    border-radius: 8px;
    margin-bottom: 5px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
}

.zone-objective-label {
    font-weight: bold;
    color: #333;
}

.zone-objective-progress {
    font-weight: bold;
    color: #16a34a;
}

.zone-objective-progress.incomplete {
    color: #ef4444;
}

.zone-details-btn {
    font-size: 11px;
    padding: 3px 8px;
    background: #667eea;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
}

.zone-details-btn:hover {
    background: #5a67d8;
}

/* Bouton Synergies : uniquement le sprite, sans texte ni cadre */
.synergy-btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    margin: 0;
    border: none;
    background: transparent;
    cursor: pointer;
    transition: transform 0.2s ease, opacity 0.2s ease;
}

.synergy-btn:hover {
    transform: scale(1.1);
    opacity: 0.9;
}

.synergy-btn:active {
    transform: scale(0.95);
}

.synergy-btn-sprite {
    display: block;
    width: 60px;
    height: 32px;
    object-fit: contain;
}

/* ======================================== */
/* == CSS POUR FEEDBACK DE COMBAT (AJOUTÉ) == */
/* ======================================== */


/* --- SCÈNE DE COMBAT (Unifié) --- */

/* Le conteneur global : cadre fort + profondeur + lueur pour le mettre en avant */
.battle-display {
    height: 360px;
    /* Nouveau fond : décor pixel-art complet */
    background:
        linear-gradient(to top, rgba(0, 0, 0, 0.25), transparent 40%),
        url('img/background.png') center bottom / cover no-repeat !important;
    margin-bottom: 24px;
    padding: 0 40px;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    border-radius: 14px;
    position: relative;
    overflow: hidden;

    /* Cadre "écran" : bordure épaisse + effet encadré */
    border: 5px solid #2d2d28;
    box-shadow:
        inset 0 0 0 4px #4a4a42,
        inset 0 4px 30px rgba(0, 0, 0, 0.25),
        /* Assombrit légèrement le bas de la forêt pour une transition plus douce avec les HUDs */
        inset 0 -5px 10px rgba(0, 0, 0, 0.3),
        inset 0 -2px 20px rgba(0, 0, 0, 0.15),
        0 0 0 2px #1a1a17,
        0 8px 0 #1f1f1a,
        0 0 40px rgba(120, 200, 80, 0.2),
        0 0 80px rgba(251, 191, 36, 0.08);
}

/* Variante Tour de combat : fond spécifique */
.combat-area:has(.zone-selector.tower-mode) .battle-display {
    background:
        linear-gradient(to top, rgba(0, 0, 0, 0.35), transparent 40%),
        url('img/background-tower.png') center bottom / cover no-repeat !important;
}

/* Variante Arène : fond spécifique (classe ajoutée par updateCombatDisplayUI quand arenaState.active) */
.battle-display.arena-background {
    background:
        linear-gradient(to top, rgba(0, 0, 0, 0.25), transparent 40%),
        url('img/background-arena.png') center / cover no-repeat !important;
}

.creature-display {
    position: relative;
    text-align: center;
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: flex-end;
    padding-bottom: 20px;
    /* Espace pour que le bas du sprite soit sur la plateforme */
}

/* Position spécifique : léger décalage pour renforcer la profondeur */
#enemySpriteContainer {
    transform: translateY(-19px);
    /* 3px plus haut qu'avant */
}

#playerSpriteContainer {
    transform: translateY(18px);
    /* 6px plus bas pour l'ancrer davantage */
}

/* L'image du Pokémon */
.battle-sprite {
    width: 144px;
    height: 144px;
    image-rendering: pixelated;
    position: relative;
    z-index: 2;
    filter: drop-shadow(0px 4px 2px rgba(0, 0, 0, 0.4));
    animation: sprite-float 2s ease-in-out infinite;
    transition: transform 0.1s;
}

/* === AJUSTEMENTS POSITION SPRITES === */
#playerSprite,
#enemySprite {
    position: relative;
    top: -35px;
    /* Ajustement hauteur */
    z-index: 5;
}

#enemySprite {
    left: -40px;
    /* Décalage gauche */
}


/* OPTIMISATION : Style de base plus lisible et centré */
/* OPTIMISATION : Style "Clean RPG" (Lisible et Fluide) */
.floating-text {
    position: absolute;
    left: 50%;
    /* Centré horizontalement, pas de scale */
    transform: translateX(-50%);

    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 24px;
    /* Taille augment�e pour meilleure visibilit� */
    font-weight: 700;
    pointer-events: none;

    /* Ombre portée simple pour le contraste */

    z-index: 100;
    will-change: transform, opacity;

    /* Animation fluide vers le haut */
    animation: float-fade 1s ease-out forwards;
}

/* NOUVELLE ANIMATION : Montée simple et fondu */
@keyframes float-fade {
    0% {
        opacity: 1;
        transform: translate(-50%, 0);
    }

    20% {
        opacity: 1;
        /* Reste visible un moment */
        transform: translate(-50%, -15px);
    }

    100% {
        opacity: 0;
        transform: translate(-50%, -60px);
        /* Finit plus haut */
    }
}

/* Couleurs (Plus douces) */
.ft-damage-enemy {
    color: #ff8a80;
}

.ft-damage-player {
    color: #ff8a80;
    font-size: 1.2em;
}

/* Rouge clair (fallback) */
.ft-damage-physical {
    color: #ea580c;
    font-size: 1.2em;
}

/* Orange — dégâts physiques */
.ft-damage-special {
    color: #7c3aed;
    font-size: 1.2em;
}

/* Violet — dégâts spéciaux */
.ft-heal {
    color: #69f0ae;
    font-size: 1.2em;
}

/* Vert menthe */
.ft-status {
    color: #e040fb;
    font-size: 1.2em;
}

/* Violet */

/* Critique : Juste un peu plus gros, pas de rotation folle */
.ft-crit {
    font-size: 24px;
    color: #ffca28;
    /* Or */
    z-index: 101;
}

/* --- CSS pour le Recycleur --- */
.recycler-container {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    /* On s'assure qu'il utilise bien la hauteur de l'onglet */
    height: 100%;
    max-height: 330px;
    /* Hauteur max avant scroll */
}

.recycler-list,
.recycler-shop {
    padding: 15px;
    background: rgba(0, 0, 0, 0.05);
    border-radius: 8px;
    overflow-y: auto;
}

.recycler-header {
    font-size: 16px;
    font-weight: bold;
    margin-bottom: 10px;
    padding-bottom: 10px;
    border-bottom: 2px solid #ddd;
}

.recycler-header .essence-count {
    font-size: 20px;
    color: #a855f7;
}

.recycler-item,
.dust-shop-item {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background: #bec3c6 !important;
    border: 2px solid #3b3b3b !important;
    border-radius: 6px;
    margin-bottom: 8px;
    box-shadow: 0 4px 0 #3b3b3b;
    color: #3b3b3b !important;
    font-weight: 800;
}

.recycler-item-name {
    font-weight: bold;
    font-size: 13px;
}

.recycler-item-name .rarity-label {
    font-size: 9px;
    padding: 2px 5px;
    margin-left: 5px;
}

.recycler-btn {
    padding: 5px 10px;
    font-size: 11px;
    background: #a855f7;
    color: white;
    border: none;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
}

.recycler-btn:hover {
    background: #9333ea;
}

.dust-shop-item .shop-buy-btn {
    background: #a855f7;
    padding: 8px 12px;
    font-size: 12px;
}

.dust-shop-item .shop-buy-btn:hover {
    background: #9333ea;
}

/* --- NOUVEAU : Animation pour Prestige Prêt --- */
@keyframes prestige-glow {
    from {
        /* Une lueur dorée/jaune pour correspondre à l'étoile de prestige */
        box-shadow: 0 0 5px rgba(128, 208, 208, 0.2);
        border-color: #c1e3e3;
    }

    to {
        box-shadow: 0 0 30px rgba(128, 208, 208, 1.2),
            inset 0 0 15px rgba(255, 255, 255, 1);
        border-color: #8ec2c2;
    }
}

.creature-card.prestige-ready {
    border: 3px solid #80d0d0;
    /* Applique l'animation en boucle */
    animation: prestige-glow 1s ease-in-out infinite alternate;
}

/* Nouveau style pour le conteneur de synergies dans l'en-tête */
.synergy-container-header {
    display: flex;
    gap: 8px;
    /* On enlève le fond gris et les bordures de l'ancien style */
    background: transparent;
    padding: 0;
    border: none;
}

/* Modification des badges pour qu'ils soient cliquables */
.synergy-badge {
    cursor: pointer;
    /* Curseur main */
    transition: transform 0.2s, box-shadow 0.2s;
    user-select: none;
    /* Empêche la sélection de texte */
}

.synergy-badge:hover {
    transform: scale(1.05);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
    background-color: #f0f9ff;
    /* Légère teinte au survol */
}

.synergy-badge:active {
    transform: scale(0.95);
}

/* --- Styles pour le Slot d'Objet --- */
.held-item-slot {
    margin-top: 15px;
    padding: 10px;
    background: #bec3c6 !important;
    border: 3px dashed #3b3b3b !important;
    border-radius: 8px;
    text-align: center;
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, transform 0.2s, opacity 0.2s, box-shadow 0.2s, filter 0.2s;
    color: #3b3b3b !important;
    font-weight: 800;
}

.held-item-slot:hover {
    background: #a8adb0 !important;
    border-color: #1a1a1a !important;
}

.held-item-slot.equipped {
    border: 3px solid #3b3b3b !important;
    background: #bec3c6 !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.2) !important;
}

.item-select-list {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
    gap: 10px;
    margin-top: 10px;
}

.item-select-card {
    padding: 8px;
    background: #5d4a3e !important;
    border: 2px solid #3b3b3b !important;
    border-radius: 6px;
    text-align: center;
    cursor: pointer;
    font-size: 11px;
    color: white !important;
    font-weight: 800;
}

.item-select-card:hover {
    background: #7a614e !important;
    transform: translateY(-1px);
}

/* Grille pour la liste des synergies */
.synergy-list-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
    gap: 10px;
    max-height: 60vh;
    overflow-y: auto;
    padding-right: 6px;
}

/* Carte individuelle de synergie (compacte) */
.synergy-list-card {
    background: linear-gradient(180deg, #f8fafc 0%, #f1f5f9 100%);
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    padding: 0;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: background-color 0.25s ease, color 0.25s ease, border-color 0.25s ease, transform 0.25s ease, opacity 0.25s ease, box-shadow 0.25s ease, filter 0.25s ease;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
}

.synergy-list-card:hover {
    border-color: #cbd5e1;
    box-shadow: 0 3px 10px rgba(0, 0, 0, 0.08);
}

/* Bandeau des icônes de types en tête de carte */
.synergy-list-types {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    padding: 6px 8px;
    background: rgba(0, 0, 0, 0.04);
    border-bottom: 1px solid #e2e8f0;
    min-height: 32px;
}

.synergy-type-badge {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    border-radius: 6px;
    background: rgba(255, 255, 255, 0.8);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.08);
}

.synergy-type-badge .type-icon-img {
    width: 16px !important;
    height: 16px !important;
}

.synergy-list-card.active .synergy-list-types {
    background: linear-gradient(135deg, rgba(34, 197, 94, 0.12) 0%, rgba(22, 163, 74, 0.08) 100%);
    border-bottom-color: rgba(34, 197, 94, 0.25);
}

.synergy-list-info {
    flex: 1;
    padding: 8px 10px;
    display: flex;
    flex-direction: column;
    gap: 3px;
}

.synergy-list-title {
    font-weight: 700;
    font-size: 12px;
    color: #334155;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 6px;
}

.synergy-list-active-badge {
    font-size: 9px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.3px;
    color: #16a34a;
    background: rgba(34, 197, 94, 0.15);
    padding: 2px 5px;
    border-radius: 4px;
}

.synergy-list-desc {
    font-size: 10px;
    color: #64748b;
    line-height: 1.35;
}

.synergy-progress {
    font-size: 10px;
    font-weight: 600;
    color: #64748b;
    display: flex;
    flex-wrap: wrap;
    align-items: center;
    gap: 3px 6px;
}

.synergy-progress .type-icon-img {
    width: 12px !important;
    height: 12px !important;
    vertical-align: middle !important;
}

.synergy-list-card.active .synergy-progress {
    color: #15803d;
}

.synergy-progress-bar {
    width: 100%;
    height: 4px;
    background: #e2e8f0;
    border-radius: 2px;
    margin-top: 2px;
    overflow: hidden;
}

.synergy-progress-fill {
    height: 100%;
    background: #94a3b8;
    border-radius: 2px;
    transition: width 0.3s ease;
}

.synergy-list-card.active .synergy-progress-fill {
    background: linear-gradient(90deg, #22c55e, #16a34a);
}

/* Style quand la synergie est active */
.synergy-list-card.active {
    border-color: rgba(34, 197, 94, 0.4);
    background: linear-gradient(180deg, #f0fdf4 0%, #ecfdf5 100%);
    box-shadow: 0 4px 14px rgba(34, 197, 94, 0.15);
}

.synergy-list-card.active:hover {
    box-shadow: 0 6px 18px rgba(34, 197, 94, 0.2);
}

/* Styles pour le choix du Starter */
.starter-card {
    background: white;
    border-radius: 15px;
    padding: 20px;
    cursor: pointer;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
    position: relative;
    overflow: hidden;
    box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
    border: 3px solid transparent;
}

.starter-card:hover {
    transform: translateY(-10px) scale(1.05);
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
}

.starter-card:hover h2 {
    transform: scale(1.1);
}

.starter-bg {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100px;
    opacity: 0.2;
    z-index: 0;
}

.starter-bg.grass {
    background: #4caf50;
}

.starter-bg.fire {
    background: #f44336;
}

.starter-bg.water {
    background: #2196f3;
}

.starter-sprite {
    width: 144px;
    height: 144px;
    image-rendering: pixelated;
    position: relative;
    z-index: 1;
    filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.2));
    transition: transform 0.3s;
}

.starter-card:hover .starter-sprite {
    transform: scale(1.2);
    animation: sprite-float 1s infinite ease-in-out;
}

.starter-card {
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-bottom: 5px solid #111 !important;
    border-radius: 12px !important;
    padding: 20px !important;
    color: white !important;
    transition: transform 0.2s !important;
    cursor: pointer !important;
    box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2) !important;
}

.starter-card:hover {
    transform: translateY(-5px) !important;
    background: #444 !important;
}

.starter-card h2 {
    color: #fff !important;
    font-weight: 800 !important;
    margin-top: 10px !important;
}

.starter-card p {
    color: #ccc !important;
    font-size: 12px !important;
}

/* Styles pour les Buffs de Tour — contraste fort (lisible) */
.tower-buffs-container {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: 10px;
    padding: 6px 8px;
    background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.12);
    animation: slideIn 0.3s ease;
    color: #f8fafc;
    max-width: 100%;
}

.tower-buffs-title {
    flex: 0 0 auto;
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.05em;
    color: #e2e8f0 !important;
    margin-right: 6px;
}

.tower-buffs-empty {
    font-size: 11px;
    color: rgba(248, 250, 252, 0.7) !important;
    font-style: italic;
}

.tower-buff-chip {
    font-size: 10px;
    padding: 3px 8px;
    border-radius: 999px;
    font-weight: bold;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    display: flex;
    align-items: center;
    gap: 5px;
    white-space: nowrap;
    flex: 0 1 auto;
    min-width: 0;
}

.tower-buff-chip span {
    overflow: hidden;
    text-overflow: ellipsis;
}

.buff-atk {
    background: #ffebee;
    color: #c62828;
    border: 1px solid #ffcdd2;
}

.buff-speed {
    background: #e0f2f1;
    color: #00695c;
    border: 1px solid #b2dfdb;
}

.buff-def {
    background: #e3f2fd;
    color: #1565c0;
    border: 1px solid #bbdefb;
}

.buff-crit {
    background: #fff8e1;
    color: #f57f17;
    border: 1px solid #ffecb3;
}

.buff-life {
    background: #f3e5f5;
    color: #7b1fa2;
    border: 1px solid #e1bee7;
}

.buff-special {
    background: #e8f5e9;
    color: #2e7d32;
    border: 1px solid #c8e6c9;
}

/* Rareté des Reliques */
.relic-card {
    padding: 12px;
    border-radius: 8px;
    background: #3b3b3b !important;
    text-align: center;
    cursor: pointer;
    position: relative;
    border: 2px solid #1a1a1a !important;
    border-bottom: 4px solid #111 !important;
    color: white !important;
    transition: transform 0.1s !important;
    font-size: 12px;
    width: 140px;
    box-sizing: border-box;
}

.relic-card:hover {
    transform: translateY(-3px) !important;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
    border-color: #cbd5e1 !important;
}

.relic-common {
    border-left: 4px solid #9ca3af !important;
}

.relic-rare {
    border-left: 4px solid #3b82f6 !important;
}

.relic-epic {
    border-left: 4px solid #a855f7 !important;
}

.relic-legendary {
    border-left: 4px solid #f59e0b !important;
    box-shadow: inset 0 0 10px rgba(245, 158, 11, 0.1);
}

.relic-badge {
    position: absolute;
    top: -10px;
    right: -10px;
    padding: 3px 8px;
    border-radius: 10px;
    color: white;
    font-size: 10px;
    font-weight: bold;
    text-transform: uppercase;
}

.badge-common {
    background: #95a5a6;
}

.badge-rare {
    background: #3498db;
}

.badge-epic {
    background: #9b59b6;
}

.badge-legendary {
    background: #f39c12;
}

/* --- STYLE DU MODE TOUR (AMÉLIORÉ) --- */

/* --- STYLE DU MODE TOUR (SOBRE & ÉPURÉ) --- */

/* --- MENU PRINCIPAL (SAVE MANAGER) --- */
.menu-btn {
    background: #3b3b3b !important;
    color: #fff !important;
    border: 2px solid #1a1a1a !important;
    border-bottom: 4px solid #111 !important;
    border-radius: 8px !important;
    padding: 12px 5px !important;
    font-size: 12px;
    font-weight: bold;
    font-family: 'Outfit', sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    transition: transform 0.1s, box-shadow 0.1s;
}

.menu-btn:hover {
    transform: translateY(-2px);
    border-color: #cbd5e1 !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

.menu-section-dark {
    text-align: left;
    background: #3b3b3b !important;
    padding: 15px;
    border-radius: 8px;
    border: 2px solid #1a1a1a !important;
    margin-bottom: 20px;
    color: white;
}

.menu-section-dark span {
    color: #fff !important;
}

.menu-danger-zone {
    background: #451a1a !important;
    border: 2px solid #7f1d1d !important;
    border-radius: 8px;
    padding: 12px;
}

/* --- BOUTON DE SAUVEGARDE (JUICY) --- */
.btn-save {
    transition: background-color 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), color 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), border-color 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), opacity 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), box-shadow 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
    cursor: pointer;
    font-weight: bold;
    color: #fff;
    text-transform: uppercase;
    letter-spacing: 1px;
}

.btn-save:hover {
    filter: brightness(1.15);
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.4) !important;
}

.btn-save:active {
    filter: brightness(0.9);
    transform: translateY(2px) scale(0.98);
    box-shadow: 0 1px 2px rgba(0, 0, 0, 0.5) !important;
}

.btn-save-success {
    background: #10b981 !important;
    /* Vert vif type émeraude */
    border-color: #059669 !important;
    box-shadow: 0 0 15px rgba(16, 185, 129, 0.6) !important;
    transform: scale(1.05);
    color: white !important;
}

.zone-selector.tower-mode {
    /* Fond : Un gris-bleu nuit profond et mat (Style "Slate") */
    background: #1e293b !important;

    /* Bordure : Très fine et subtile, juste pour définir la forme */
    border: 1px solid rgba(255, 255, 255, 0.1) !important;
    border-radius: 10px !important;

    /* Ombre : Douce et diffuse pour détacher l'élément du fond */
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
        0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;

    /* Mise en page */
    display: flex !important;
    justify-content: center;
    align-items: center;
    padding: 8px 12px !important;
    min-height: 38px;

    /* Pas d'animation qui clignote */
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* On cache proprement les éléments inutiles */
.zone-selector.tower-mode label,
.zone-selector.tower-mode select,
.zone-selector.tower-mode .zone-progress-bar {
    display: none !important;
}

/* Le Texte : Propre, lisible, moderne */
.zone-selector.tower-mode .zone-info {
    color: #f8fafc !important;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif !important;
    font-size: 16px !important;
    font-weight: 600 !important;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    margin: 0 !important;
}

.squad-selected {
    border: 2px solid #22c55e !important;
    background-color: #dcfce7 !important;
    transform: scale(0.98);
}

.squad-counter {
    position: fixed;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    background: #333;
    color: white;
    padding: 10px 20px;
    border-radius: 30px;
    z-index: 10002;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    display: flex;
    gap: 10px;
    align-items: center;
}

/* --- STYLE DES ŒUFS --- */

.egg-sprite {
    width: 48px;
    height: 48px;
    image-rendering: pixelated;
    /* Garde le look rétro net */
    margin: 0 auto 5px auto;
    transform: translateX(-15px);
    display: block;
    transition: transform 0.3s ease;
    animation: egg-float 3s ease-in-out infinite;
}

/* Animation de flottement */
@keyframes egg-float {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-6px);
    }
}

.ball-item:hover .egg-sprite {
    transform: scale(1.2) rotate(5deg);
    animation: none;
    /* Pause l'animation au survol */
}

/* --- FILTRES DE COULEUR --- */

/* Common (Vert/Beige de base) : Pas de filtre */

/* Rare / Epic / Legendary : plus aucun filtre pour respecter exactement les couleurs des fichiers sources */
.egg-filter-rare,
.egg-filter-epic,
.egg-filter-legendary {
    filter: none;
}

/* --- STYLE DE LA CARTE (Rappel) --- */
.ball-item {
    background: transparent;
    padding: 15px;
    border-radius: 12px;
    text-align: center;
    box-shadow: none;
    border: none;
    transition: transform 0.2s, box-shadow 0.2s;
    position: relative;
    overflow: hidden;
}

.ball-item:hover {
    transform: translateY(-3px);
    box-shadow: none;
}

/* Bordures colorées selon la rareté (optionnel si vous voulez renforcer l'effet) */
.ball-item.rarity-common {
    border-bottom: none;
}

.ball-item.rarity-rare {
    border-bottom: none;
}

.ball-item.rarity-epic {
    border-bottom: none;
}

.ball-item.rarity-legendary {
    border-bottom: none;
}


.custom-tooltip {
    display: none;
    /* Caché par défaut */
    position: fixed;
    z-index: 10000;
    /* Au-dessus de tout */
    background: rgba(20, 20, 20, 0.95);
    border: 1px solid #667eea;
    color: white;
    padding: 10px 15px;
    border-radius: 8px;
    font-size: 12px;
    max-width: 250px;
    pointer-events: none;
    /* La souris passe au travers (très important) */
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    white-space: pre-line;
    /* Permet les sauts de ligne avec \n */
}

/* Titre en gras dans l'infobulle */
.tooltip-title {
    font-weight: bold;
    color: #ffd700;
    margin-bottom: 4px;
    font-size: 14px;
    display: block;
}

/* --- STYLE COMPACT POUR LE POKÉDEX --- */
#pokedexList {
    /* Des colonnes plus étroites pour en mettre plus par ligne */
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)) !important;
    gap: 8px !important;
}

#pokedexList .creature-card {
    padding: 8px !important;
    /* Moins de marge intérieure */
    min-height: auto !important;
    /* Hauteur flexible */
}

/* --- Bonus de collection (Pokédex) --- */
.collection-bonus-card {
    transition: box-shadow 0.2s ease;
}

.collection-bonus-card:hover {
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
}

.collection-bonus-grid img {
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
}

.collection-bonus-grid .creature-card {
    min-height: auto;
    padding: 6px !important;
}

/* Nouvelle classe pour les petites icônes (remplace les émojis) */
.icon-img {
    width: 16px;
    height: 16px;
    vertical-align: middle;
    object-fit: contain;
    display: inline-block;
    filter: drop-shadow(0 1px 1px rgba(0, 0, 0, 0.2));
}

/* Pour les types, on les veut un peu plus gros parfois */
.type-icon-img {
    width: 20px;
    height: 20px;
    vertical-align: bottom;
}

/* Ajustement pour le Header (Stats) */
.stat-chip .icon-img {
    width: 24px;
    height: 24px;
}

/* --- CONTENEUR DES TALENTS (Style "Clean UI") --- */
#activeTalentsDisplay {
    background: white;
    border: 1px solid #e2e8f0;
    border-radius: 10px;
    padding: 8px 10px;
    margin-bottom: 10px;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.03);
}

/* Le Titre (tout petit et discret) */
.talents-header-title {
    font-size: 10px;
    font-weight: 700;
    color: #94a3b8;
    /* Gris clair */
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    gap: 6px;
}

/* La Grille (Flex pour que les tags se suivent) */
.talent-summary-grid {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

/* --- LE BADGE (TAG) --- */
.talent-chip {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 10px;
    border-radius: 7px;
    font-size: 11px;
    font-weight: 500;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
    cursor: help;
    /* Curseur ? pour indiquer le tooltip */

    /* Style par défaut (Neutre) */
    background: #f8fafc;
    border: 1px solid #e2e8f0;
    color: #475569;
}

.talent-chip:hover {
    background: white;
    transform: translateY(-1px);
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
}

/* --- VARIANTES SELON RARETÉ (Subtiles) --- */
.talent-chip.epic {
    background: #f3e8ff;
    /* Violet très pâle */
    border-color: #d8b4fe;
    color: #7e22ce;
}

.talent-chip.legendary {
    background: #fef9c3;
    /* Jaune très pâle */
    border-color: #fde047;
    color: #b45309;
}

/* Le texte du bonus (+50% XP) */
.talent-bonus-text {
    font-size: 10px;
    opacity: 1;
    margin-left: 4px;
    padding-left: 4px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    /* Petite séparation */
}




/* Style des barres ATB */
.atb-bar-container {
    width: 100%;
    height: 8px;
    /* On augmente un peu la hauteur pour être sûr de la voir */
    background: #1e293b;
    margin-top: 4px;
    border-radius: 3px;
    overflow: visible !important;
    border: 1px solid #000;
    /* Petit bord pour bien délimiter */
    position: relative;
    /* Important */
    z-index: 1;
}

/* Barre ATB (Bleue) */
.atb-fill {
    height: 100%;
    width: 100%;
    background: linear-gradient(90deg, #3b82f6, #60a5fa);
    transform-origin: left;
    transform: scaleX(0);
    /* Commence vide */
    transition: transform 0.1s linear;
    will-change: transform;
    display: block;
    position: relative;
    z-index: 2;
    min-height: 8px;
}

/* --- BOUTON ULTIME : STYLE BOUTIQUE (UPGRADE) --- */
.ult-rect-btn {
    position: relative;
    width: 50px;
    /* Even smaller */
    height: 14px;
    /* Even smaller */
    /* Un peu plus haut, comme un petit bouton */

    /* Fond "Vide" : Clair, comme le fond des cartes d'amélioration (#e3f2fd en version orange) */
    background: linear-gradient(135deg, #fff8e1 0%, #ffecb3 100%);
    border: 1px solid #ffb300;
    /* Bordure nette */
    border-radius: 8px;
    /* Arrondi "Bouton" (comme la boutique) */

    padding: 0;
    overflow: hidden;
    cursor: not-allowed;
    z-index: 10;

    /* Ombre colorée douce */
    box-shadow: 0 2px 5px rgba(255, 179, 0, 0.2);
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

/* La barre de remplissage (Dégradé vif, comme les boutons d'achat) */
/* Barre Ultime (Orange) */
.ult-rect-fill {
    height: 100%;
    width: 100%;
    background: linear-gradient(135deg, #ffca28, #ff8f00);
    transform-origin: left;
    transform: scaleX(0);
    /* Commence vide */
    transition: transform 0.2s ease-out;
    box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
    will-change: transform;
}

/* Le texte */
.ult-rect-content {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;

    /* Texte foncé pour contraste sur fond clair/orange */
    color: #e65100;
    font-size: 5px;
    font-weight: 300;
    text-transform: uppercase;
    letter-spacing: 0.6px;
    z-index: 2;
    /* Pas d'ombre noire, pour un look "flat" propre */
}

/* --- ÉTAT PRÊT (READY) --- */
.ult-rect-btn.ready {
    cursor: pointer;
    border-color: #ff6f00;
    /* Lueur externe style "Carte rare" */
    box-shadow: 0 2px 6px rgba(255, 160, 0, 0.4);
    transform: translateY(0);
}

.ult-rect-btn.ready .ult-rect-fill {
    /* Devient doré brillant */
    background: linear-gradient(135deg, #ffd700, #ffb300);
}

.ult-rect-btn.ready .ult-rect-content {
    color: #fff;
    /* Texte blanc sur fond doré */
}

.ult-rect-btn.ready:hover {
    transform: translateY(-2px);
    /* Effet "Levée" au survol */
    box-shadow: 0 4px 8px rgba(255, 160, 0, 0.5);
}

/* --- ÉTAT ACTIF (ACTIVE) --- */
.ult-rect-btn.active {
    border-color: #ef4444;
}

.ult-rect-btn.active .ult-rect-fill {
    background: linear-gradient(135deg, #ff5252, #d32f2f);
    /* Rouge style "Reset" */
    width: 100% !important;
}

.ult-rect-btn.active .ult-rect-content {
    color: white;
}

/* FIX : Empêcher le HUD de sauter quand un statut apparaît */
.status-icons-container {
    /* 1. On réserve une hauteur fixe (taille d'un émoji + un peu de marge) */
    height: 28px;
    min-height: 28px;

    /* 2. On s'assure que ça ne déborde pas */
    overflow: hidden;

    /* 3. On centre proprement les icônes */
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;

    /* 4. Petits ajustements visuels */
    margin-top: 4px;
    font-size: 18px;
    /* Taille des émojis de statut */
}

/* --- UI MODE CAPTURE MANUEL --- */
.capture-layout {
    display: grid;
    grid-template-columns: 1fr 1.2fr;
    /* Gauche: Cible, Droite: Balles */
    gap: 20px;
}

.capture-target-card {
    background: #f8fafc;
    border-radius: 15px;
    padding: 15px;
    text-align: center;
    border: 2px solid #e2e8f0;
    box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.05);
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
}

.capture-sprite {
    width: 128px;
    height: 128px;
    image-rendering: pixelated;
    animation: float-capture 3s ease-in-out infinite;
    filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.2));
}

@keyframes float-capture {

    0%,
    100% {
        transform: translateY(0);
    }

    50% {
        transform: translateY(-10px);
    }
}

.capture-chance-bar {
    width: 100%;
    height: 6px;
    background: #e2e8f0;
    border-radius: 3px;
    margin-top: 5px;
    overflow: hidden;
}

.capture-chance-fill {
    height: 100%;
    transition: width 0.3s ease;
}

.balls-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
}

.ball-select-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 12px;
    border-radius: 12px;
    border: 2px solid transparent;
    background: white;
    cursor: pointer;
    transition: background-color 0.2s, color 0.2s, border-color 0.2s, transform 0.2s, opacity 0.2s, box-shadow 0.2s, filter 0.2s;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
    position: relative;
    overflow: hidden;
}

.ball-select-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    border-color: #cbd5e1;
}

.ball-select-btn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
    filter: grayscale(1);
}

.ball-icon-large {
    font-size: 28px;
    margin-bottom: 5px;
}

.ball-count-badge {
    position: absolute;
    top: 5px;
    right: 5px;
    background: #1e293b;
    color: white;
    font-size: 10px;
    padding: 2px 6px;
    border-radius: 10px;
    font-weight: bold;
}

/* =========================================
   MODAL DE CAPTURE — Même palette que l’éclosion (marron moka)
   Fond sombre boisée, halo doré, balls avec hover prononcé, Fuir discret
   ========================================= */

#captureModal.show {
    background: radial-gradient(ellipse 80% 70% at 50% 45%,
            rgba(255, 248, 240, 0.15) 0%,
            rgba(72, 62, 52, 0.5) 50%,
            rgba(58, 50, 42, 0.92) 100%) !important;
    backdrop-filter: blur(4px);
}

#captureModal .quest-completion-content {
    background: linear-gradient(165deg, #5c5042 0%, #4a4035 45%, #3d352b 100%) !important;
    border: 4px solid var(--bg-tertiary, #5d4a3e) !important;
    border-radius: 12px !important;
    color: #f1f5f9 !important;
    box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.2)), 0 6px 0 var(--bg-tertiary, #5d4a3e), 0 8px 24px rgba(0, 0, 0, 0.25) !important;
    max-width: 560px !important;
    overflow: hidden;
}

/* Creature-select (expéditions) : même cadre que .stats-content / .modal-content */
#creatureSelectModal .creature-select-content {
    border: 4px solid var(--bg-tertiary, #5d4a3e) !important;
    border-radius: 12px !important;
    box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.2)), 0 6px 0 var(--bg-tertiary, #5d4a3e), 0 8px 24px rgba(0, 0, 0, 0.25) !important;
}

#captureModal .quest-completion-title {
    color: #fef3c7 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    font-weight: 800;
}

/* =========================================
   MODAL FIN DE TOUR (towerCompletionModal)
   Même design que le captureModal
   ========================================= */

#towerCompletionModal.show {
    background: radial-gradient(ellipse 80% 70% at 50% 45%,
            rgba(255, 248, 240, 0.15) 0%,
            rgba(72, 62, 52, 0.5) 50%,
            rgba(58, 50, 42, 0.92) 100%) !important;
    backdrop-filter: blur(4px);
}

#towerCompletionModal .quest-completion-content {
    background: linear-gradient(165deg, #5c5042 0%, #4a4035 45%, #3d352b 100%) !important;
    border: 4px solid var(--bg-tertiary, #5d4a3e) !important;
    border-radius: 12px !important;
    color: #f1f5f9 !important;
    box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.2)), 0 6px 0 var(--bg-tertiary, #5d4a3e), 0 8px 24px rgba(0, 0, 0, 0.25) !important;
    max-width: 520px !important;
}

#towerCompletionModal .quest-completion-title {
    color: #fef3c7 !important;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
    font-weight: 800;
}

#towerCompletionModal #towerCompletionInfo {
    margin: 20px 0;
    font-size: 16px;
}

#towerCompletionModal #towerCompletionInfo h2 {
    color: #fef3c7;
    margin-bottom: 8px;
}

#towerCompletionModal #towerCompletionRewards {
    margin-top: 15px;
}

#towerCompletionModal #towerCompletionRewards>div {
    background: rgba(0, 0, 0, 0.18);
    border-radius: 10px;
    padding: 12px 16px;
    border: 1px solid rgba(180, 155, 100, 0.35);
    color: #fef9c3;
}

/* Le bouton de fermeture utilise les styles globaux .stats-close */

/* Carte cible (Pokémon à capturer) */
#captureModal .capture-target-card {
    background: rgba(0, 0, 0, 0.15) !important;
    border: 1px solid rgba(180, 155, 100, 0.15) !important;
    border-radius: 14px;
}

#captureModal .capture-target-card [style*="font-weight:800"],
#captureModal .capture-target-card>div:not(.capture-scene) {
    color: #f8fafc !important;
}

#captureModal .capture-target-card .rarity-label {
    color: #e2e8f0 !important;
}

#captureModal .capture-target-card [style*="color:#666"] {
    color: #94a3b8 !important;
}

#captureModal .capture-sprite {
    filter: drop-shadow(0 4px 10px rgba(0, 0, 0, 0.25));
}

/* Grille des balls — hover très prononcé */
#captureModal .balls-grid {
    gap: 12px;
}

#captureModal .ball-select-btn {
    background: rgba(92, 80, 66, 0.95) !important;
    border: 1px solid rgba(180, 155, 100, 0.3) !important;
    border-radius: 14px;
    padding: 14px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    transition: transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease;
}

#captureModal .ball-select-btn [style*="font-weight:bold"] {
    color: #f1f5f9 !important;
}

#captureModal .ball-select-btn [style*="color:#666"] {
    color: #94a3b8 !important;
}

#captureModal .ball-select-btn:hover:not(:disabled) {
    transform: scale(1.05) translateY(-2px);
    box-shadow: 0 6px 16px rgba(0, 0, 0, 0.25);
    border-color: rgba(180, 155, 100, 0.5) !important;
}

#captureModal .ball-select-btn:active:not(:disabled) {
    transform: scale(1.02) translateY(-2px);
}

#captureModal .ball-select-btn:disabled {
    opacity: 0.45;
    filter: grayscale(0.9);
}

#captureModal .capture-chance-bar {
    background: rgba(0, 0, 0, 0.35) !important;
    border-radius: 4px;
}

#captureModal .ball-count-badge {
    background: rgba(180, 155, 100, 0.2);
    color: #fef3c7;
    border: 1px solid rgba(180, 155, 100, 0.3);
}

/* Bouton Fuir — discret, secondaire (tons moka) */
#captureModal .capture-flee-btn {
    width: 100%;
    margin-top: 20px !important;
    padding: 10px 16px !important;
    font-size: 13px !important;
    font-weight: 600 !important;
    background: transparent !important;
    color: #94a3b8 !important;
    border: 1px solid rgba(148, 163, 184, 0.3) !important;
    box-shadow: none !important;
    transition: color 0.2s, border-color 0.2s, background 0.2s;
}

#captureModal .capture-flee-btn:hover {
    color: #cbd5e1 !important;
    border-color: rgba(148, 163, 184, 0.45) !important;
    background: rgba(92, 80, 66, 0.3) !important;
}

/* --- UI MODULE AUTO-CATCHER (Style Porygon) --- */
.porygon-panel {
    background: linear-gradient(135deg, #1e1b4b 0%, #312e81 100%);
    border: 1px solid #6366f1;
    border-radius: 12px;
    padding: 15px;
    margin-bottom: 20px;
    color: white;
    box-shadow: 0 4px 15px rgba(49, 46, 129, 0.4);
    position: relative;
    overflow: hidden;
}

.porygon-panel::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: repeating-linear-gradient(45deg, transparent, transparent 10px, rgba(255, 255, 255, 0.03) 10px, rgba(255, 255, 255, 0.03) 20px);
    pointer-events: none;
}

.porygon-header {
    display: flex;
    justify-content: flex-start;
    align-items: center;
    margin-bottom: 15px;
    position: relative;
    z-index: 1;
}

.auto-catch-toggles {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    position: relative;
    z-index: 1;
}

.auto-catch-toggle-row {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 10px;
    padding: 10px;
    border: 1px solid rgba(129, 140, 248, 0.35);
    border-radius: 10px;
    background: rgba(15, 23, 42, 0.35);
}

.auto-catch-toggle-btn {
    min-width: 64px;
    padding: 6px 10px;
    border: 1px solid transparent;
    border-radius: 999px;
    font-size: 11px;
    font-weight: 900;
    letter-spacing: 0.6px;
    cursor: pointer;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease;
}

.auto-catch-toggle-btn.is-on {
    background: #22c55e;
    color: #052e16;
    border-color: #16a34a;
    box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.2);
}

.auto-catch-toggle-btn.is-off {
    background: #ef4444;
    color: #fee2e2;
    border-color: #dc2626;
    box-shadow: 0 0 0 2px rgba(239, 68, 68, 0.2);
}

.auto-catch-toggle-btn:hover {
    transform: translateY(-1px);
}

.auto-catch-toggle-btn.just-enabled {
    animation: autoCatchTogglePulse 0.35s ease-out;
}

@keyframes autoCatchTogglePulse {
    0% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(34, 197, 94, 0.45);
    }

    55% {
        transform: scale(1.06);
        box-shadow: 0 0 0 10px rgba(34, 197, 94, 0);
    }

    100% {
        transform: scale(1);
        box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
    }
}

@media (max-width: 768px) {
    .auto-catch-toggles {
        grid-template-columns: 1fr;
    }
}

/* --- BARRE DE COMMANDEMENT PREMIUM (VERSION FINALE) --- */
.combat-controls-wrapper {
    display: grid;
    grid-template-columns: 80px 1fr 80px;
    /* Gauche fixe, Centre fluide, Droite fixe */
    gap: 12px;
    margin-top: 15px;
    padding: 8px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1), 0 8px 10px -6px rgba(0, 0, 0, 0.1);
    border: 1px solid #e2e8f0;
    align-items: stretch;
}

/* Variante intégrée au battle-display : on "monte" la barre dans la scène */
.battle-display .combat-controls-wrapper {
    position: absolute;
    inset: auto 0 0 0;
    bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
    display: flex;
    justify-content: space-between;
    align-items: flex-end;
    padding: 0 20px;
    background: none;
    border: none;
    box-shadow: none;
}

.combat-controls-right {
    position: absolute;
    right: 0;
    bottom: 0;
    width: 0;
    height: 0;
}

.combat-controls-left {
    justify-content: flex-start;
    position: relative;
}

/* Style de base des boutons */
.cmd-btn {
    border-radius: 999px;
    font-weight: 700;
    font-size: 9px;
    cursor: pointer;
    transition: background-color 0.2s cubic-bezier(0.4, 0, 0.2, 1), color 0.2s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.2s cubic-bezier(0.4, 0, 0.2, 1), transform 0.2s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.2s cubic-bezier(0.4, 0, 0.2, 1), filter 0.2s cubic-bezier(0.4, 0, 0.2, 1);
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    color: #e5e7eb;
    background: rgba(15, 23, 42, 0.45);
    border: 1px solid rgba(148, 163, 184, 0.55);
    position: relative;
    overflow: hidden;
    height: 32px;
    min-width: 60px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    backdrop-filter: blur(6px);
    opacity: 0.55;
}

.cmd-btn:hover:not(:disabled) {
    opacity: 0.98;
    transform: translateY(-1px) scale(1.03);
    box-shadow: 0 6px 12px rgba(15, 23, 42, 0.5);
}

.cmd-btn:active:not(:disabled) {
    transform: translateY(0) scale(0.98);
    box-shadow: 0 2px 4px rgba(15, 23, 42, 0.4);
}

.cmd-btn:disabled {
    opacity: 0.35;
    cursor: not-allowed;
    filter: grayscale(1);
}

/* Auto / Fuir : gardent leur couleur même hors combat */
#autoSelectBtn.cmd-btn:disabled,
#forfeitBtn.cmd-btn:disabled {
    opacity: 0.8;
    /* proche de l'état normal */
    filter: none;
    /* pas de désaturation */
}

.cmd-icon {
    font-size: 20px;
    margin-bottom: 4px;
    filter: drop-shadow(0 2px 2px rgba(0, 0, 0, 0.1));
}

/* --- VARIANTES DE COULEURS --- */
.cmd-btn.auto-active {
    background: rgba(34, 197, 94, 0.25);
    color: #bbf7d0;
    border-color: rgba(74, 222, 128, 0.7);
}

.cmd-btn.capture-off {
    background: rgba(15, 23, 42, 0.35);
    color: #9ca3af;
}

.cmd-btn.capture-all {
    background: rgba(248, 113, 113, 0.35);
    color: #fee2e2;
    border-color: rgba(248, 113, 113, 0.7);
}

.cmd-btn.capture-target {
    background: rgba(59, 130, 246, 0.35);
    color: #dbeafe;
    border-color: rgba(59, 130, 246, 0.7);
}

.cmd-btn.forfeit {
    background: rgba(239, 68, 68, 0.30);
    border: 1px solid rgba(248, 113, 113, 0.75);
    color: #fee2e2;
}

/* Bouton Fuir : quart de cercle parfaitement dans l'angle bas droit */
#forfeitBtn.cmd-btn {
    position: absolute;
    width: 70px;
    height: 70px;
    right: -35px;
    bottom: -35px;
    border-radius: 50%;
    align-items: flex-start;
    justify-content: flex-start;
    padding: 6px;
}

/* --- QUART DE CERCLE CONCENTRIQUE (bas-gauche) - REFACTORISÉ --- */
.menu-angle-gauche {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 0;
    height: 0;
    z-index: 100;
}

/* Base commune */
.menu-angle-gauche .bouton-part {
    position: absolute;
    margin: 0;
    padding: 0;
    border: none;
    border-radius: 50%;
    cursor: pointer;
    transition: opacity 0.2s ease, transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: none;
    min-width: 0;
    opacity: 0.85;
}

.menu-angle-gauche .bouton-part span {
    font-size: 0;
    color: transparent;
    position: absolute;
    pointer-events: none;
}

.menu-angle-gauche .bouton-part:hover:not(:disabled) {
    opacity: 1;
}

/* --- BOUTON CAPTURE (ANNEAU) --- */
.menu-angle-gauche .bouton-capture {
    width: 120px;
    height: 120px;
    bottom: -60px;
    left: -60px;
    background-color: #636b76;
    z-index: 1;
}

/* Label par défaut (ON) */
.menu-angle-gauche .bouton-capture::after {
    content: "ON";
    position: absolute;
    top: 17%;
    right: 12%;
    transform: rotate(45deg);
    font-size: 13px;
    color: rgba(255, 255, 255, 0.9);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
    pointer-events: none;
    font-family: 'Outfit', sans-serif;
    transition: font-size 0.3s ease;
}

/* État OFF */
.menu-angle-gauche .bouton-capture.capture-off {
    background-color: rgba(55, 65, 81, 0.7);
}

.menu-angle-gauche .bouton-capture.capture-off::after {
    content: 'OFF';
    right: 10%;
    letter-spacing: 2px;
}

/* État CIBLE (Target) */
.menu-angle-gauche .bouton-capture.capture-target {
    background-color: rgba(59, 130, 246, 0.7);
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
}

/* Hover Capture */
.menu-angle-gauche .bouton-capture:hover {
    transform: scale(1.2) !important;
    transform-origin: bottom left;
    z-index: 150;
}

.menu-angle-gauche .bouton-capture:hover::after {
    font-size: 16px;
}

/* --- BOUTON AUTO (DISQUE) --- */
.menu-angle-gauche .bouton-auto {
    width: 64px;
    height: 64px;
    bottom: -32px;
    left: -32px;
    background-color: #3b8c6e;
    z-index: 2;
    clip-path: circle(50%);
}

.menu-angle-gauche .bouton-auto::after {
    content: "A";
    position: absolute;
    top: 18%;
    left: 55%;
    font-size: 11px;
    font-weight: 900;
    color: rgba(255, 255, 255, 0.95);
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.6);
    pointer-events: none;
    font-family: 'Outfit', sans-serif;
}

.menu-angle-gauche .bouton-auto.auto-active {
    background-color: rgba(34, 197, 94, 0.7);
    box-shadow: 0 0 12px rgba(74, 222, 128, 0.5);
}

.menu-angle-gauche .bouton-auto:hover {
    transform: scale(1.6);
    transform-origin: bottom left;
    z-index: 151;
}

/* --- GESTION DES SPRITES --- */

/* Masquer le label texte (ON/OFF) si sprite présent */
.menu-angle-gauche .bouton-capture.has-sprite::after {
    content: '' !important;
    font-size: 0 !important;
}

/* CAS 1 : Sprite Unique - Harmonisé avec le label "ON" (Top/Right) */
.menu-angle-gauche .bouton-capture.has-sprite:not([data-count])::before {
    content: '';
    position: absolute;
    top: -2%;
    right: 22%;
    /* Plus de translate complexe, on pose simplement */
    width: 40px;
    height: 40px;
    background-image: var(--sprite-url);
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    image-rendering: pixelated;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
    pointer-events: none;
    z-index: 1;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* Hover Sprite Unique */
.menu-angle-gauche .bouton-capture.has-sprite:not([data-count]):hover::before {
    width: 45px;
    height: 45px;
    top: 18%;
    right: 18%;
    /* On garde le centrage relatif */
    transform: scale(1.1);
}

/* CAS 2 : Deux Sprites (Multi) */
.menu-angle-gauche .bouton-capture.has-sprite[data-count]::before {
    content: '';
    position: absolute;
    top: 25%;
    right: 55%;
    width: 32px;
    height: 32px;
    background-image: var(--sprite-url);
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    image-rendering: pixelated;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
    pointer-events: none;
    z-index: 1;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* Second sprite via span */
.menu-angle-gauche .bouton-capture.has-sprite[data-count] span::before {
    content: '';
    position: absolute;
    top: -60px;
    right: -30px;
    width: 32px;
    height: 32px;
    background-image: var(--sprite-url-2);
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    image-rendering: pixelated;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.4));
    pointer-events: none;
    z-index: 1;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* Badge compteur pour Multi */
.menu-angle-gauche .bouton-capture.has-sprite[data-count]::after {
    content: '' attr(data-count) !important;
    font-size: 10px !important;
    position: absolute;
    top: 15%;
    right: 15%;
    background: #3b82f6;
    color: white;
    font-weight: 900;
    padding: 2px 5px;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    z-index: 2;
    transform: none;
    letter-spacing: normal;
}

/* Hover Double Sprite */
.menu-angle-gauche .bouton-capture.has-sprite[data-count]:hover::before {
    width: 48px;
    height: 48px;
    top: 20%;
    right: 60%;
}

.menu-angle-gauche .bouton-capture.has-sprite[data-count]:hover span::before {
    width: 48px;
    height: 48px;
    top: -70px;
    right: -20px;
}

.cmd-btn.forfeit:hover {
    background: #fef2f2;
    border-color: #ef4444;
}

/* --- NOUVEAU SÉLECTEUR DE CIBLE (GRID) --- */

/* Le Conteneur principal (Caché par défaut) */
.target-grid-wrapper {
    display: none;
    background: #f8fafc;
    padding: 8px;
    border-radius: 12px;
    border: 1px solid #cbd5e1;
    margin-top: 8px;
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    position: relative;
    z-index: 1000;

    /* Animation fluide */
    transform-origin: top;
    transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, transform 0.3s ease, opacity 0.3s ease, box-shadow 0.3s ease, filter 0.3s ease;
}

/* Classe ajoutée par JS pour afficher */
.target-grid-wrapper.show {
    display: block !important;
    animation: slideOpen 0.3s ease-out;
}

@keyframes slideOpen {
    from {
        opacity: 0;
        transform: translateY(-10px) scaleY(0.9);
    }

    to {
        opacity: 1;
        transform: translateY(0) scaleY(1);
    }
}

/* La Grille elle-même */
.target-grid {
    display: grid;
    /* Magie CSS : Remplit la ligne avec autant de cases de 42px que possible */
    grid-template-columns: repeat(auto-fill, minmax(42px, 1fr));
    gap: 6px;
    max-height: 160px;
    /* Scroll vertical si trop de pokémons */
    overflow-y: auto;
    padding-right: 2px;
    /* Pour la scrollbar */
}

/* LE SLOT (Le bouton carré avec l'image) */
.target-slot {
    width: 100%;
    aspect-ratio: 1;
    /* Force le carré parfait */
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    /* Main au survol */
    transition: background-color 0.1s cubic-bezier(0.4, 0, 0.2, 1), color 0.1s cubic-bezier(0.4, 0, 0.2, 1), border-color 0.1s cubic-bezier(0.4, 0, 0.2, 1), transform 0.1s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.1s cubic-bezier(0.4, 0, 0.2, 1), box-shadow 0.1s cubic-bezier(0.4, 0, 0.2, 1), filter 0.1s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
}

/* Survol */
.target-slot:hover {
    transform: scale(1.2);
    border-color: #94a3b8;
    z-index: 10;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}



/* L'image du Pokémon */
.target-slot img {
    width: 32px;
    height: 32px;
    image-rendering: pixelated;
    /* Pixel art net */
    pointer-events: none;
    /* Le clic traverse l'image pour atteindre le bouton */
}





/* Petit badge de token dans le modal */
.prestige-token-badge {
    background: linear-gradient(135deg, #ffd700, #f59e0b);
    color: #fff;
    font-weight: bold;
    padding: 2px 6px;
    border-radius: 4px;
    font-size: 11px;
    margin-left: 5px;
}

/* UI Floating Text (Ressources) */
.ui-floating-text {
    position: fixed;
    /* Fixe par rapport à l'écran, pas au parent */
    font-weight: 800;
    font-size: 14px;
    pointer-events: none;
    /* La souris passe à travers */
    z-index: 10000;
    /* Au-dessus de tout (Header inclus) */
    animation: ui-float-up 1.5s ease-out forwards;
    /* Contour blanc pour lisibilité */
}

/* Couleurs spécifiques */
.ft-money {
    color: #16a34a;
}

/* Vert Dollar */
.ft-bank {
    color: #0ea5e9;
}

/* Bleu Banque */
.ft-debt {
    color: #ef4444;
}

/* Rouge Dette */
.ft-token {
    color: #d97706;
}

/* Or Jeton */
.ft-shard {
    color: #a855f7;
}

/* Violet Shard */

/* Sprite Shard en inline (pour coûts, UI prestige, etc.) */
.shard-inline {
    width: 1.2em;
    height: 1.2em;
    vertical-align: middle;
    display: inline-block;
    object-fit: contain;
}

@keyframes ui-float-up {
    0% {
        opacity: 1;
        transform: translateY(0) scale(1);
    }

    20% {
        transform: translateY(-5px) scale(1.2);
    }

    /* Petit pop */
    100% {
        opacity: 0;
        transform: translateY(-30px) scale(1);
    }
}

/* 2. Le Badge lui-même (Rappel pour être sûr) */
.atb-stack-badge {
    position: absolute;
    right: 0px;
    /* Collé à droite */
    top: -12px;
    /* Remonté au dessus de la barre */
    background: #ef4444;
    color: white;
    font-size: 10px;
    font-weight: 800;
    padding: 2px 5px;
    border-radius: 10px;
    z-index: 999;
    /* Au dessus de tout */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
    pointer-events: none;
    /* Pour ne pas gêner les clics */
}

@keyframes bounce {
    from {
        transform: translateY(0);
    }

    to {
        transform: translateY(-3px);
    }
}


/* --- MODAL LOGS : STYLE RPG CLAIR --- */

/* 1. La Boîte Principale */
.log-modal-content {
    background: #1e293b;
    /* Gris-Bleu "Slate 800" (Standard UI) */
    border: 1px solid #475569;
    /* Bordure plus claire */
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.5);
    width: 90%;
    max-width: 600px;
    border-radius: 12px;
    /* Coins plus arrondis */
    overflow: hidden;
    /* Pour que le header ne dépasse pas */
    display: flex;
    flex-direction: column;
}

/* 2. En-tête (Header) */
.modal-header-logs {
    background: var(--surface-dark-alt);
    padding: 15px 20px;
    border-bottom: 1px solid var(--border-dark);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header-logs h2 {
    margin: 0;
    font-size: 18px;
    color: var(--text-on-dark);
    /* Blanc cassé (très lisible) */
    font-weight: 700;
}

/* 3. Zone de texte (Le Journal) */
.log-console-scroll {
    height: 350px;
    overflow-y: auto;
    background: #3b3b3b !important;
    margin: 0;
    padding: 15px 20px;
    font-family: 'Outfit', sans-serif !important;
    font-size: 13px;
    line-height: 1.6;
    border-radius: 8px;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
}

/* 4. Les Lignes de texte */
.log-entry {
    padding: 6px 0;
    border-bottom: 1px solid #1e293b;
    /* Séparateur subtil */
    color: #cbd5e1;
    /* Gris clair (Slate 300) - Très lisible */
    transition: background 0.2s;
}

.log-entry:hover {
    background: rgba(255, 255, 255, 0.03);
    /* Petit effet au survol */
}

/* 5. L'heure */
.log-time {
    color: #60a5fa;
    /* Bleu clair pour l'heure (se distingue bien) */
    font-weight: 600;
    font-size: 0.9em;
    margin-right: 8px;
    display: inline-block;
    min-width: 60px;
    /* Aligne le texte proprement */
}

/* 6. Footer (Bouton Vider) */
.modal-footer-logs {
    padding: 10px 20px;
    background: #1e293b;
    border-top: 1px solid #334155;
    text-align: right;
}

/* CORRECTIF VISIBILITÉ : On cible l'ID précis pour être prioritaire */
#logModal {
    display: none;
    /* Caché par défaut */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.85);
    /* Fond sombre */
    z-index: 10000;
    /* Au-dessus de ABSOLUMENT TOUT */
    align-items: center;
    justify-content: center;
}

/* Quand la classe 'show' est ajoutée via JS, on force l'affichage */
#logModal.show {
    display: flex !important;
}


/* --- ANIMATIONS DE CAPTURE "JUICY" --- */

/* Le conteneur de l'animation (se superpose au sprite) */
.capture-scene {
    position: relative;
    height: 150px;
    display: flex;
    justify-content: center;
    align-items: flex-end;
    overflow: visible;
}


/* L'effet "Aspiration" (Version Prioritaire) */
.capture-sprite.absorbed {
    /* 1. On coupe l'animation de flottement de force */
    animation: none !important;

    /* 2. L'effet visuel (Silhouette) */
    filter: sepia(1) saturate(5) hue-rotate(-50deg) brightness(1.2) contrast(1.2) !important;

    /* 3. La réduction physique */
    transform: translateY(50px) scale(0) !important;

    /* 4. L'opacité finale */
    opacity: 0 !important;

    /* 5. LA CLÉ DU SUCCÈS : On force la règle de transition */
    /* Cela empêche toute autre règle 'transition: all' de casser notre délai */
    transition:
        transform 0.45s ease-in,
        /* Mouvement fluide */
        filter 0.1s linear,
        /* Changement couleur immédiat */
        opacity 0.1s linear 0.35s !important;
    /* Disparition retardée (FORCE) */
}

/* 1. État par défaut (En l'air) : Pivot au CENTRE pour tourner rond */
.flying-ball {
    position: absolute;
    width: 48px;
    height: 48px;
    z-index: 10000;
    transform-origin: center center;
    /* Rotation propre pendant le lancer */
}

/* 2. État au sol : Pivot en BAS pour les secousses réalistes */
.flying-ball.grounded {
    transform-origin: 50% 90%;
    transform: scale(1);
}

/* Lancer en cloche "Précision Chirurgicale" (0-20-40-60-80-100) */
@keyframes ball-throw-arc {

    /* 0% : DÉPART (Main du dresseur, bas-gauche) */
    0% {
        transform: translate(-100px, 180px) scale(1.5) rotate(-360deg);
        opacity: 1;
    }

    /* 20% : MONTÉE INITIALE (Rapide) */
    20% {
        transform: translate(-70px, 50px) scale(1.4) rotate(-280deg);
    }

    /* 40% : APPROCHE DU SOMMET (Ralentissement vertical) */
    40% {
        transform: translate(-30px, -35px) scale(1.3) rotate(-200deg);
    }

    /* 60% : APOGÉE (Le point le plus haut, la balle "plane") */
    60% {
        transform: translate(-10px, -50px) scale(1.2) rotate(-120deg);
    }

    /* 80% : CHUTE (Accélération vers la cible) */
    80% {
        transform: translate(-5px, -25px) scale(1.1) rotate(-60deg);
    }

    /* 100% : IMPACT (Centre de la cible) */
    100% {
        transform: translate(0, 0) scale(1) rotate(0deg);
    }
}

/* On garde ta durée de 15s et on utilise 'linear' car les points clés font déjà la courbe */
.anim-throw {
    animation: ball-throw-arc 15s linear forwards;
}

/* Le Rebond (Ajusté pour le nouveau pivot) */
@keyframes ball-bounce {
    0% {
        transform: translateY(0) scaleY(1);
    }

    40% {
        transform: translateY(-40px) scaleY(0.9);
    }

    /* S'étire en montant */
    100% {
        transform: translateY(0) scaleY(1);
    }

    /* S'écrase un peu en atterrissant */
}

@keyframes ball-shake-left {
    0% {
        transform: rotate(0) scale(1);
        filter: brightness(1);
    }

    25% {
        transform: rotate(-35deg) scale(1);
        filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.8)) sepia(0.5) hue-rotate(-50deg);
    }

    50% {
        transform: rotate(0) scale(1);
        filter: brightness(1);
    }

    100% {
        transform: rotate(0) scale(1);
    }
}

@keyframes ball-shake-right {
    0% {
        transform: rotate(0) scale(1);
        filter: brightness(1);
    }

    25% {
        transform: rotate(35deg) scale(1);
        filter: drop-shadow(0 0 10px rgba(255, 0, 0, 0.8)) sepia(0.5) hue-rotate(-50deg);
    }

    50% {
        transform: rotate(0) scale(1);
        filter: brightness(1);
    }

    100% {
        transform: rotate(0) scale(1);
    }
}

/* 3. Succès (Lock) */
@keyframes catch-success-dim {
    0% {
        filter: brightness(1);
        transform: scale(1);
    }

    50% {
        filter: brightness(0.5);
        transform: scale(1);
    }

    100% {
        filter: brightness(0.5);
        transform: scale(1);
    }
}

@keyframes catch-stars {
    0% {
        transform: scale(0);
        opacity: 0;
    }

    50% {
        transform: scale(1.5);
        opacity: 1;
    }

    100% {
        transform: scale(2);
        opacity: 0;
    }
}

/* 4. Échec (Break) */
@keyframes catch-break {
    0% {
        transform: scale(1);
    }

    50% {
        transform: scale(0.4);
        opacity: 0.5;
        filter: grayscale(1);
    }

    100% {
        transform: scale(0);
        opacity: 0;
    }
}

/* Classes utilitaires JS */
.anim-throw {
    animation: ball-throw-arc 0.6s ease-in forwards;
}

.anim-bounce {
    animation: ball-bounce 0.4s ease-out;
}

.anim-shake-1 {
    animation: ball-shake-left 0.8s ease-in-out;
}

.anim-shake-2 {
    animation: ball-shake-right 0.8s ease-in-out;
}

.anim-shake-3 {
    animation: ball-shake-left 0.8s ease-in-out;
}

.anim-lock {
    animation: catch-success-dim 0.5s forwards;
}

.anim-break {
    animation: catch-break 0.4s ease-out forwards;
}

/* --- MODAL HORS-LIGNE (V2) --- */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(15, 23, 42, 0.85);
    /* Plus sombre */
    z-index: 2000;
    display: none;
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.modal-content {
    background: #947864 !important;
    width: 95%;
    max-width: 450px;
    border: 4px solid #5d4a3e !important;
    border-radius: 12px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    font-family: 'Outfit', sans-serif;
    animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

@keyframes popIn {
    from {
        transform: scale(0.9);
        opacity: 0;
    }

    to {
        transform: scale(1);
        opacity: 1;
    }
}

/* Header */
.modal-header {
    background: #bec3c6 !important;
    border: 3px solid #3b3b3b !important;
}

.modal-header h2 {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: 8px;
}

/* Body */
.modal-body {
    padding: 15px !important;
    background: #bec3c6 !important;
    max-height: 55vh !important;
    overflow-y: auto;
}

/* Résumé Temps */
.offline-summary {
    background: #3b3b3b !important;
    padding: 15px !important;
    text-align: center;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px !important;
    color: #fff !important;
    margin-bottom: 15px !important;
}

.offline-time {
    font-size: 22px !important;
    font-weight: 800 !important;
    color: #4ade80 !important;
}

.offline-subtitle {
    color: #aaa !important;
}

/* Grille Stats Globales */
.stats-row {
    display: flex;
    gap: 10px;
    padding: 15px;
    justify-content: center;
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 8px !important;
    margin-bottom: 15px !important;
}

.mini-stat .val {
    font-weight: 800;
    color: #fff !important;
}

.mini-stat .lbl {
    color: #aaa !important;
}

/* Section Titres */
.section-title {
    padding: 12px 20px 5px;
    font-size: 12px;
    font-weight: 800;
    text-transform: uppercase;
    color: #3b3b3b !important;
    letter-spacing: 0.5px;
}

.offline-incubation-panel {
    margin: 0 15px 12px;
    padding: 10px;
    border-radius: 8px;
    background: #3b3b3b;
    border: 2px solid #1a1a1a;
}

.offline-incubation-summary {
    display: flex;
    gap: 8px;
    margin-bottom: 10px;
    flex-wrap: wrap;
}

.offline-incubation-pill {
    background: #0f172a;
    border: 1px solid #334155;
    color: #e2e8f0;
    border-radius: 999px;
    padding: 4px 10px;
    font-size: 11px;
}

.offline-incubation-columns {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 8px;
}

.offline-incubation-column {
    background: #111827;
    border: 1px solid #374151;
    border-radius: 8px;
    padding: 8px;
}

.offline-incubation-subtitle {
    font-size: 11px;
    color: #cbd5e1;
    margin-bottom: 6px;
    font-weight: 700;
}

.offline-incubation-row {
    display: flex;
    justify-content: space-between;
    color: #e5e7eb;
    font-size: 12px;
    padding: 2px 0;
}

.offline-incubation-preview {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
}

.offline-incubation-pokemon-chip {
    background: #1f2937;
    border: 1px solid #374151;
    color: #e5e7eb;
    border-radius: 999px;
    padding: 3px 8px;
    font-size: 11px;
}

.offline-incubation-empty {
    color: #9ca3af;
    font-size: 11px;
}

/* Liste des Objets (Scrollable) */
.loot-scroll-area {
    padding: 0 15px;
    margin-bottom: 15px;
}

.loot-item {
    display: flex;
    align-items: center;
    background: var(--surface-dark-alt, #292524) !important;
    padding: 10px;
    margin-bottom: 8px;
    border-radius: 8px;
    border: 2px solid var(--surface-dark, #1c1917) !important;
    color: var(--text-on-dark, #fafafa) !important;
}

/* Noms et quantités lisibles sur fond sombre (rapport offline) */
.loot-item .item-name,
.loot-item .item-qty {
    color: var(--text-on-dark, #fafafa) !important;
}

.loot-item .item-info {
    color: var(--text-on-dark-secondary, #d4d4d4);
}

.poke-capture {
    background: #3b3b3b !important;
    border-radius: 8px;
    border: 2px solid #1a1a1a !important;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
}

.modal-footer {
    padding: 15px;
    background: #bec3c6 !important;
    border-top: 3px solid #3b3b3b !important;
    border-bottom-left-radius: 8px;
    border-bottom-right-radius: 8px;
}

.claim-btn {
    background: #5d4a3e !important;
    color: white !important;
    border: 2px solid #3b3b3b !important;
    box-shadow: 0 4px 0 #3b3b3b !important;
}

/* ========== Professor Chen Narrative Engine (coh�rent avec le jeu) ========== */
.narrative-overlay {
    position: fixed;
    inset: 0;
    z-index: 10000;
    background: rgba(0, 0, 0, 0.5);
    backdrop-filter: blur(4px);
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
    opacity: 0;
    transition: opacity 0.25s ease-out;
}

.narrative-overlay.narrative-open {
    display: flex;
    opacity: 1;
}

/* Quand Chen parle du bouton des stats, le header (stats) ne doit pas �tre flout� */
body.narrative-stats-visible .narrative-overlay {
    backdrop-filter: none;
}

body.narrative-stats-visible .header {
    position: relative;
    z-index: 10001;
}

.narrative-overlay.narrative-open .narrative-dialogue {
    animation: narrative-modal-in 0.3s ease-out forwards;
}

@keyframes narrative-modal-in {
    from {
        opacity: 0;
        transform: scale(0.95) translateY(10px);
    }

    to {
        opacity: 1;
        transform: scale(1) translateY(0);
    }
}

.narrative-dialogue {
    background: #947864 !important;
    border: 4px solid #5d4a3e !important;
    border-radius: 12px;
    max-width: 640px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    padding: 10px;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5), 0 6px 0 #5d4a3e;
    position: relative;
}

.narrative-dialogue::before {
    content: '';
    position: absolute;
    top: 10px;
    left: 15px;
    width: 10px;
    height: 10px;
    background: #ff5f56;
    border-radius: 50%;
    box-shadow: 18px 0 0 #ffbd2e, 36px 0 0 #27c93f;
    border: 1px solid rgba(0, 0, 0, 0.2);
    z-index: 10;
}

.narrative-dialogue-inner {
    display: flex;
    gap: 20px;
    padding: 20px;
    align-items: flex-start;
    background: #f1f5f9 !important;
    /* Fond très clair pour un contraste texte noir optimal */
    border-radius: 8px;
    border: 3px solid #3b3b3b;
    margin-top: 20px;
}

.narrative-chen-column {
    flex-shrink: 0;
    width: 96px;
    height: 96px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #3b3b3b !important;
    border: 2px solid #1a1a1a !important;
    border-radius: 12px;
    position: relative;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
}

.narrative-chen-sprite {
    width: 96px;
    height: 96px;
    object-fit: contain;
    image-rendering: pixelated;
    image-rendering: -moz-crisp-edges;
    image-rendering: crisp-edges;
}

.narrative-chen-fallback {
    display: none;
    font-size: 48px;
    line-height: 1;
}

.narrative-chen-fallback.narrative-chen-fallback-visible {
    display: block;
}

.narrative-content-column {
    flex: 1;
    min-width: 0;
}

.narrative-speaker {
    color: #fbbf24 !important;
    font-weight: 800;
    font-size: 14px;
    margin-bottom: 8px;
    text-transform: uppercase;
    letter-spacing: 0.1em;
}

.narrative-text {
    color: #ffffff !important;
    text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
    line-height: 1.6;
    font-size: 15px;
    font-weight: 800;
    margin-bottom: 12px;
    white-space: pre-wrap;
}

.narrative-page-indicator {
    color: #64748b;
    font-size: 12px;
    margin-bottom: 12px;
}

.narrative-actions {
    margin-top: 16px;
}

.narrative-next-btn,
.narrative-close-btn {
    padding: 10px 20px;
    background: #334155;
    color: white;
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
}

.narrative-next-btn:hover,
.narrative-close-btn:hover {
    background: #475569;
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.narrative-close-btn {
    background: #334155;
}

.narrative-close-btn:hover {
    background: #475569;
}

.narrative-milestone-overlay {
    z-index: 10001;
}

.narrative-milestone-dialogue {
    max-width: 520px;
}

.narrative-story-quest .narrative-story-quest-title {
    padding: 12px 24px 0;
    font-size: 16px;
    font-weight: 700;
    color: #854d0e !important;
}

.narrative-story-quest .narrative-dialogue-inner {
    padding-top: 12px;
}

.narrative-starters {
    display: flex;
    flex-wrap: wrap;
    gap: 12px;
    justify-content: center;
}

.narrative-starter-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 6px;
    padding: 12px 16px;
    background: white;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    color: #1e293b;
    cursor: pointer;
    transition: transform 0.15s, border-color 0.15s, box-shadow 0.15s;
}

.narrative-starter-btn:hover {
    border-color: #f59e0b;
    transform: scale(1.05);
    box-shadow: 0 4px 6px -1px rgba(245, 158, 11, 0.2);
}

.narrative-starter-btn img {
    width: 64px;
    height: 64px;
    image-rendering: pixelated;
}

.narrative-continue-btn {
    width: 100%;
    padding: 12px 20px;
    margin-top: 12px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: white;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    font-size: 16px;
    cursor: pointer;
    transition: background 0.2s, transform 0.1s, box-shadow 0.2s;
}

.narrative-continue-btn:hover {
    filter: brightness(1.1);
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
}

/* Billion finale � EPIC FX */
.narrative-overlay.narrative-epic {
    background: rgba(0, 0, 0, 0.9);
}

.narrative-epic-fx {
    position: relative;
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
}

.narrative-epic-particles {
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 50%, rgba(251, 191, 36, 0.15) 0%, transparent 50%);
    animation: narrative-glow 0.8s ease-in-out infinite alternate;
}

.narrative-epic-shake {
    position: absolute;
    inset: 0;
    animation: narrative-shake 0.15s ease-in-out infinite;
}

.narrative-epic-text {
    position: relative;
    z-index: 2;
    font-size: clamp(24px, 5vw, 48px);
    font-weight: 900;
    color: #fbbf24;
    animation: narrative-pulse 0.5s ease-in-out infinite alternate;
}

@keyframes narrative-glow {
    from {
        opacity: 0.6;
        transform: scale(0.95);
    }

    to {
        opacity: 1;
        transform: scale(1.05);
    }
}

@keyframes narrative-shake {

    0%,
    100% {
        transform: translate(0, 0);
    }

    25% {
        transform: translate(-4px, -2px);
    }

    75% {
        transform: translate(4px, 2px);
    }
}

@keyframes narrative-pulse {
    from {
        transform: scale(1);
        opacity: 0.9;
    }

    to {
        transform: scale(1.1);
        opacity: 1;
    }
}

/* Billion � ugly reveal box */
.narrative-overlay.narrative-reveal {
    background: rgba(0, 0, 0, 0.85);
}

.narrative-ugly-box {
    background: #d1d5db;
    border: 3px solid #6b7280;
    padding: 16px 24px;
    font-family: 'Courier New', monospace;
    font-size: 14px;
    color: #111;
    max-width: 320px;
    box-shadow: inset 0 0 0 2px #9ca3af;
}

.narrative-ugly-title {
    font-weight: bold;
    margin-bottom: 8px;
    font-size: 16px;
}

.narrative-ugly-stats {
    letter-spacing: 0.02em;
}

/* === MODAL DE S�LECTION DES CIBLES DE CAPTURE === */
.capture-target-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
    gap: 10px;
    padding: 15px;
    max-height: 400px;
    overflow-y: auto;
}

.target-slot {
    background: #f8fafc;
    border: 3px solid #cbd5e1;
    border-radius: 12px;
    padding: 8px;
    cursor: pointer;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    aspect-ratio: 1;
    position: relative;
}

.target-slot:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    border-color: #94a3b8;
}

/* État SÉLECTIONNÉ (Bordure verte) */
.target-slot.selected {
    border-color: #64ac64 !important;
    /* Vert */
    box-shadow: 0 0 0 1px rgba(100, 172, 100, 1) !important;
}

/* Suppression de l'indicateur "point vert" */
.target-slot.selected::after {
    content: none;
}

.target-slot img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    image-rendering: pixelated;
    filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}






/* ========================================
   DESIGN SYSTEM - Imported from design-system.css
   ======================================== */

/**
 * DESIGN SYSTEM - Règle 60-30-10 avec Contraste WCAG AAA
 * 
 * 60% : Fonds globaux (tons chauds marron/moka)
 * 30% : Surfaces à haut contraste (très clair OU très foncé)
 * 10% : Accents vibrants (or, vert, rouge, bleu)
 */

:root {
    /* ========================================
       60% - FONDS GLOBAUX (Backgrounds)
       ======================================== */

    /* Fonds principaux - Tons chauds pour reposer les yeux */
    --bg-primary: #947864;
    /* Marron principal (actuel) */
    --bg-secondary: #7a614e;
    /* Marron plus foncé */
    --bg-tertiary: #5d4a3e;
    /* Marron très foncé */
    --bg-warm: #bec3c6;
    /* Gris-beige clair */

    /* ========================================
       30% - SURFACES (Cards, Modals, Panels)
       ======================================== */

    /* Surfaces CLAIRES - Pour texte FONCÉ */
    --surface-light: #fafaf9;
    /* Blanc cassé (stone-50) - Ratio 20.35:1 avec noir */
    --surface-light-alt: #f5f5f4;
    /* Crème (stone-100) - Ratio 18.67:1 avec noir */
    --surface-light-hover: #e7e5e4;
    /* Stone-200 - Pour hover */

    /* Surfaces FONCÉES - Pour texte CLAIR */
    --surface-dark: #1c1917;
    /* Anthracite (stone-900) - Ratio 18.23:1 avec blanc */
    --surface-dark-alt: #292524;
    /* Gris foncé (stone-800) - Ratio 14.89:1 avec blanc */
    --surface-dark-hover: #44403c;
    /* Stone-700 - Pour hover */

    /* ========================================
       10% - ACCENTS (Actions & États)
       ======================================== */

    /* OR/JAUNE - Prestige, Légendaire, Récompenses */
    --accent-gold: #fbbf24;
    /* Amber-400 - Vif et chaleureux */
    --accent-gold-dark: #f59e0b;
    /* Amber-500 - Pour hover */
    --accent-gold-darker: #d97706;
    /* Amber-600 - Pour active/pressed */
    --accent-gold-light: #fde68a;
    /* Amber-200 - Pour backgrounds */

    /* VERT - Succès, Évolutions, Améliorations */
    --accent-green: #22c55e;
    /* Green-500 - Éclatant */
    --accent-green-dark: #16a34a;
    /* Green-600 - Pour hover */
    --accent-green-darker: #15803d;
    /* Green-700 - Pour active/pressed */
    --accent-green-light: #86efac;
    /* Green-300 - Pour backgrounds */

    /* ROUGE - Danger, Fermer, Annuler */
    --accent-red: #ef4444;
    /* Red-500 - Net et visible */
    --accent-red-dark: #dc2626;
    /* Red-600 - Pour hover */
    --accent-red-darker: #b91c1c;
    /* Red-700 - Pour active/pressed */
    --accent-red-light: #fca5a5;
    /* Red-300 - Pour backgrounds */

    /* BLEU - Informations, Actions secondaires */
    --accent-blue: #3b82f6;
    /* Blue-500 - Pour boutons secondaires */
    --accent-blue-dark: #2563eb;
    /* Blue-600 - Pour hover */
    --accent-blue-darker: #1d4ed8;
    /* Blue-700 - Pour active/pressed */
    --accent-blue-light: #93c5fd;
    /* Blue-300 - Pour backgrounds */

    /* ========================================
       TEXTES avec Contraste Garanti
       ======================================== */

    /* Texte sur SURFACES CLAIRES */
    --text-on-light: #1a1a1a;
    /* Noir presque pur - Ratio 18.5:1 */
    --text-on-light-secondary: #404040;
    /* Gris très foncé - Ratio 12.6:1 */
    --text-on-light-tertiary: #525252;
    /* Gris foncé - Ratio 9.7:1 */
    --text-on-light-muted: #737373;
    /* Gris moyen - Ratio 7.1:1 (AAA large text) */

    /* Texte sur SURFACES FONCÉES */
    --text-on-dark: #fafafa;
    /* Blanc cassé - Ratio 18.2:1 */
    --text-on-dark-secondary: #d4d4d4;
    /* Gris très clair - Ratio 12.1:1 */
    --text-on-dark-tertiary: #a3a3a3;
    /* Gris clair - Ratio 7.8:1 */
    --text-on-dark-muted: #737373;
    /* Gris moyen - Ratio 4.6:1 (AA) */

    /* Texte sur FONDS MARRON (60%) */
    --text-on-brown: #fafafa;
    /* Blanc cassé pour lisibilité */
    --text-on-brown-dark: #1a1a1a;
    /* Noir pour zones claires */

    /* ========================================
       BORDURES & SÉPARATEURS
       ======================================== */

    --border-light: #e7e5e4;
    /* Bordure sur fond clair */
    --border-dark: #44403c;
    /* Bordure sur fond foncé */
    --border-accent: #a3a3a3;
    /* Bordure neutre */

    /* ========================================
       OMBRES
       ======================================== */

    --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px rgba(0, 0, 0, 0.1);
    --shadow-lg: 0 10px 15px rgba(0, 0, 0, 0.15);
    --shadow-xl: 0 20px 25px rgba(0, 0, 0, 0.2);

    /* ========================================
       TRANSITIONS
       ======================================== */

    --transition-fast: 0.15s ease;
    --transition-normal: 0.2s ease;
    --transition-slow: 0.3s ease;
}

/* ========================================
   CLASSES UTILITAIRES
   ======================================== */

/* Surfaces */
.surface-light {
    background: var(--surface-light);
    color: var(--text-on-light);
}

.surface-dark {
    background: var(--surface-dark);
    color: var(--text-on-dark);
}

/* Boutons d'action */
.btn-primary {
    background: var(--accent-gold);
    color: var(--text-on-dark);
    border: 2px solid var(--accent-gold-dark);
    font-weight: 900;
    transition: var(--transition-fast);
}

.btn-primary:hover:not(:disabled) {
    background: var(--accent-gold-dark);
    border-color: var(--accent-gold-darker);
}

.btn-success {
    background: var(--accent-green);
    color: var(--text-on-dark);
    border: 2px solid var(--accent-green-dark);
    font-weight: 900;
    transition: var(--transition-fast);
}

.btn-success:hover:not(:disabled) {
    background: var(--accent-green-dark);
    border-color: var(--accent-green-darker);
}

.btn-danger {
    background: var(--accent-red);
    color: var(--text-on-dark);
    border: 2px solid var(--accent-red-dark);
    font-weight: 900;
    transition: var(--transition-fast);
}

.btn-danger:hover:not(:disabled) {
    background: var(--accent-red-dark);
    border-color: var(--accent-red-darker);
}

.btn-secondary {
    background: var(--accent-blue);
    color: var(--text-on-dark);
    border: 2px solid var(--accent-blue-dark);
    font-weight: 800;
    transition: var(--transition-fast);
}

.btn-secondary:hover:not(:disabled) {
    background: var(--accent-blue-dark);
    border-color: var(--accent-blue-darker);
}

/* Texte */
.text-primary {
    color: var(--text-on-light);
}

.text-secondary {
    color: var(--text-on-light-secondary);
}

.text-muted {
    color: var(--text-on-light-tertiary);
}

/* Bordures */
.border-light {
    border-color: var(--border-light);
}

.border-dark {
    border-color: var(--border-dark);
}


/* ========================================
   POKEDEX FIXES - Imported from pokedex-fixes.css
   ======================================== */

/* Fix for malformed arrow characters in sort buttons */
.sort-btn.active::after {
    content: " ";
}

.sort-btn.active.asc::after {
    content: " ";
}

/* Additional Pokedex card improvements */
.creature-card h4 {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    width: 100%;
}


/* ========================================
   CAPTURE BUTTON SPRITES - Imported from capture-sprite-fix.css
   ======================================== */

/* Masquer le texte par défaut */


/* === MODAL AUTO SETTINGS === */

.auto-settings-btn {
    position: absolute;
    bottom: 5px;
    left: 5px;
    width: 24px;
    height: 24px;
    background: rgba(255, 255, 255, 0.2);
    border: 1px solid rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    font-size: 12px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 10;
    transition: background-color 0.2s ease, color 0.2s ease, border-color 0.2s ease, transform 0.2s ease, opacity 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease;
}

.auto-settings-btn:hover {
    background: rgba(255, 255, 255, 0.4);
    transform: scale(1.1) rotate(90deg);
}

.auto-setting-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 15px;
    background: #f5f5f5;
    border-radius: 8px;
    cursor: pointer;
    transition: background 0.2s ease;
}

.auto-setting-item:hover {
    background: #e8e8e8;
}

.auto-setting-item input[type=\"checkbox\"] {
    margin-top: 2px;
    width: 20px;
    height: 20px;
    cursor: pointer;
}

.auto-setting-label {
    display: flex;
    flex-direction: column;
    gap: 4px;
    flex: 1;
}

.auto-setting-label strong {
    font-size: 15px;
    color: #333;
}

.auto-setting-label small {
    font-size: 12px;
    color: #666;
    line-height: 1.4;
}

/* === TOGGLE SWITCH === */

.toggle-switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 26px;
}

.toggle-switch input {
    opacity: 0;
    width: 0;
    height: 0;
}

.toggle-slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: 0.3s;
    border-radius: 26px;
}

.toggle-slider:before {
    position: absolute;
    content: '';
    height: 20px;
    width: 20px;
    left: 3px;
    bottom: 3px;
    background-color: white;
    transition: 0.3s;
    border-radius: 50%;
}

.toggle-switch input:checked+.toggle-slider {
    background-color: #4CAF50;
}

.toggle-switch input:checked+.toggle-slider:before {
    transform: translateX(24px);
}

/* === COMPACT POPUPS (Auto Settings & Capture Target) === */

/* Popup compact au lieu de modal plein écran */
.compact-popup {
    position: fixed;
    background: rgba(30, 30, 30, 0.98);
    border: 2px solid #d97706;
    border-radius: 12px;
    box-shadow: 0 8px 32px rgba(0, 0, 0, 0.6);
    padding: 0;
    z-index: 1000;
    display: none;
    max-width: 400px;
    max-height: 80vh;
    overflow-y: auto;
}

.compact-popup.show {
    display: block;
}

/* Position près du bouton Auto (bas-gauche) */
#autoSettingsModal.compact-popup {
    bottom: 80px;
    left: 20px;
}

/* Position près du bouton Capture (bas-gauche, un peu plus haut) */
#captureTargetWrapper.compact-popup {
    bottom: 80px;
    left: 20px;
}

/* Header compact */
.compact-popup .stats-header {
    background: linear-gradient(135deg, #d97706 0%, #b45309 100%);
    padding: 12px 15px;
    border-radius: 10px 10px 0 0;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.compact-popup .stats-header h2 {
    font-size: 16px;
    margin: 0;
    color: white;
}

.compact-popup .stats-close {
    background: rgba(255, 255, 255, 0.2);
    border: none;
    color: white;
    font-size: 18px;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background 0.2s;
}

.compact-popup .stats-close:hover {
    background: rgba(255, 255, 255, 0.4);
}

/* Contenu compact */
.compact-popup .popup-content {
    padding: 15px;
    color: #e0e0e0;
}

.compact-popup p {
    font-size: 12px;
    color: #aaa;
    margin: 10px 0;
}

/* Auto settings items compacts */
.compact-popup .auto-setting-item {
    padding: 10px;
    gap: 10px;
    background: rgba(255, 255, 255, 0.05);
    margin-bottom: 8px;
}

.compact-popup .auto-setting-item:hover {
    background: rgba(255, 255, 255, 0.1);
}

.compact-popup .auto-setting-label strong {
    font-size: 13px;
    color: #fff;
}

.compact-popup .auto-setting-label small {
    font-size: 11px;
    color: #aaa;
}

/* Toggle master compact */
.compact-popup .master-toggle-section {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 15px;
    background: rgba(255, 255, 255, 0.08);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
}

.compact-popup .master-toggle-section span {
    font-weight: bold;
    font-size: 14px;
    color: #fff;
}

/* Capture target grid compact */
.compact-popup .capture-target-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
    gap: 8px;
    padding: 10px;
}

.compact-popup .target-slot {
    width: 60px;
    height: 60px;
}

/* =========================================
   UTILITY CLASSES POUR MODALS (Nettoyage inline styles)
   ========================================= */
.modal-grid-3 {
    display: grid;
    grid-template-columns: 1fr 1fr 1fr;
    gap: 10px;
    margin-bottom: 25px;
}

.modal-grid-2 {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 10px;
    margin-bottom: 20px;
}

.modal-menu-btn {
    color: white;
    padding: 15px 5px;
    font-size: 13px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 5px;
    cursor: pointer;
    border: none;
    border-radius: 8px;
    transition: transform 0.2s, filter 0.2s;
}

.modal-menu-btn:hover {
    transform: translateY(-2px);
    filter: brightness(1.1);
}

.modal-menu-btn.blue {
    background: #3b82f6;
}

.modal-menu-btn.purple {
    background: #8b5cf6;
}

.modal-menu-btn.green {
    background: #10b981;
}

.modal-action-btn {
    padding: 10px;
    font-size: 11px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    transition: filter 0.2s;
}

.modal-action-btn:hover {
    filter: brightness(1.1);
}

.modal-action-btn.cyan {
    background: #0dcaf0;
    color: white;
}

.modal-action-btn.yellow {
    background: #ffc107;
    color: #333;
}

.modal-options-box {
    text-align: left;
    background: #f8fafc;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
    margin-bottom: 20px;
}

.modal-section-title {
    margin: 0 0 10px 0;
    font-size: 12px;
    color: #94a3b8;
    text-transform: uppercase;
    text-align: left;
}

.modal-option-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.modal-option-row:last-child {
    margin-bottom: 0;
}

.modal-option-label {
    font-size: 13px;
    color: #334155;
    font-weight: bold;
}

.modal-info-btn {
    padding: 4px 10px;
    font-size: 11px;
    border-radius: 20px;
    min-width: 50px;
    background: #e2e8f0;
    border: 1px solid #cbd5e1;
    color: #475569;
    cursor: pointer;
}

.modal-danger-box {
    background: #fff5f5;
    border: 1px solid #fecaca;
    border-radius: 10px;
    padding: 10px;
}

.modal-reset-btn {
    width: 100%;
    font-size: 11px;
    padding: 8px;
    background: #ef4444;
    color: white;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
}

.modal-reset-btn:hover {
    background: #dc2626;
}

/* --- OFFLINE PROGRESS BAR ANIMATION --- */
.offline-progress-container {
    width: 100%;
    height: 28px;
    background: #1e293b;
    position: relative;
    border-radius: 14px;
    box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.5);
    overflow: hidden;
    border: 1px solid #475569;
    margin-bottom: 20px;
}

.offline-progress-fill {
    width: 0%;
    height: 100%;
    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #3b82f6);
    background-size: 200% 100%;
    box-shadow: 0 0 10px rgba(59, 130, 246, 0.6);
    transition: width 0.1s linear;
    border-radius: 14px;
    animation: gradientMove 2s infinite linear;
    position: relative;
}

.offline-progress-stripes {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-image: linear-gradient(45deg, rgba(255, 255, 255, 0.15) 25%, transparent 25%, transparent 50%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0.15) 75%, transparent 75%, transparent);
    background-size: 40px 40px;
    animation: progressStripes 1s linear infinite;
    border-radius: 14px;
}

.offline-progress-text {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    text-align: center;
    font-size: 14px;
    line-height: 28px;
    color: #ffffff;
    font-weight: 900;
    text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8), 0 0 5px rgba(59, 130, 246, 0.8);
    letter-spacing: 1px;
    font-family: 'Outfit', sans-serif;
    z-index: 2;
}

@keyframes gradientMove {
    0% {
        background-position: 100% 0;
    }

    100% {
        background-position: -100% 0;
    }
}

@keyframes progressStripes {
    0% {
        background-position: 40px 0;
    }

    100% {
        background-position: 0 0;
    }
}

/* ================================================================
   RESPONSIVE SMARTPHONE (max-width: 768px)
   ================================================================ */

@media (max-width: 768px) {

    /* --- BODY & GLOBAL --- */
    body {
        overflow: auto;
        height: auto;
        min-height: 100vh;
        -webkit-overflow-scrolling: touch;
    }

    /* --- LAYOUT PRINCIPAL : COLONNE UNIQUE --- */
    .game-container {
        display: flex !important;
        flex-direction: column !important;
        grid-template-columns: unset !important;
        grid-template-rows: unset !important;
        width: 100vw !important;
        min-height: 100vh;
        height: auto !important;
        overflow: visible !important;
        padding: 0 !important;
        gap: 0 !important;
        padding-bottom: 64px !important;
        /* espace pour la nav fixe */
    }

    /* Désactiver le vignette overlay sur mobile */
    .game-container::before {
        display: none !important;
    }

    /* --- HEADER COMPACT --- */
    .header {
        grid-column: unset !important;
        border-radius: 0 !important;
        border-left: none !important;
        border-right: none !important;
        border-top: none !important;
        padding: 8px 8px 6px 8px !important;
        position: sticky;
        top: 0;
        z-index: 200;
    }

    .header::before {
        display: none !important;
        /* Masquer les 3 boutons fenêtre */
    }

    .header::after {
        display: none !important;
        /* Masquer le titre POKETIME HUD */
    }

    .header-unified-row {
        padding: 6px 8px !important;
        gap: 8px !important;
        flex-wrap: nowrap !important;
        justify-content: space-between !important;
    }

    /* Masquer les stats de combat dans le header sur mobile */
    .combat-stats-group {
        display: none !important;
    }

    /* Masquer les séparateurs */
    .header-separator {
        display: none !important;
    }

    /* Ressources compactes */
    .resources-group {
        gap: 4px !important;
        flex: 1;
    }

    .resource-chip {
        padding: 4px 8px !important;
        height: 38px !important;
        gap: 6px !important;
        min-width: 0 !important;
        flex: 1;
    }

    .resource-val {
        font-size: 12px !important;
    }

    .resource-name {
        font-size: 7px !important;
    }

    .resource-icon.resource-icon-img {
        width: 18px !important;
        height: 18px !important;
    }

    /* Bouton menu compact */
    .header-buttons .btn {
        padding: 4px 10px !important;
        font-size: 10px !important;
    }

    /* --- PANNEAUX : AFFICHAGE CONDITIONNEL --- */
    .combat-area,
    .team-area,
    .secondary-content {
        display: none !important;
        grid-column: unset !important;
        grid-row: unset !important;
        width: 100% !important;
        height: auto !important;
        min-height: 0 !important;
        border-radius: 0 !important;
        border-left: none !important;
        border-right: none !important;
        overflow-y: auto !important;
        flex: 1;
    }

    .combat-area.mobile-active,
    .team-area.mobile-active,
    .secondary-content.mobile-active {
        display: flex !important;
        flex-direction: column !important;
    }

    /* --- COMBAT AREA MOBILE --- */
    .combat-area {
        border: none !important;
        box-shadow: none !important;
        padding: 8px !important;
    }

    /* Zone selector compact */
    .combat-area .zone-selector {
        padding: 8px !important;
        margin-bottom: 10px !important;
    }

    .zone-selector select {
        width: 100%;
        font-size: 13px !important;
    }

    .zone-info {
        font-size: 11px !important;
    }

    /* Écran de combat */
    .battle-screen {
        margin-bottom: 10px !important;
        border-width: 3px !important;
        border-radius: 10px !important;
    }

    .battle-display {
        padding: 10px !important;
    }

    /* Sprites plus petits */
    .battle-sprite {
        width: 72px !important;
        height: 72px !important;
    }

    /* HUD empilé verticalement */
    .battle-screen .battle-hud {
        grid-template-columns: 1fr !important;
        padding: 6px 10px !important;
        gap: 8px !important;
    }

    .creature-name {
        font-size: 13px !important;
    }

    .creature-level {
        font-size: 11px !important;
    }

    /* Barres de vie compactes */
    .health-bar {
        height: 14px !important;
    }

    .health-text {
        font-size: 9px !important;
    }

    /* HUD stats mini */
    .hud-stats {
        gap: 3px !important;
    }

    .hud-stat-pill {
        font-size: 8px !important;
        padding: 1px 4px !important;
    }

    .hud-stat-value {
        font-size: 10px !important;
    }

    /* Contrôles de combat */
    .combat-controls-wrapper {
        padding: 6px !important;
        margin-bottom: 8px !important;
    }

    .menu-angle-gauche {
        transform: scale(0.85) !important;
        transform-origin: bottom left !important;
    }

    /* --- TEAM AREA MOBILE --- */
    .team-area {
        border: none !important;
        box-shadow: none !important;
        padding: 10px !important;
    }

    /* --- SECONDARY CONTENT (EXTRAS) MOBILE --- */
    .secondary-content {
        border: none !important;
        box-shadow: none !important;
        padding: 10px 8px !important;
    }

    /* Tabs plus compactes */
    .tabs-container {
        gap: 4px !important;
        flex-wrap: wrap !important;
    }

    .tab-btn {
        padding: 6px 8px !important;
        font-size: 9px !important;
        gap: 2px !important;
    }

    .sub-tabs-container {
        gap: 4px !important;
        flex-wrap: wrap !important;
    }

    .sub-tab-btn {
        padding: 6px 8px !important;
        font-size: 10px !important;
    }

    /* Tab content */
    .tab-content {
        padding: 10px !important;
    }

    /* Storage controls empilés */
    .storage-controls {
        padding: 10px !important;
    }

    .storage-controls>div {
        flex-direction: column !important;
    }

    .storage-controls input,
    .storage-controls select {
        width: 100% !important;
    }

    /* Sort buttons wrap */
    .sort-btn {
        font-size: 9px !important;
        padding: 5px 8px !important;
    }

    /* --- MODALS PLEIN ÉCRAN --- */
    .stats-modal .stats-content,
    .modal-content {
        width: 95vw !important;
        max-width: 95vw !important;
        max-height: 90vh !important;
        border-radius: 10px !important;
        margin: auto !important;
    }

    .quest-completion-content {
        width: 95vw !important;
        max-width: 95vw !important;
        padding: 15px !important;
    }

    /* Réduction globale du modal d'éclosion d'œuf sur mobile */
    .quest-completion-content .egg-hatch-sprite,
    .auto-egg-hatch-mini .egg-hatch-sprite {
        width: 100px !important;
        height: 100px !important;
        margin: 5px auto !important;
        display: block !important;
    }

    .quest-completion-content .egg-hatch-name,
    .auto-egg-hatch-mini .egg-hatch-name {
        font-size: 16px !important;
        margin-bottom: 5px !important;
    }

    .quest-completion-content .egg-hatch-title,
    .auto-egg-hatch-mini .egg-hatch-title {
        font-size: 14px !important;
    }

    .quest-completion-content .egg-hatch-types,
    .auto-egg-hatch-mini .egg-hatch-types {
        display: none !important;
    }

    .quest-completion-content .egg-hatch-stats,
    .auto-egg-hatch-mini .egg-hatch-stats {
        display: none !important;
    }

    .quest-completion-content .creature-stats {
        gap: 4px !important;
    }

    .quest-completion-content .stat-row {
        margin-bottom: 2px !important;
        font-size: 11px !important;
    }

    .quest-completion-content .btn-super-confirm {
        padding: 10px !important;
        font-size: 14px !important;
    }

    /* Compact popup plein écran */
    .compact-popup {
        width: 95vw !important;
        max-width: 95vw !important;
        left: 2.5vw !important;
        right: 2.5vw !important;
    }

    /* Creature modal grid stacked */
    .creature-modal-grid {
        grid-template-columns: 1fr !important;
        gap: 8px !important;
    }

    /* Réduction globale du modal créature sur mobile */
    .creature-modal-sprite-wrap {
        padding: 5px !important;
    }

    .creature-modal-sprite {
        width: 80px !important;
        height: 80px !important;
    }

    .creature-modal-main {
        gap: 8px !important;
    }

    .creature-modal-stats-box,
    .creature-modal-info-box {
        padding: 8px !important;
        margin-bottom: 5px !important;
    }

    .creature-modal-stats-row {
        gap: 4px !important;
        margin-bottom: 5px !important;
    }

    .creature-modal-info {
        grid-template-columns: 1fr 1fr !important;
        gap: 5px !important;
    }

    .creature-modal-actions {
        padding-top: 5px !important;
        gap: 5px !important;
    }

    .creature-modal-actions .btn {
        padding: 8px !important;
        font-size: 11px !important;
        min-height: 32px !important;
    }

    /* Starter cards stacked */
    .starter-container {
        grid-template-columns: 1fr !important;
    }

    /* --- TOASTS ADAPTÉS --- */
    .toastContainer {
        right: 5px !important;
        left: 5px !important;
        top: 10px !important;
        bottom: auto !important;
        z-index: 10000;
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .toast {
        min-width: unset !important;
        max-width: 90% !important;
        width: 90% !important;
        padding: 8px 12px !important;
        margin-bottom: 8px !important;
        border-radius: 20px !important;
        font-size: 13px !important;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3) !important;
        animation: slideDown 0.3s ease-out forwards !important;
    }

    @keyframes slideDown {
        from {
            transform: translateY(-40px);
            opacity: 0;
        }

        to {
            transform: translateY(0);
            opacity: 1;
        }
    }

    @keyframes slideOut {
        from {
            transform: translateY(0);
            opacity: 1;
        }

        to {
            transform: translateY(-40px);
            opacity: 0;
        }
    }

    /* --- BOUTON EXTRAS CACHÉ (redondant avec nav mobile) --- */
    button[onclick="toggleSecondaryContent()"],
    #toggleIcon {
        display: none !important;
    }

    /* --- CIBLES TACTILES --- */
    .btn,
    .cmd-btn,
    .tab-btn,
    .sub-tab-btn,
    .sort-btn,
    .zone-details-btn,
    .shop-buy-btn,
    button {
        min-height: 36px;
    }

    /* --- TEAM AREA ACTIONS (Plus compact) --- */
    .card-actions {
        display: flex !important;
        flex-direction: row !important;
        flex-wrap: wrap !important;
        justify-content: center !important;
        gap: 6px !important;
        padding: 6px 0 !important;
    }

    .card-actions button {
        padding: 4px !important;
        font-size: 9px !important;
        min-height: 28px !important;
    }

    /* --- STORAGE GRID (Dense) --- */
    #storageList {
        display: grid !important;
        grid-template-columns: repeat(auto-fill, minmax(70px, 1fr)) !important;
        gap: 6px !important;
        padding: 4px !important;
    }

    #storageList .creature-card {
        padding: 4px !important;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }

    #storageList .creature-info,
    #storageList .creature-iv,
    #storageList .creature-types,
    #storageList .card-actions {
        display: none !important;
        /* Hide details on mobile grid */
    }

    #storageList .creature-sprite {
        width: 48px !important;
        height: 48px !important;
    }

    #storageList .creature-header {
        flex-direction: column !important;
        gap: 2px !important;
        align-items: center !important;
        margin-bottom: 0 !important;
    }

    #storageList .creature-name {
        font-size: 9px !important;
        text-align: center !important;
        white-space: nowrap !important;
        overflow: hidden !important;
        text-overflow: ellipsis !important;
        width: 100% !important;
    }

    #storageList .creature-level {
        font-size: 8px !important;
    }

    /* --- NAVIGATION MOBILE FIXE --- */
    .mobile-nav {
        display: flex !important;
    }

    /* Pokedex controls compact */
    .pokedex-controls {
        gap: 4px !important;
        padding: 8px !important;
    }

    /* Quest stats compact */
    .quest-stats {
        flex-direction: row !important;
        gap: 8px !important;
    }

    /* Upgrade container, shop items */
    .upgrades-container,
    .shop-container {
        gap: 8px !important;
    }

    /* Recycler stacked */
    .recycler-container {
        flex-direction: column !important;
    }

    /* Auto/Capture tooltip position fix */
    .auto-tooltip,
    .capture-tooltip,
    .forfeit-tooltip {
        position: fixed !important;
        bottom: 72px !important;
        left: 10px !important;
        right: 10px !important;
        top: auto !important;
    }

    /* Custom tooltip fix */
    .custom-tooltip {
        max-width: 90vw !important;
    }

    /* Incubators responsive */
    .incubators-container {
        flex-direction: column !important;
    }

}

/* --- NAVIGATION MOBILE (PAR DÉFAUT CACHÉE) --- */
.mobile-nav {
    display: none;
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: 60px;
    background: linear-gradient(180deg, #4a3f35 0%, #3b3228 100%);
    border-top: 3px solid #5d4a3e;
    z-index: 9999;
    justify-content: space-around;
    align-items: center;
    padding: 0 8px;
    box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.4);
}

.mobile-nav-btn {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    background: none !important;
    border: none !important;
    box-shadow: none !important;
    color: #a89888 !important;
    cursor: pointer;
    padding: 6px 16px !important;
    border-radius: 8px !important;
    transition: all 0.2s ease;
    min-height: 48px;
}

.mobile-nav-btn.active {
    color: #fbbf24 !important;
    background: rgba(251, 191, 36, 0.12) !important;
}

.mobile-nav-icon {
    font-size: 20px;
    line-height: 1;
}

.mobile-nav-label {
    font-size: 10px;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    font-family: 'Outfit', sans-serif;
}

@keyframes spin {
    from {
        transform: rotate(0deg);
    }

    to {
        transform: rotate(360deg);
    }
}
